(this.webpackJsonptabit=this.webpackJsonptabit||[]).push([[0],{107:function(t,e,n){"use strict";var r=n(15),i=n(1),a=n(2),o=n(129);function s(t,e){if(t<1||e<1)throw new Error("x<1 || y<1");for(;Math.max(t,e)%Math.min(t,e)!==0;)t>e?t%=e:e%=t;return Math.min(t,e)}var u=function(){function t(e,n){if(Object(i.a)(this,t),0===e.length)throw new Error("patternArray must not be zero length");this.rep=e,this.resolution=n}return Object(a.a)(t,[{key:"length",value:function(){return this.rep.length*this.resolution}},{key:"empty",value:function(){return 0===this.rep.reduce((function(t,e){return t+e}))}},{key:"_sumOverlapsOfArrays",value:function(t,e){for(var n=0,r=0;r<t.length;++r)t[r]&&e[r]&&n++;return n}},{key:"countOverlaps",value:function(t){if(this.resolution===t.resolution)return this._sumOverlapsOfArrays(this.rep,t.rep);var e=s(this.resolution,t.resolution),n=this.formatResolution(e),r=t.formatResolution(e);return this._sumOverlapsOfArrays(n.rep,r.rep)}},{key:"aggregate",value:function(e){if(this.resolution===e.resolution){for(var n=Math.max(this.rep.length,e.rep.length),r=new Array(n).fill(0),i=0;i<r.length;++i)r[i]=(i<this.rep.length?this.rep[i]:0)||(i<e.rep.length?e.rep[i]:0);return new t(r,this.resolution)}var a=s(this.resolution,e.resolution),o=this.formatResolution(a),u=e.formatResolution(a);return o.aggregate(u)}},{key:"format",value:function(e){var n=this.resolution*this.rep.length,r=this.toPoints(),i=t.representPoints(r,e,n);return i?new t(i,e):null}},{key:"toPoints",value:function(){var t,e=[],n=Object(r.a)(Array(this.rep.length).keys());try{for(n.s();!(t=n.n()).done;){var i=t.value;this.rep[i]&&e.push(this.resolution*i)}}catch(a){n.e(a)}finally{n.f()}return e}}],[{key:"representPoints",value:function(t,e,n){if(n<=0)throw new Error("size must be greater than zero");if(n<e||n%e!==0)throw new Error("resolution must be less than size and divide it evenly");var i,a=new Array(n/e).fill(0),o=Object(r.a)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s%e!==0)throw new Error("Failed to represent point "+s.toString()+" at resolution "+e.toString());if(s>=n)throw new Error("Failed to represent point "+s.toString()+" for invalid specified size "+n.toString());a[s/e]=1}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"fromPositions",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null!==r&&void 0!==r?r:Object(o.a)(e,n);return new t(t.representPoints(e,i,n),i)}}]),t}();e.a=u},129:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(15);function i(t,e){for(var n=t.concat([e]),i=0,a=[48,24,16,12,8,6,4,3,2,1];i<a.length;i++){var o,s=a[i],u=!0,l=Object(r.a)(n);try{for(l.s();!(o=l.n()).done;){if(o.value%s!==0){u=!1;break}}}catch(c){l.e(c)}finally{l.f()}if(u)return s}throw new Error("Failed to predict base")}},179:function(t,e,n){"use strict";(function(t,r){var i=n(37),a=n(14),o=n(15),s=n(1),u=n(2),l=n(4),c=n(3),m=n(0),p=n.n(m),f=n(11),h=n(253),d=n(276),g=n(257),v=(n(340),n(451)),b=n(445),k=n(187),y=n(447),O=n(285),E=n(448),S=n(435),j=n(281),w=n(446),C=n(74),T=n(63),R=n(275),M=n.n(R),P=n(273),x=n.n(P),A=n(184),I=n.n(A),F=n(191),D=n(188),N=n(190),B=n(189),_=n(136),L=n(12),z=n(274),G=n.n(z),K=n(180),U=n(94),q=n(82),J=n(49),W=n(58),H=n(268),V=n(107),X=n(269),Y=n(277),$=n(29),Z=n(182),Q=n.n(Z),tt=n(183),et=n.n(tt),nt=n(272),rt=n.n(nt),it=Object(k.a)({palette:{type:"dark",primary:{main:"#36d9be"},secondary:{main:"#f50057"}}}),at=function(t){return t&&"keydown"===t.type&&("Tab"===t.key||"Shift"===t.key)},ot=function(t){return"https://cors-anywhere.herokuapp.com/"+function(t){return"https://jsonbase.com/tabit-song/"+t}(t)},st={modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:it.palette.background.paper,border:"2px solid #000",boxShadow:it.shadows[5],padding:it.spacing(2,4,3)}},ut=function(e){Object(l.a)(m,e);var n=Object(c.a)(m);function m(t){var e;return Object(s.a)(this,m),(e=n.call(this,t)).state={instruments:null,instrumentIndex:null,instrumentMask:null,patterns:null,formatSettings:Object.assign({},K.a),patternSettings:[],loadedFile:null,selectedPattern:null,settingsOpen:!1,patternsOpen:!1,progress:null,showSharingDialog:!1,showTitleOptions:void 0===e.props.match.params.song,permanentUrl:""},e.pattern=p.a.createRef(),e}return Object(u.a)(m,[{key:"componentDidMount",value:function(){var t=this;this.props.match.params.song&&fetch(ot(this.props.match.params.song)).then((function(t){return t.json()})).then((function(e){var n=t.decodeState(e);if(Q()(e)!==t.props.match.params.song)throw new Error("Hash did not match");t.handleJson(null,n)})).catch((function(e){t.setState({showTitleOptions:!0}),alert("Song "+t.props.match.params.song+" could not be found.")}))}},{key:"getExportState",value:function(){return{instruments:this.state.instruments,instrumentIndex:this.state.instrumentIndex,patterns:this.state.patterns,formatSettings:this.state.formatSettings,patternSettings:this.state.patternSettings}}},{key:"save",value:function(){var t="download.tabit";if(this.state.loadedFile){var e=this.state.loadedFile.split(".");t=1===e.length?e[0]+".tabit":e.slice(0,e.length-1).join(".")+".tabit"}var n=JSON.stringify(this.getExportState(),null,4),r=new Blob([n],{type:"application/json"});Object(X.saveAs)(r,t)}},{key:"encodeState",value:function(t){var e=JSON.stringify(this.getExportState());return{state:et.a.deflateSync(e).toString("base64")}}},{key:"decodeState",value:function(e){var n=new t(e.state,"base64"),r=et.a.inflateSync(n);return JSON.parse(r)}},{key:"share",value:function(){var t=this,e=this.encodeState(this.getExportState()),n=Q()(e),r=ot(n),i={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},a=window.origin+"/tabit/song/"+n;fetch(r,i).then((function(e){t.setState({permanentUrl:a,showSharingDialog:!0})})).catch((function(t){alert("Couldn't upload song at this time. Sorry for any inconvenience.")}))}},{key:"figurePatternSettings",value:function(t){return Array.from(t,(function(t){return J.a.guessPerPatternSettings(t.instrumentTracks)}))}},{key:"handleJson",value:function(t,e){this.setState({instrumentIndex:e.instrumentIndex,instrumentMask:Object(U.b)(e.instrumentIndex,e.instruments),instruments:e.instruments,patterns:function(t){var e,n=[],r=Object(o.a)(t);try{for(r.s();!(e=r.n()).done;){for(var i=e.value,s={},u=0,l=Object.entries(i.instrumentTracks);u<l.length;u++){var c=Object(a.a)(l[u],2),m=c[0],p=c[1];s[m]=new V.a(p.rep,p.resolution)}var f=Object.assign({},i);f.instrumentTracks=s,n.push(f)}}catch(h){r.e(h)}finally{r.f()}return n}(e.patterns),formatSettings:e.formatSettings,patternSettings:e.patternSettings,loadedFile:null!==t&&void 0!==t?t:e.loadedFile,selectedPattern:0===e.patterns.length?null:0,patternsOpen:0!==e.patterns.length})}},{key:"handleFileImport",value:function(t){var e=this;t.file.name.includes("h2song")?g.a.parseHydrogenPromise(t.content).then((function(n){var r,i=Object(q.c)(n.instruments,q.a,n.patterns),a=Object(q.b)(n.instruments,n.patterns),s=Object(o.a)(a);try{for(s.s();!(r=s.n()).done;){r.value.volume=1}}catch(u){s.e(u)}finally{s.f()}e.setState({instrumentIndex:a,instrumentMask:Object(U.b)(a,i),instruments:i,patterns:n.patterns,patternSettings:e.figurePatternSettings(n.patterns),loadedFile:t.file.name,patternsOpen:!0,selectedPattern:0===n.patterns.length?null:0})})).catch((function(e){alert("Failed to load file "+t.file.name+" with error "+e)})):Promise.resolve(t.content).then(JSON.parse).then((function(n){e.handleJson(t.file.name,n)})).catch((function(e){alert("Failed to load file "+t.file.name+" with error "+e)}))}},{key:"selectPattern",value:function(t){this.setState({selectedPattern:t})}},{key:"renderPattern",value:function(t,e){var n=this;return p.a.createElement(p.a.Fragment,null,p.a.createElement(d.a,{instruments:this.state.instruments,tracks:t.instrumentTracks,config:e,active:this.state.progress,ref:this.pattern}),p.a.createElement(Y.a,{instruments:this.state.instruments,instrumentIndex:this.state.instrumentIndex,selectedPattern:t,patterns:this.state.patterns,onPatternTimeChange:function(t){n.onPatternTimeChange(t)}}))}},{key:"onPatternTimeChange",value:function(t){this.pattern.current.onPatternTimeChange(t)}},{key:"loadExample",value:function(){var t,e=function(t){var e,n=Object(o.a)(t.patterns);try{for(n.s();!(e=n.n()).done;){for(var r=e.value,i={},s=0,u=Object.entries(r.instrumentTracks);s<u.length;s++){var l=Object(a.a)(u[s],2),c=l[0],m=l[1];i[c]=new V.a(m.rep,m.resolution)}r.instrumentTracks=i}}catch(p){n.e(p)}finally{n.f()}return t}(H),n=Object(q.c)(e.instruments,q.a,e.patterns),r=Object(q.b)(e.instruments,e.patterns),i=Object(o.a)(r);try{for(i.s();!(t=i.n()).done;){t.value.volume=1}}catch(s){i.e(s)}finally{i.f()}this.setState({instrumentIndex:r,instrumentMask:Object(U.b)(r,n),instruments:n,patterns:e.patterns,selectedPattern:0===e.patterns.length?null:0,loadedFile:"kuva.example",patternsOpen:!0,patternSettings:this.figurePatternSettings(e.patterns)})}},{key:"checkMobile",value:function(){var t=navigator.userAgent||navigator.vendor||window.opera;return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((function(e){return t.match(e)}))}},{key:"getTrackLength",value:function(t){for(var e=48,n=0,r=Object.entries(t.instrumentTracks);n<r.length;n++){var i=Object(a.a)(r[n],2)[1];e=Math.max(e,i.length())}return e}},{key:"getResolution",value:function(t){for(var e=48,n=0,r=Object.entries(t.instrumentTracks);n<r.length;n++){var i=Object(a.a)(r[n],2)[1];e=Math.min(e,i.resolution)}return e}},{key:"renderTitlePage",value:function(){var t=null!=this.state.patterns&&0===this.state.patterns.length?p.a.createElement(v.a,{severity:"error"},this.state.loadedFile," contained no patterns! Try another."):"",e=p.a.createElement(p.a.Fragment,null,p.a.createElement(T.a,{variant:"contained",onClick:this.loadExample.bind(this),style:{margin:"1em"}},"Load example"),p.a.createElement(h.a,{style:{margin:"1em"},variant:"contained",onImport:this.handleFileImport.bind(this),accept:".tabit,.h2song"}),t),n=p.a.createElement(p.a.Fragment,null,p.a.createElement("p",null," Loading song... "),p.a.createElement(b.a,null));return p.a.createElement(p.a.Fragment,null,p.a.createElement("div",null,p.a.createElement("h2",null,"tabit"),p.a.createElement("p",null,"I read .h2songs and write tab"),this.state.showTitleOptions?e:n),p.a.createElement("div",{style:{position:"absolute",bottom:0}},p.a.createElement("p",null,"tabit relies on publicly available sound libraries listed at ",p.a.createElement("a",{href:"https://github.com/andrew-murray/tabit"},"https://github.com/andrew-murray/tabit"))))}},{key:"renderPatternDrawer",value:function(t,e){var n,r=this,i=this.props,a=function(t){at(t)||r.setState({patternsOpen:!1})};return p.a.createElement(O.a,{disableBackdropTransition:!t,disableDiscovery:t,className:i.drawer,variant:e?void 0:"persistent",open:this.state.patternsOpen,onOpen:function(t){at(t)||r.setState({patternsOpen:!0})},onClose:a},p.a.createElement("div",{className:i.drawerHeader},p.a.createElement(C.a,{onClick:a},p.a.createElement(x.a,null))),p.a.createElement(F.a,null),p.a.createElement("div",{className:i.drawerContainer},p.a.createElement(S.a,null,(null!==(n=this.state.patterns)&&void 0!==n?n:[]).map((function(t,e){return p.a.createElement(j.a,{button:!0,key:"drawer-pattern"+e.toString(),onClick:function(){return r.selectPattern(e)}},p.a.createElement(w.a,{primary:t.name}))})))))}},{key:"renderSettingsDrawer",value:function(t,e,n){var r=this,i=this.props,o=function(t){at(t)||r.setState({settingsOpen:!1})},s=this.state.patterns[this.state.selectedPattern],u={name:s.name,resolution:s.resolution,length:this.getTrackLength(s)};return p.a.createElement(O.a,{disableBackdropTransition:!t,disableDiscovery:t,className:i.drawer,variant:e?void 0:"persistent",anchor:"right",open:this.state.settingsOpen,onOpen:function(t){at(t)||r.setState({settingsOpen:!0})},onClose:o,classes:{paper:i.drawerPaper}},p.a.createElement("div",{className:i.drawerHeader},p.a.createElement(C.a,{onClick:o},p.a.createElement(I.a,null))),p.a.createElement(F.a,null),p.a.createElement(K.b,{onChange:function(t){for(var e=Array.from(r.state.patternSettings),n=Object.assign({},r.state.formatSettings),i=0,o=Object.entries(t);i<o.length;i++){var s=Object(a.a)(o[i],2),u=s[0],l=s[1];u in e[r.state.selectedPattern]?e[r.state.selectedPattern][u]=l:n[u]=l}r.setState({formatSettings:n,patternSettings:e})},settings:n,pattern:u}),p.a.createElement(T.a,{style:{backgroundColor:"white",color:it.palette.background.default},onClick:function(t){r.save()}},"Download"),p.a.createElement(F.a,null),p.a.createElement(T.a,{style:{backgroundColor:"white",color:it.palette.background.default},onClick:function(t){r.share()}},"Share"))}},{key:"renderSharingDialog",value:function(){var t=this;return p.a.createElement(D.a,{open:this.state.showSharingDialog,onClose:function(e){t.setState({showSharingDialog:!1})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},p.a.createElement(B.a,null,p.a.createElement(_.a,{id:"alert-dialog-description"},"Your song is available at"),p.a.createElement(_.a,null,this.state.permanentUrl,p.a.createElement(C.a,{onClick:function(e){rt()(t.state.permanentUrl)}},p.a.createElement(G.a,null))),p.a.createElement(N.a,null,p.a.createElement(T.a,{onClick:function(e){t.setState({showSharingDialog:!1})}},"Close"))))}},{key:"renderMainContent",value:function(){var t=this;if(null==this.state.patterns||0===this.state.patterns.length)return this.renderTitlePage();var e=this.state.patterns[this.state.selectedPattern],n=Object.assign(Object.assign({},this.state.formatSettings),this.state.patternSettings[this.state.selectedPattern]),a=this.renderPattern(e,n),o=this.props,s=r.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent),u=this.checkMobile(),l=u?12:8;return p.a.createElement(p.a.Fragment,null,this.renderSharingDialog(),p.a.createElement("div",{style:{display:"flex",width:"95%"}},p.a.createElement(C.a,{color:"inherit","aria-label":"open pattern list",edge:"start",onClick:function(e){t.setState({patternsOpen:!0})},className:Object(f.a)(Object(i.a)({},o.hide,!this.state.patternsOpen))},p.a.createElement(I.a,null)),p.a.createElement("div",{className:"content-title",style:{flexGrow:1}}),p.a.createElement(C.a,{color:"inherit","aria-label":"open settings",edge:"end",onClick:function(e){t.setState({settingsOpen:!0})},className:Object(f.a)(this.state.settingsOpen&&o.hide)},p.a.createElement(M.a,null))),a,p.a.createElement(W.a,{container:!0},p.a.createElement(W.a,{item:!0,xs:(12-l)/2}),p.a.createElement(W.a,{item:!0,xs:l},p.a.createElement(U.a,{instruments:this.state.instruments,instrumentIndex:this.state.instrumentIndex,instrumentMask:this.state.instrumentMask,onChange:function(e){t.setState({instruments:e,instrumentMask:Object(U.b)(t.state.instrumentIndex,e)})},onVolumeEvent:function(e){"volume"in e?t.setState((function(t,n){var r=Array.from(t.instrumentIndex);return r[e.instrument].volume=e.volume,{instrumentIndex:r}})):"muted"in e&&t.setState((function(t,n){var r=Array.from(t.instrumentIndex);return r[e.instrument].muted=e.muted,{instrumentIndex:r}}))}})),p.a.createElement(W.a,{item:!0,xs:(12-l)/2})),this.renderPatternDrawer(s,u),this.renderSettingsDrawer(s,u,n))}},{key:"render",value:function(){var t=this.renderMainContent();return p.a.createElement("div",{className:"App"},p.a.createElement(y.a,{theme:it},p.a.createElement(E.a,null),t))}}]),m}(p.a.Component);e.a=Object(L.a)(st)(Object($.f)(ut))}).call(this,n(65).Buffer,n(66))},180:function(t,e,n){"use strict";n.d(e,"b",(function(){return j})),n.d(e,"a",(function(){return w}));var r=n(37),i=n(9),a=n(0),o=n.n(a),s=n(280),u=n(33),l=n(456),c=n(436),m=n(433),p=n(438),f=n(282),h=n(437),d=n(450),g=n(49),v=n(260),b=n.n(v),k=n(454),y=n(439),O=n(58),E=Object(s.a)((function(t){return{formControl:{margin:t.spacing(1),minWidth:120}}}));function S(t){var e=t.replace(/([A-Z])/g," $1");return e[0].toUpperCase()+e.slice(1)}function j(t){var e=E(t),n=Object(u.a)();function a(t){return" "===t?"space":t}function s(t){return"space"===t?" ":t}var v=function(e,n){var a=Object(i.a)(Object(i.a)({},t.settings),{},Object(r.a)({},e,n));t.onChange(a)},j=function(e){var n=Object(i.a)(Object(i.a)({},t.settings),{},Object(r.a)({},e.target.name,e.target.checked));t.onChange(n)};function w(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a,p="form-control-"+n+"-id";return o.a.createElement(m.a,{variant:"filled",className:e.formControl,key:p,id:p},o.a.createElement(l.a,{id:"settings-option-{name}"},n),o.a.createElement(d.a,{labelId:"settings-option-"+n+"-labelID",id:"settings-option-"+n+"-id",value:u(t.settings[n]),name:n,onChange:function(t){return v(t.target.name,i(t.target.value))}},r.map((function(t){return o.a.createElement(c.a,{key:"settings-menu-item-"+n+"-"+t,value:u(t)},u(t))}))))}for(var C=[],T=0,R=[2,3,4,5,6,7,8,14,16,32];T<R.length;T++){var M=48*R[T];M%t.settings.beatResolution===0&&M<=t.pattern.length&&C.push(M)}C.includes(t.pattern.length)||(C.push(t.pattern.length),C.sort());for(var P=[],x=0,A=[24,36,48,72,96];x<A.length;x++){var I=A[x];I%t.pattern.resolution===0&&t.settings.lineResolution%I===0&&P.push(I)}return o.a.createElement(p.a,{className:e.root},g.a.FORMAT_CONFIG_STRINGS.map((function(t){return w(t[0],t[1])})).reduce((function(t,e){return[t,e]})),g.a.FORMAT_CONFIG_BOOLS.map((function(e){return n=e,o.a.createElement(f.a,{control:o.a.createElement(h.a,{checked:t.settings[n],onChange:j,name:n}),label:S(n),key:"switch-"+n});var n})).reduce((function(t,e){return[t,e]})),o.a.createElement("div",{style:{backgroundColor:"white",color:n.palette.background.default}},o.a.createElement("p",null," ",t.pattern.name+" Options"," ")),w("beatResolution",P,(function(t){return t.toString()}),(function(t){return parseInt(t)})),w("lineResolution",C,(function(e){return t.settings.beatResolution*parseInt(e)}),(function(e){return(e/t.settings.beatResolution).toString()})),o.a.createElement(O.a,{container:!0},o.a.createElement(O.a,{item:!0,xs:8}),o.a.createElement(O.a,{item:!0,xs:4},o.a.createElement(k.a,{title:"Only options that produce lines made up of 'n' whole beats (no part-beats) are shown. If the options displayed for either lineResolution or beatResolution are too restrictive, try changing the other option.If lineResolution only results in one line, more options for beatResolution will be shown.","aria-label":"help"},o.a.createElement(y.a,null,o.a.createElement(b.a,null))))))}var w=g.a.DEFAULT_FORMAT_CONFIG},253:function(t,e,n){"use strict";var r=n(9),i=n(56),a=n(1),o=n(2),s=n(4),u=n(3),l=n(0),c=n.n(l),m=n(63),p=function(t){Object(s.a)(n,t);var e=Object(u.a)(n);function n(t){var r;return Object(a.a)(this,n),(r=e.call(this,t)).hiddenFileInput=c.a.createRef(),r}return Object(o.a)(n,[{key:"onChange",value:function(t){var e=this,n=t.target.files[0],r=new FileReader;r.onload=function(t){e.props.onImport&&e.props.onImport({file:n,content:t.target.result})},r.readAsText(n)}},{key:"render",value:function(){var t=this,e=Object(r.a)({},this.props),n=(e.onImport,e.accept),a=Object(i.a)(e,["onImport","accept"]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,Object.assign({onClick:function(e){t.hiddenFileInput.current.click()}},a),"Import File"),c.a.createElement("input",{type:"file",hidden:!0,accept:n,onChange:function(e){return t.onChange(e)},ref:this.hiddenFileInput}))}}]),n}(c.a.Component);e.a=p},257:function(t,e,n){"use strict";var r=n(8),i=n.n(r),a=n(16),o=n(18),s=n(14),u=n(15),l=n(107),c=n(258),m=n.n(c),p=n(129);function f(t,e){var n=Array.from(t.notes,(function(t){return t.position}));return Object(p.a)(n,e)}function h(t){var e=t.song.instrumentList[0].instrument,n=Array.from(e,(function(t){var e=t.instrumentComponent[0],n={id:parseInt(t.id),name:t.name[0],volume:parseFloat(t.volume),muted:"true"===t.isMuted[0],gain:parseFloat(t.gain),drumkit:t.drumkit[0]};return"layer"in e&&(n.filename=e.layer[0].filename[0]),n})),r=t.song.patternList[0].pattern,i=Array.from(r,(function(t){var e=t.noteList[0].note,n=parseInt(t.size),r=[];return e&&(r=(r=Array.from(e,(function(t){return{position:parseInt(t.position),instrument:parseInt(t.instrument)}}))).filter((function(t){return t.position<n}))),{size:n,name:t.name[0],notes:r}})),a=Array.from(i,(function(t){var e,r=f(t,t.size),i={},a=Object(u.a)(n);try{var o=function(){var n=e.value,a=t.notes.filter((function(t){return t.instrument===n.id})),o=Array.from(a,(function(t){return t.position}));i[n.id.toString()]=l.a.fromPositions(o,t.size,r)};for(a.s();!(e=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}return t.resolution=r,t.instrumentTracks=i,t}));if(t.song.virtualPatternList){var c=t.song.virtualPatternList[0].pattern;if(c){for(var m={},p=0,h=Array.from(c);p<h.length;p++){var d=h[p],g=d.name[0],v=Array.from(d.virtual);m[g]=new Set(v)}for(var b=0;b<20;++b){for(var k={},y=!1,O=0,E=Object.entries(m);O<E.length;O++){var S,j=Object(s.a)(E[O],2),w=j[0],C=j[1],T=new Set(C),R=Object(u.a)(T);try{for(R.s();!(S=R.n()).done;){var M=S.value;M in m&&(T=new Set([].concat(Object(o.a)(T),Object(o.a)(m[M]))))}}catch(I){R.e(I)}finally{R.f()}y=y||T.size!==C.size,k[w]=T}if(!y)break;if(20===b)throw new Error("Reached max virtual_pattern recursion depth.");m=k}for(var P=function(){var t,e=Object(s.a)(A[x],2),n=e[0],r=e[1],i=a.find((function(t){return t.name===n})),o=Object(u.a)(r);try{var l=function(){for(var e=t.value,n=a.find((function(t){return t.name===e})),r=0,o=Object.entries(n.instrumentTracks);r<o.length;r++){var u=Object(s.a)(o[r],2),l=u[0],c=u[1];if(l in i.instrumentTracks){var m=i.instrumentTracks[l].aggregate(c);m.rep.length=i.size/m.resolution,i.instrumentTracks[l]=m}else{var p=c.format(i.resolution);p.length=i.size/i.resolution,i.instrumentTracks[l]=p}}};for(o.s();!(t=o.n()).done;)l()}catch(I){o.e(I)}finally{o.f()}var c=f(i,i.size);i.resolution=c;for(var m=0,p=Object.entries(i.instrumentTracks);m<p.length;m++){var h=Object(s.a)(p[m],2),d=h[0],g=h[1];i[d]=g.format(c)}},x=0,A=Object.entries(m);x<A.length;x++)P()}}return{instruments:n,patterns:a}}function d(){return(d=Object(a.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new m.a.Parser,t.abrupt("return",n.parseStringPromise(e).then(h));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.a={parseHydrogenPromise:function(t){return d.apply(this,arguments)}}},268:function(t){t.exports=JSON.parse('{"instruments":[{"id":23,"name":"Stick","volume":0.99569,"muted":false,"gain":1,"drumkit":"GMRockKit","filename":"SideStick-Softest.wav"},{"id":24,"name":"Kick Short","volume":1,"muted":false,"gain":1,"drumkit":"TR808EmulationKit","filename":"808_Kick_Short.flac"},{"id":20,"name":"Stick","volume":0.193966,"muted":false,"gain":1,"drumkit":"DeathMetal"},{"id":26,"name":"Stick","volume":0.99569,"muted":false,"gain":1,"drumkit":"GMRockKit","filename":"SideStick-Softest.wav"},{"id":25,"name":"Kick Short","volume":1,"muted":false,"gain":1,"drumkit":"TR808EmulationKit","filename":"808_Kick_Short.flac"},{"id":22,"name":"tom02","volume":0.65,"muted":false,"gain":1,"drumkit":"DeathMetal"},{"id":27,"name":"snare","volume":0.49,"muted":false,"gain":1,"drumkit":"DeathMetal","filename":"014b.WAV"},{"id":13,"name":"Snare 1","volume":0.35,"muted":false,"gain":0.4,"drumkit":"DeathMetal"},{"id":10,"name":"Djembe4 Slap","volume":0.12931,"muted":false,"gain":1,"drumkit":"circAfrique v4","filename":"Djembe4 Slap.wav"},{"id":11,"name":"Djembe4 Tone","volume":0.12931,"muted":false,"gain":0.95,"drumkit":"circAfrique v4","filename":"Djembe4 Tone.wav"},{"id":12,"name":"Djembe4 Bass","volume":0.181034,"muted":false,"gain":1.5,"drumkit":"circAfrique v4","filename":"Djembe4 Bass.wav"},{"id":16,"name":"Shaker","volume":0.232759,"muted":false,"gain":2.2,"drumkit":"TR808EmulationKit","filename":"808_Shaker.flac"},{"id":21,"name":"Shaker","volume":1.5,"muted":false,"gain":2.45,"drumkit":"TR808EmulationKit","filename":"808_Shaker.flac"}],"patterns":[{"size":384,"name":"k-1","notes":[{"position":0,"instrument":21},{"position":0,"instrument":24},{"position":0,"instrument":26},{"position":0,"instrument":11},{"position":12,"instrument":21},{"position":24,"instrument":11},{"position":24,"instrument":21},{"position":24,"instrument":24},{"position":24,"instrument":26},{"position":24,"instrument":27},{"position":36,"instrument":21},{"position":36,"instrument":11},{"position":48,"instrument":21},{"position":48,"instrument":11},{"position":48,"instrument":23},{"position":48,"instrument":26},{"position":48,"instrument":27},{"position":60,"instrument":24},{"position":72,"instrument":10},{"position":72,"instrument":21},{"position":72,"instrument":26},{"position":84,"instrument":25},{"position":96,"instrument":23},{"position":96,"instrument":26},{"position":108,"instrument":25},{"position":120,"instrument":12},{"position":120,"instrument":25},{"position":144,"instrument":12},{"position":144,"instrument":21},{"position":144,"instrument":23},{"position":144,"instrument":25},{"position":144,"instrument":27},{"position":156,"instrument":21},{"position":168,"instrument":21},{"position":180,"instrument":27},{"position":192,"instrument":11},{"position":192,"instrument":21},{"position":192,"instrument":24},{"position":192,"instrument":26},{"position":216,"instrument":12},{"position":216,"instrument":21},{"position":216,"instrument":24},{"position":216,"instrument":26},{"position":216,"instrument":27},{"position":240,"instrument":11},{"position":240,"instrument":23},{"position":240,"instrument":26},{"position":240,"instrument":27},{"position":252,"instrument":12},{"position":252,"instrument":24},{"position":264,"instrument":21},{"position":264,"instrument":27},{"position":276,"instrument":11},{"position":276,"instrument":25},{"position":288,"instrument":12},{"position":288,"instrument":21},{"position":288,"instrument":24},{"position":288,"instrument":25},{"position":300,"instrument":21},{"position":312,"instrument":11},{"position":312,"instrument":23},{"position":312,"instrument":26},{"position":324,"instrument":12},{"position":324,"instrument":21},{"position":324,"instrument":24},{"position":324,"instrument":25},{"position":336,"instrument":21},{"position":336,"instrument":27},{"position":360,"instrument":21},{"position":360,"instrument":10},{"position":360,"instrument":23},{"position":360,"instrument":26},{"position":360,"instrument":27},{"position":372,"instrument":21},{"position":372,"instrument":27}],"resolution":12,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],"resolution":12},"11":{"rep":[1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0],"resolution":12},"12":{"rep":[0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0],"resolution":12},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"21":{"rep":[1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,0,1,1],"resolution":12},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"23":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0],"resolution":12},"24":{"rep":[1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0],"resolution":12},"25":{"rep":[0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0],"resolution":12},"26":{"rep":[1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0],"resolution":12},"27":{"rep":[0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,1,0,1,1],"resolution":12}}},{"size":384,"name":"k-2","notes":[{"position":0,"instrument":12},{"position":0,"instrument":21},{"position":0,"instrument":24},{"position":0,"instrument":25},{"position":0,"instrument":27},{"position":12,"instrument":12},{"position":12,"instrument":24},{"position":12,"instrument":25},{"position":24,"instrument":12},{"position":24,"instrument":21},{"position":24,"instrument":24},{"position":24,"instrument":25},{"position":36,"instrument":21},{"position":48,"instrument":21},{"position":48,"instrument":10},{"position":48,"instrument":23},{"position":48,"instrument":26},{"position":48,"instrument":27},{"position":72,"instrument":21},{"position":84,"instrument":21},{"position":84,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":23},{"position":96,"instrument":26},{"position":108,"instrument":21},{"position":108,"instrument":27},{"position":120,"instrument":11},{"position":120,"instrument":21},{"position":132,"instrument":10},{"position":132,"instrument":27},{"position":144,"instrument":23},{"position":144,"instrument":26},{"position":144,"instrument":27},{"position":156,"instrument":10},{"position":168,"instrument":12},{"position":168,"instrument":21},{"position":168,"instrument":24},{"position":168,"instrument":25},{"position":180,"instrument":12},{"position":180,"instrument":24},{"position":180,"instrument":25},{"position":192,"instrument":12},{"position":192,"instrument":21},{"position":192,"instrument":24},{"position":192,"instrument":25},{"position":192,"instrument":27},{"position":216,"instrument":21},{"position":216,"instrument":11},{"position":228,"instrument":11},{"position":228,"instrument":21},{"position":228,"instrument":27},{"position":240,"instrument":21},{"position":240,"instrument":23},{"position":240,"instrument":26},{"position":240,"instrument":27},{"position":252,"instrument":10},{"position":264,"instrument":21},{"position":264,"instrument":11},{"position":276,"instrument":21},{"position":276,"instrument":27},{"position":288,"instrument":11},{"position":288,"instrument":21},{"position":288,"instrument":23},{"position":288,"instrument":26},{"position":300,"instrument":11},{"position":312,"instrument":21},{"position":324,"instrument":10},{"position":336,"instrument":11},{"position":336,"instrument":23},{"position":336,"instrument":26},{"position":360,"instrument":21}],"resolution":12,"instrumentTracks":{"10":{"rep":[0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],"resolution":12},"11":{"rep":[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,0,0,1,0,0,0],"resolution":12},"12":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"21":{"rep":[1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,0,0,1,0],"resolution":12},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"23":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":12},"24":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"25":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"26":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":12},"27":{"rep":[1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0],"resolution":12}}},{"size":192,"name":"lightbulb","notes":[{"position":0,"instrument":24},{"position":12,"instrument":24},{"position":24,"instrument":24},{"position":36,"instrument":24},{"position":48,"instrument":24},{"position":96,"instrument":27},{"position":144,"instrument":24},{"position":160,"instrument":24},{"position":176,"instrument":24}],"resolution":4,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"11":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"12":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"21":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"23":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"24":{"rep":[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":4},"25":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"26":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"27":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4}}},{"size":192,"name":"break","notes":[{"position":24,"instrument":21},{"position":24,"instrument":11},{"position":24,"instrument":27},{"position":48,"instrument":21},{"position":48,"instrument":11},{"position":48,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":11},{"position":96,"instrument":27},{"position":120,"instrument":21},{"position":120,"instrument":11},{"position":120,"instrument":27},{"position":144,"instrument":24},{"position":168,"instrument":21},{"position":168,"instrument":11},{"position":168,"instrument":24},{"position":168,"instrument":27}],"resolution":24,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"11":{"rep":[0,1,1,0,1,1,0,1],"resolution":24},"12":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"13":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"16":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"20":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"21":{"rep":[0,1,1,0,1,1,0,1],"resolution":24},"22":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"23":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"24":{"rep":[0,0,0,0,0,0,1,1],"resolution":24},"25":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"26":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"27":{"rep":[0,1,1,0,1,1,0,1],"resolution":24}}},{"size":192,"name":"squash","notes":[{"position":0,"instrument":21},{"position":0,"instrument":12},{"position":0,"instrument":24},{"position":0,"instrument":27},{"position":48,"instrument":21},{"position":48,"instrument":12},{"position":48,"instrument":24},{"position":48,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":12},{"position":96,"instrument":24},{"position":96,"instrument":27},{"position":144,"instrument":21},{"position":144,"instrument":12},{"position":144,"instrument":24},{"position":144,"instrument":27}],"resolution":48,"instrumentTracks":{"10":{"rep":[0,0,0,0],"resolution":48},"11":{"rep":[0,0,0,0],"resolution":48},"12":{"rep":[1,1,1,1],"resolution":48},"13":{"rep":[0,0,0,0],"resolution":48},"16":{"rep":[0,0,0,0],"resolution":48},"20":{"rep":[0,0,0,0],"resolution":48},"21":{"rep":[1,1,1,1],"resolution":48},"22":{"rep":[0,0,0,0],"resolution":48},"23":{"rep":[0,0,0,0],"resolution":48},"24":{"rep":[1,1,1,1],"resolution":48},"25":{"rep":[0,0,0,0],"resolution":48},"26":{"rep":[0,0,0,0],"resolution":48},"27":{"rep":[1,1,1,1],"resolution":48}}}]}')},276:function(t,e,n){"use strict";var r=n(18),i=n(1),a=n(2),o=n(4),s=n(3),u=n(0),l=n.n(u),c=n(49),m=n(12),p=function(t){Object(o.a)(n,t);var e=Object(s.a)(n);function n(t){var r;return Object(i.a)(this,n),(r=e.call(this,t)).state={},r}return Object(a.a)(n,[{key:"render",value:function(){var t=this,e=Object.values(this.props.tracks);if(0===e.length)return l.a.createElement(l.a.Fragment,null);var n=c.a.formatPatternString(this.props.instrument,this.props.tracks,this.props.config.restMark),i=e[0].resolution;if(this.props.config.lineResolution%this.props.config.beatResolution!==0&&n.length*i>this.props.config.lineResolution)throw new Error("This code only supports a beatResolution that divides the lineResolution");var a=c.a.chunkArray(n,this.props.config.lineResolution/i,0),o=this.props.config.lineResolution/this.props.config.beatResolution,s=this.props.config.beatResolution/i,u=a.map((function(t){return c.a.chunkArray(t,s)})),m=Object(r.a)(a.keys()),p=function(e,n,i){var a=Object(r.a)(n.keys());return l.a.createElement("p",{key:"pattern-line-"+e},l.a.createElement("span",{key:"line-start-"+e},t.props.config.lineMark),a.map((function(e){return l.a.createElement(l.a.Fragment,{key:"fragment-beat-"+(e+i).toString()},l.a.createElement("span",{key:"span-beat-"+(e+i).toString(),className:e+i===t.props.activeNote?"activeNote":""},n[e].join("")),l.a.createElement("span",{key:"span-beat-marker-"+(e+i).toString()},t.props.config.showBeatMark&&e!==a[a.length-1]?t.props.config.beatMark:""))})),l.a.createElement("span",{key:"line-end-"+e},t.props.config.lineMark))},f=c.a.createNumberMarker(this.props.config.numberRestMark,this.props.config.beatResolution,i,Math.min(this.props.config.lineResolution,a[0].length*i)),h=c.a.chunkArray(f,this.props.config.beatResolution/i);return l.a.createElement(l.a.Fragment,null,this.props.config.showBeatNumbers?p("beat",h,0):"",m.map((function(t){return p(t.toString(),u[t],o*t)})))}}]),n}(l.a.Component),f=Object(m.a)((function(t){return{root:{whiteSpace:"pre"}}}))(p);var h=function(t){Object(o.a)(n,t);var e=Object(s.a)(n);function n(t){var r;return Object(i.a)(this,n),(r=e.call(this,t)).state={},r}return Object(a.a)(n,[{key:"render",value:function(){var t=function(t,e){var n=t?t.toLowerCase():"";return["h1","h2","h3","h4","h5","h6"].includes(n)?n:e}(this.props.headingLevel,"h4");return l.a.createElement("article",null,l.a.createElement(t,null,this.props.instrumentName),l.a.createElement(f,{instrument:this.props.instrument,tracks:this.props.tracks,config:this.props.config,activeNote:this.props.activeNote}))}}]),n}(l.a.Component),d=function(t){Object(o.a)(n,t);var e=Object(s.a)(n);function n(t){var r;return Object(i.a)(this,n),(r=e.call(this,t)).state={patternTime:void 0},r}return Object(a.a)(n,[{key:"onPatternTimeChange",value:function(t){null!==t&&void 0!==t?this.setState({patternTime:t}):this.setState({patternTime:void 0})}},{key:"render",value:function(){var t=this,e=this.props.classes,n=Object(r.a)(this.props.instruments.keys()),i=this.props.config.beatResolution;return l.a.createElement("div",{className:e.root},n.map((function(e){return l.a.createElement(h,{key:"part-"+e.toString(),instrumentName:t.props.instruments[e][0],instrument:t.props.instruments[e][1],tracks:t.props.tracks,config:t.props.config,activeNote:void 0!==t.state.patternTime?Math.floor(t.state.patternTime/i):void 0})})))}}]),n}(l.a.Component);e.a=Object(m.a)((function(t){return{root:{"margin-bottom":t.spacing(2),fontFamily:"Roboto Mono",textAlign:"left",whiteSpace:"pre","& .activeNote":{color:t.palette.primary.main}}}}))(d)},277:function(t,e,n){"use strict";var r=n(18),i=n(15),a=n(14),o=n(1),s=n(2),u=n(4),l=n(3),c=n(0),m=n.n(c),p=function(){function t(){Object(o.a)(this,t)}return Object(s.a)(t,null,[{key:"createWebContext",value:function(){return new(window.AudioContext||window.webkitAudioContext||Object)}},{key:"determineMinResolution",value:function(t,e){for(var n=48,r=function(){var e=Object(a.a)(o[i],2),r=e[0],s=e[1];t.filter((function(t){return t.id.toString()===r})).length>0&&!s.empty()&&(n=Math.min(n,s.resolution))},i=0,o=Object.entries(e);i<o.length;i++)r();return n}},{key:"determineTrackLength",value:function(t,e){for(var n=48,r=function(){var e=Object(a.a)(o[i],2),r=e[0],s=e[1];t.filter((function(t){return t.id.toString()===r})).length>0&&!s.empty()&&(n=Math.max(n,s.length()))},i=0,o=Object.entries(e);i<o.length;i++)r();return n}},{key:"peakAmplitude",value:function(t){for(var e=0,n=0;n<t.numberOfChannels;n++)for(var r=t.getChannelData(n),i=0;i<r.length;++i)e=Math.max(Math.abs(r[i]),e);return e}},{key:"normalizeAudioBuffer",value:function(e){var n=t.peakAmplitude(e);if(n>1)for(var r=0;r<e.numberOfChannels;r++)for(var i=e.getChannelData(r),a=0;a<i.length;++a)i[a]=i[a]/n;return e}},{key:"createMasterTrack",value:function(e,n,r,o,s){for(var u=t.determineTrackLength(r,n),l=44100*(u*(60/s*1e3/48))/1e3,c=Math.floor(l),m=Math.floor(c/u),p=e.createBuffer(2,c,44100),f=0;f<p.numberOfChannels;f++)for(var h=p.getChannelData(f),d=function(){var t=Object(a.a)(v[g],2),e=t[0],n=t[1],s=r.filter((function(t){return t.id.toString()===e}));if(s.length>0&&s[0].id in o&&!n.empty()){var u,l=o[s[0].id],c=2===l.numberOfChannels?l.getChannelData(f):l.getChannelData(0),p=n.toPoints(),d=Object(i.a)(p);try{for(d.s();!(u=d.n()).done;)for(var b=u.value*m,k=0;k<l.length;++k)h[b+k]=h[b+k]+c[k]}catch(y){d.e(y)}finally{d.f()}}},g=0,v=Object.entries(n);g<v.length;g++)d();return t.normalizeAudioBuffer(p)}},{key:"createAudioSource",value:function(t,e,n){var r=t.createBufferSource();return r.buffer=e,r.loop=!0,null!==n&&(r.playbackRate.value=n/100),r.connect(t.destination),r}},{key:"createOneShotAudioSource",value:function(t,e,n){var r=t.createBufferSource();return r.buffer=e,r.loop=!1,null!==n&&(r.playbackRate.value=n/100),r.connect(t.destination),r}}]),t}(),f=n(74),h=n(270),d=n.n(h),g=n(271),v=n.n(g),b=n(455),k=n(58),y=n(26),O=["circAfrique v4","DeathMetal","The Black Pearl 1.0","GMRockKit","TR808EmulationKit"],E=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={tempo:100},r.samplerCount=0,r.sequences={},r.gain=new y.b,r.gain.toDestination(),y.f.bpm.value=r.state.tempo,r}return Object(s.a)(n,[{key:"chooseAppropriateUrlForInstrument",value:function(t,e){var n=e.toLowerCase();return n.includes("kick")?"The Black Pearl 1.0/PearlKick-Hard.wav":n.includes("stick")?"DeathMetal/16297_ltibbits_sticks_low_pitch.wav":n.includes("tom")?"TR808EmulationKit/808_Tom_Mid.wav":n.includes("clap")?"TR808EmulationKit/808_Clap.wav":n.includes("snare")?"GMRockKit/Snare-Soft.wav":null}},{key:"populateSamples",value:function(){var t=this;this.samplerCount=0,this.expectedSamplerCount=0;for(var e={},n=this.props.selectedPattern.instrumentTracks,r=function(){var n=Object(a.a)(o[i],1)[0],r=t.props.instrumentIndex.filter((function(t){return t.id.toString()===n}));if(r.length>0){var s=r[0];if("drumkit"in s&&"filename"in s&&O.includes(s.drumkit)){var u=s.filename.replace(".flac",".wav"),l=new y.c("/tabit/wav/"+s.drumkit+"/"+u,(function(){t.samplerCount++}));l.mute=s.muted;var c=Math.min(Math.max(0,s.volume),1),m=new y.b(c,"normalRange");l.connect(m),m.connect(t.gain),e[s.id]={player:l,gain:m},t.expectedSamplerCount++}else if("drumkit"in s){var p=t.chooseAppropriateUrlForInstrument(s.drumkit,s.name);if(null!==p){var f=new y.c("/tabit/wav/"+p,(function(){t.samplerCount++}));f.mute=s.muted;var h=Math.min(Math.max(0,s.volume),1),d=new y.b(h,"normalRange");f.connect(d),d.connect(t.gain),e[s.id]={player:f,gain:d},t.expectedSamplerCount++}}}},i=0,o=Object.entries(n);i<o.length;i++)r();this.samples=e}},{key:"createSequences",value:function(){var t,e=this,n=this.props.instrumentIndex,a={},o=Object(i.a)(this.props.patterns);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=p.determineMinResolution(n,s.instrumentTracks),l=p.determineTrackLength(n,s.instrumentTracks);a[s.name]=new y.d((function(t,n){e.tick(t,n)}),Object(r.a)(Array(l/u).keys()),y.e("4n")*(u/48)),a[s.name]._part.mute=!0,a[s.name].start(0)}}catch(c){o.e(c)}finally{o.f()}return a}},{key:"schedulePlaybackForNewTracks",value:function(){var t=this,e=this.props.instrumentIndex,n=this.props.selectedPattern.instrumentTracks,r=p.determineMinResolution(e,n),i=p.determineTrackLength(e,n),a=y.f.toSeconds(y.f.position),o=y.f.loopEnd-a,s="started"===y.f.state&&o>0&&o<y.e("8n").toSeconds()&&i>this.state.length,u=function(){t.sequences[t.props.selectedPattern.name]._part.mute=!1,y.f.loop=!0,y.f.setLoopPoints(0,y.e("4n")*(i/48))};r!==this.state.resolution||i!==this.state.length?this.setState({resolution:r,length:i},(function(){s?y.f.scheduleOnce(u,y.e("0")):u()})):u()}},{key:"samplesReady",value:function(){return this.sampleCount===this.expectedSampleCount}},{key:"tick",value:function(t,e){var n=this;if(t!==this.lastTickTime){this.lastTickTime=t;var r=this.state.length/this.state.resolution,i=e%r;if(this.samplesReady()){for(var o=this.props.selectedPattern.instrumentTracks,s=0,u=Object.entries(o);s<u.length;s++){var l=Object(a.a)(u[s],2),c=l[0];l[1].rep[i]&&this.samples[c].player.start(t)}this.props.onPatternTimeChange&&y.a.schedule((function(){var t=e*n.state.resolution%n.state.length;n.props.onPatternTimeChange(t)}),t)}}}},{key:"play",value:function(){y.g().then((function(){y.f.start()}))}},{key:"stop",value:function(){var t=this;"started"===y.f.state&&(y.f.stop(),this.props.onPatternTimeChange&&y.a.schedule((function(){t.props.onPatternTimeChange(null)}),y.f.now()))}},{key:"componentDidMount",value:function(){this.populateSamples(),this.sequences=this.createSequences(),this.schedulePlaybackForNewTracks()}},{key:"componentDidUpdate",value:function(t,e,n){if(t.selectedPattern.name!==this.props.selectedPattern.name&&(this.sequences[t.selectedPattern.name]._part.mute=!0,this.schedulePlaybackForNewTracks()),t.instrumentIndex!==this.props.instrumentIndex){var r,a=Object(i.a)(this.props.instrumentIndex);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.id in this.samples&&(this.samples[o.id].player.mute=o.muted,this.samples[o.id].gain.set({gain:o.volume}))}}catch(s){a.e(s)}finally{a.f()}}}},{key:"tempoControl",value:function(){var t=this;return m.a.createElement(b.a,{defaultValue:100,min:60,step:1,max:180,onChange:function(e,n){t.setState({tempo:n}),y.f.bpm.value=n},valueLabelDisplay:"auto"})}},{key:"render",value:function(){var t=this;return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",null,m.a.createElement(f.a,{color:"primary","aria-label":"play",onClick:function(e){t.play()}},m.a.createElement(d.a,null)),m.a.createElement(f.a,{color:"secondary","aria-label":"stop",onClick:function(e){t.stop()}},m.a.createElement(v.a,null))),m.a.createElement(k.a,{container:!0},m.a.createElement(k.a,{item:!0,xs:4}),m.a.createElement(k.a,{item:!0,xs:4},this.tempoControl()),m.a.createElement(k.a,{item:!0,xs:4})))}}]),n}(m.a.Component);e.a=E},305:function(t,e,n){t.exports=n(432)},310:function(t,e,n){},328:function(t,e){},330:function(t,e){},340:function(t,e,n){},432:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),a=n(23),o=n.n(a),s=(n(310),n(178)),u=n(29),l=n(179);function c(){return i.a.createElement(s.a,{basename:"/tabit"},i.a.createElement(u.c,null,i.a.createElement(u.a,{path:"/song/:song"},i.a.createElement(l.a,null)),i.a.createElement(u.a,{path:"/"},i.a.createElement(l.a,null))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(c,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},49:function(t,e,n){"use strict";var r=n(14),i=n(1),a=n(2),o=function(){function t(){Object(i.a)(this,t)}return Object(a.a)(t,null,[{key:"validateConfig",value:function(t,e){if(null!=e&&t.beatResolution%e!==0)throw new Error("patternResolution doesn't divide beatResolution");if(t.lineResolution<=0)throw new Error("config.lineResolution must be greater than zero")}},{key:"resolveConfig",value:function(e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if(!t.DEFAULT_FORMAT_CONFIG.hasOwnProperty(i))throw new Error("passed unrecognised property "+i)}return Object.assign(Object.assign({},t.DEFAULT_FORMAT_CONFIG),e)}},{key:"chunkString",value:function(t,e){if(e<=0)throw new Error("chunkSize must be > 0");return t.match(new RegExp(".{1,"+e+"}","g"))}},{key:"chunkArray",value:function(t,e){if(e<=0)throw new Error("chunkSize must be > 0");for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,Math.min(r+e,t.length)));return n}},{key:"createNumberMarker",value:function(t,e,n,r){if(r<=0)throw new Error("lineLength <= 0");if(e%n!==0)throw new Error("patternResolution "+n.toString()+" does not divide beatResolution "+e.toString());for(var i=Math.ceil(r/e),a=Array.from(Array(r/n),(function(e){return t})),o=0;o<i;o++)a[o*(e/n)]=((o+1)%10).toString();return a}},{key:"formatLineWithMarkers",value:function(e,n,r,i){t.validateConfig(e);for(var a=e.beatResolution/r,o=i?function(t,e){return"<span class='note-"+(n=e,((n+="").length>=(r=4)?n:new Array(r-n.length+1).join("0")+n)+"'>")+t+"</span>";var n,r}:function(t,e){return t},s="",u=0;u<n.length;++u){var l=r*u;s+=o(n.charAt(u),l)}var c=e.showBeatMark?t.chunkString(s,a*o("X",0).length).join(e.beatMark):s;return e.lineMark+c+e.lineMark}},{key:"defaultLineResolution",value:function(t,e){var n=Object.values(t);if(0===n.length)return 384;var r=n[0].length(),i=r/e;return i<=12?r:i>32?768:[r,r/2,r/3,r/2,r,r/3,r,r/4,r/3,r/2,r,r/3,r/5,r,r/3,r/4,r,r/6,r,r/4][i-13]}},{key:"guessPerPatternSettings",value:function(e){return{lineResolution:t.defaultLineResolution(e,48),beatResolution:48}}},{key:"formatPatternString",value:function(t,e,n){var i=Object.values(e);if(0===i.length)return"";for(var a=i[0].length(),o=i[0].resolution,s=Array(a/o).fill(n),u=0;u<s.length;++u)for(var l=0,c=Object.entries(t);l<c.length;l++){var m=Object(r.a)(c[l],2),p=m[0],f=m[1],h=e[p];null!=h&&1===h.rep[u]&&(s[u]=f)}return s}},{key:"fromInstrumentAndTrack",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=t.resolveConfig(i),o=Object.values(n);if(0===o.length)return"";var s=t.formatPatternString(e,n,a.restMark),u=s.join(""),l=o[0].resolution,c=o[0].length(),m=t.chunkString(u,a.lineResolution/l),p=[];a.showBeatNumbers&&p.push(t.formatLineWithMarkers(a,t.createNumberMarker(a.numberRestMark,a.beatResolution,l,Math.min(a.lineResolution,c)).join(""),l,r));for(var f=0;f<m.length;++f)p.push(t.formatLineWithMarkers(a,m[f],l,r));return p.join("\n")}}]),t}();o.DEFAULT_FORMAT_CONFIG={restMark:"-",beatMark:"|",lineMark:"|",numberRestMark:"-",beatResolution:48,showBeatMark:!0,showBeatNumbers:!0,lineResolution:384},o.FORMAT_CONFIG_STRINGS=[["restMark",["-","."," "]],["numberRestMark",["-","."," "]]],o.FORMAT_CONFIG_BOOLS=["showBeatMark","showBeatNumbers"],e.a=o},82:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return m}));var r=n(14),i=n(15),a={"Djembe Slap":"S","Djembe Tone":"t","Djembe Bass":"O","Snare Ghost":"x","Snare Accent":"X","Shaker Ghost":"x","Shaker Accent":"X",Click:"X",Bass:"O",Tom:"O",Default:"X"};function o(t){var e,n=[],r=Object(i.a)(t);try{for(r.s();!(e=r.n()).done;){var a=e.value,o=Object.assign({},a);o.name=o.name.toLowerCase(),n.push(o)}}catch(s){r.e(s)}finally{r.f()}return n}function s(t,e,n,r){var a=[];if(2===t.length){var o=t[0],s=t[1],u=o.volume>s.volume||o.volume===s.volume&&o.gain>s.gain,l={};l[o.id.toString()]=u?n:r,l[s.id.toString()]=u?r:n,a.push([e,l])}else{var c,m=Object(i.a)(t);try{for(m.s();!(c=m.n()).done;){var p=c.value,f={};f[p.id.toString()]=n,a.push([e,f])}}catch(h){m.e(h)}finally{m.f()}}return a}function u(t){var e,n=new Set,a=Object(i.a)(t);try{for(a.s();!(e=a.n()).done;)for(var o=e.value,s=0,u=Object.entries(o.instrumentTracks);s<u.length;s++){var l=Object(r.a)(u[s],2),c=l[0];l[1].empty()||n.add(parseInt(c))}}catch(m){a.e(m)}finally{a.f()}return n}function l(t,e){var n,r=u(e),a=[],o=Object(i.a)(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;r.has(s.id)&&a.push(s)}}catch(l){o.e(l)}finally{o.f()}return a}function c(t,e){var n=e.toLowerCase();return n.includes("click")||n.includes("stick")?t.Click:n.includes("bass")||n.includes("kick")?t.Bass:n.includes("snare")?t["Snare Accent"]:n.includes("shaker")?t.Shaker:n.includes("tom")?t.Tom:n.includes("djembe")?n.includes("slap")?t["Djembe Slap"]:n.includes("tone")?t["Djembe Tone"]:t["Djembe Bass"]:t.Default}function m(t,e,n){var r=[];r=(r=(r=(r=r.concat(function(t,e,n){for(var r=o(t),i=u(n),a=r.filter((function(t){return i.has(t.id)&&!t.name.includes("djembe")&&(t.name.includes("click")||t.name.includes("stick")||t.name.includes("tom")||t.name.includes("bass")||t.name.includes("kick"))})),s=Array.from(a,(function(t){return t.name.includes("click")||t.name.includes("stick")})),l=1,c=1,m=[],p=0;p<Math.floor(a.length/2);++p)if(s[2*p]!==s[2*p+1]){var f=s[2*p]?a[2*p]:a[2*p+1],h=s[2*p]?a[2*p+1]:a[2*p],d=h.name.includes("tom"),g=d?"Tom":"Bass",v="";d?(v=g+(l>=2?" "+l.toString():""),l+=1):(v=g+(c>=2?" "+c.toString():""),c+=1);var b={};b[h.id.toString()]=e[g],b[f.id.toString()]=e.Click,m.push([v,b])}if(a.length%2!==0&&!s[a.length-1]){var k=a[a.length-1],y=k.name.includes("tom"),O=y?"Tom":"Bass",E="";y?(E=O+(l>=2?" "+l.toString():""),l+=1):(E=O+(c>=2?" "+c.toString():""),c+=1);var S={};S[k.id.toString()]=e[O],m.push([E,S])}return m}(t,e,n))).concat(function(t,e){var n=o(t).filter((function(t){return t.name.includes("djembe")}));if(0===n.length)return[];if(n.length<=3){for(var r=Array.from(n,(function(t){return t.name.includes("slap")})),i=Array.from(n,(function(t){return t.name.includes("tone")})),a=Array.from(n,(function(t){return t.name.includes("bass")})),s=0;s<n.length;++s){if(1!==r[s]+i[s]+a[s])return[]}for(var u={},l=0;l<n.length;++l)r[l]?u[n[l].id.toString()]=e["Djembe Slap"]:i[l]?u[n[l].id.toString()]=e["Djembe Tone"]:a[l]&&(u[n[l].id.toString()]=e["Djembe Bass"]);return[["Djembe",u]]}return[]}(t,e))).concat(function(t,e){return s(o(t).filter((function(t){return t.name.includes("snare")})),"Snare",e["Snare Accent"],e["Snare Ghost"])}(t,e))).concat(function(t,e){return s(o(t).filter((function(t){return t.name.includes("shaker")})),"Shaker",e["Shaker Accent"],e["Shaker Ghost"])}(t,e));var a,l=u(n),m=Object(i.a)(t);try{for(m.s();!(a=m.n()).done;){var p=a.value;if(l.has(p.id)){var f,h=!1,d=Object(i.a)(r);try{for(d.s();!(f=d.n()).done;){var g=f.value;p.id.toString()in g[1]&&(h=!0)}}catch(b){d.e(b)}finally{d.f()}if(!1===h){var v={};v[p.id.toString()]=c(e,p.name),r.push([p.name,v])}}}}catch(b){m.e(b)}finally{m.f()}return r}},94:function(t,e,n){"use strict";n.d(e,"b",(function(){return $})),n.d(e,"a",(function(){return Y}));var r=n(18),i=n(14),a=n(0),o=n.n(a),s=n(280),u=n(282),l=n(453),c=n(442),m=n(444),p=n(95),f=n(441),h=n(443),d=n(135),g=n(267),v=n.n(g),b=n(181),k=n.n(b),y=n(63),O=n(74),E=n(266),S=n.n(E),j=n(286),w=n(188),C=n(190),T=n(189),R=n(136),M=n(284),P=n(12),x=n(64),A=n(58),I=n(262),F=n.n(I),D=n(263),N=n.n(D),B=n(264),_=n.n(B),L=n(265),z=n.n(L),G=n(261),K=n.n(G),U=n(455),q=Object(s.a)((function(t){return{root:{display:"flex"}}})),J=Object(P.a)({root:{marginLeft:0,marginRight:0}})(u.a),W=Object(P.a)({root:{padding:2}})(O.a),H=Object(P.a)((function(t){return{root:{borderBottom:"none",textAlign:"center",paddingBottom:t.spacing(0)}}}))(p.a),V=Object(P.a)((function(t){return{root:{textAlign:"center"}}}))(p.a);function X(t){var e=o.a.useState(!1),n=Object(i.a)(e,2),r=n[0],a=n[1],s=o.a.useState(100),u=Object(i.a)(s,2),l=u[0],c=u[1],m=o.a.useRef(null),p=t.height?t.height/3:24,f={height:3*p,position:"absolute",top:-p},h=Object.assign(r?{}:{visibility:"hidden",paddingLeft:"0px"},f),d=r?{visibility:"hidden"}:{};return o.a.createElement(K.a,{time:.5,onClickNHold:function(t){r||a(!0),m&&function(t){var e=document.createEvent("MouseEvents");e.initEvent("mousedown",!0,!0),t.dispatchEvent(e)}(m.current)},onEnd:function(t){r&&a(!1)}},o.a.createElement(W,{disableRipple:!0,disableFocusRipple:!0,onClick:t.onMuteToggle},o.a.createElement("div",{style:h},o.a.createElement(U.a,{defaultValue:100,orientation:"vertical","aria-labelledby":"vertical-slider",onChangeCommitted:function(e,n){c(n),t.onChange&&t.onChange(n)},ref:m})),o.a.createElement("div",{style:d},t.muted?o.a.createElement(F.a,{disableRipple:!0,disableFocusRipple:!0,fontSize:"small"}):l<10?o.a.createElement(N.a,{disableRipple:!0,disableFocusRipple:!0,fontSize:"small"}):l<50?o.a.createElement(_.a,{disableRipple:!0,disableFocusRipple:!0,fontSize:"small"}):o.a.createElement(z.a,{disableRipple:!0,disableFocusRipple:!0,fontSize:"small"}))))}function Y(t){var e=q(),n=o.a.useState(-1),a=Object(i.a)(n,2),s=a[0],u=a[1],g=o.a.useState(""),b=Object(i.a)(g,2),E=b[0],P=b[1],I=function(e,n){return o.a.createElement(p.a,{align:"center",key:"instrumentPanel-cell-"+n.toString()+"-"+e.toString()},o.a.createElement(J,{control:o.a.createElement(l.a,{checked:t.instrumentMask[e]===n,onChange:function(r){return function(e,n,r){var i=t.instrumentIndex[e].id,a=t.instruments.findIndex((function(t){return i in t[1]})),o=n;if(a!==o){var s=t.instruments[a],u=["",{}];if(null!=s){u[0]=s[0];for(var l=0,c=Object.keys(s[1]);l<c.length;l++){var m=c[l];m!==i.toString()&&(u[1][m]=s[1][m])}}var p=[t.instruments[o][0],Object.assign({},t.instruments[o][1])];p[1][i.toString()]=null!=s?s[1][i]:"X";for(var f=[],h=0;h<t.instruments.length;++h)h===a?f.push(u):h===o?f.push(p):f.push(t.instruments[h]);t.onChange(f)}}(e,n)},name:e+","+n.toString()})}))},F=function(e){return o.a.createElement(d.a,{key:"instrumentPanel-row-"+e.toString()},o.a.createElement(p.a,{component:"th",scope:"row",key:"instrumentPanel-row-"+e.toString()+"-name"},o.a.createElement(x.a,null,t.instruments[e][0]),o.a.createElement(W,{onClick:function(t){return u(e)}},o.a.createElement(k.a,{fontSize:"small"})),o.a.createElement(W,{onClick:function(n){!function(e){var n=t.instruments.slice(0,e).concat(t.instruments.slice(e+1));t.onChange(n)}(e)}},o.a.createElement(S.a,{fontSize:"small"}))),Object(r.a)(Array(t.instrumentIndex.length).keys()).map((function(t){return I(t,e)})))},D=o.a.useState(-1),N=Object(i.a)(D,2),B=N[0],_=N[1],L=o.a.useState(""),z=Object(i.a)(L,2),G=z[0],K=z[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(w.a,{open:s>=0,onClose:function(t){return u(-1)},"aria-labelledby":"form-dialog-title"},o.a.createElement(M.a,{id:"form-dialog-title"}),o.a.createElement(T.a,null,o.a.createElement(R.a,null,"Enter instrument name"),o.a.createElement(j.a,{autoFocus:!0,margin:"dense",id:"name",fullWidth:!0,value:E,onChange:function(t){return P(t.target.value)}})),o.a.createElement(C.a,null,o.a.createElement(y.a,{onClick:function(t){return u(-1)},color:"primary"},"Cancel"),o.a.createElement(y.a,{onClick:function(e){var n=E.trim();if(n.length>0)if(s===t.instruments.length){var r=[n,{}],i=Array.from(t.instruments);i.push(r),t.onChange(i)}else{var a=Array.from(t.instruments);a[s][0]=n,t.onChange(a)}u(-1),P("")},color:"primary"},"Confirm"))),o.a.createElement(w.a,{open:B>=0,onClose:function(t){return _(-1)},"aria-labelledby":"form-dialog-title"},o.a.createElement(M.a,{id:"form-dialog-title"}),o.a.createElement(T.a,null,o.a.createElement(R.a,null,"Enter notation symbol"),o.a.createElement(j.a,{autoFocus:!0,margin:"dense",id:"name",fullWidth:!0,value:G,onChange:function(t){return K(t.target.value)}})),o.a.createElement(C.a,null,o.a.createElement(y.a,{onClick:function(t){return _(-1)},color:"primary"},"Cancel"),o.a.createElement(y.a,{onClick:function(e){var n=G;if(1===n.length){var r=t.instrumentIndex[B].id,i=t.instruments.findIndex((function(t){return r in t[1]})),a=Array.from(t.instruments);a[i][1][r]=G,t.onChange(a)}else alert('You selected an invalid symbol "'+n+'".\nSymbols must be precisely 1 character.');_(-1)},color:"primary"},"Confirm"))),o.a.createElement(f.a,null,o.a.createElement(c.a,{className:e.table,"aria-label":"simple table"},o.a.createElement(h.a,null,o.a.createElement(d.a,{key:"instrumentPanel-row-header"},o.a.createElement(H,{key:"instrumentPanel-row-instrument"}," Instrument "),Object(r.a)(Array(t.instrumentIndex.length).keys()).map((function(e){return o.a.createElement(H,{key:"instrumentPanel-row-header-cell-"+e.toString()},o.a.createElement(x.a,null,t.instrumentIndex[e].name))}))),o.a.createElement(d.a,{key:"instrumentPanel-row-controls"},o.a.createElement(p.a,{key:"instrumentPanel-row-instrument"}),Object(r.a)(Array(t.instrumentIndex.length).keys()).map((function(e){return o.a.createElement(V,{key:"instrumentPanel-row-controls-cell-"+e.toString()},o.a.createElement(A.a,{container:!0},o.a.createElement(A.a,{item:!0,xs:6},o.a.createElement(W,{onClick:function(n){return function(e){var n=t.instrumentIndex[e].id,r=t.instruments.findIndex((function(t){return n in t[1]})),i=t.instruments[r][1][n];K(i),_(e)}(e)}},o.a.createElement(k.a,{fontSize:"small"}))),o.a.createElement(A.a,{item:!0,xs:6},o.a.createElement(X,{muted:t.instrumentIndex[e].muted,onChange:function(n){t.onVolumeEvent({instrument:e,volume:n/100})},onMuteToggle:function(){t.onVolumeEvent({instrument:e,muted:!t.instrumentIndex[e].muted})}}))))})))),o.a.createElement(m.a,null,Object(r.a)(Array(t.instruments.length).keys()).map((function(t){return F(t)})),o.a.createElement(d.a,{key:"instrumentPanel-row-edit"},o.a.createElement(p.a,{component:"th",scope:"row",key:"instrumentPanel-row-edit-cell"},o.a.createElement(O.a,{onClick:function(e){return u(t.instruments.length)},"aria-label":"add"},o.a.createElement(v.a,null))))))))}function $(t,e){for(var n=Array(t.length),r=0;r<t.length;++r)for(var i=t[r].id,a=0;a<e.length;++a){var o=e[a];i.toString()in o[1]&&(n[r]=a)}return n}}},[[305,1,2]]]);
//# sourceMappingURL=main.02c8bb30.chunk.js.map