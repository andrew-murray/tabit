(this.webpackJsonptabit=this.webpackJsonptabit||[]).push([[0],{100:function(t,e,n){"use strict";var i=n(0),r=n.n(i),a=n(300),o=n(459),s=n(293),c=n(64),u=n(274),l=n.n(u),m=n(275),p=n.n(m),h=n(109),d=n(71),f=n(282),j=n.n(f),b=n(281),g=n.n(b),v=n(280),O=n.n(v),x=n(276),k=n.n(x),y=n(277),S=n.n(y),w=n(278),C=n.n(w),D=n(279),T=n.n(D),P=n(6),R=Object(s.a)((function(t){return{root:{zIndex:t.zIndex.drawer+1,backgroundColor:t.palette.secondary}}}));function A(t){var e=R(t);return t.placeholder?Object(P.jsx)(a.a,{variant:"dense"}):Object(P.jsx)(o.a,{position:"fixed",className:e.root,children:Object(P.jsxs)(a.a,{variant:"dense",children:[t.patternsToggle&&Object(P.jsx)(c.a,{color:"inherit","aria-label":"open pattern list",edge:"start",onClick:t.patternsToggle,children:Object(P.jsx)(l.a,{})}),Object(P.jsx)(c.a,{color:"inherit","aria-label":"home",edge:"start",component:h.b,to:"/",children:Object(P.jsx)(p.a,{})}),Object(P.jsx)(d.a,{variant:"h6",color:"inherit",noWrap:!0,style:{flexGrow:1,textOverflow:"ellipsis"},children:t.title}),t.onLockUnlock&&Object(P.jsx)(c.a,{color:"inherit","aria-label":t.locked?"unlock":"lock",edge:"start",onClick:t.onLockUnlock,children:t.locked?Object(P.jsx)(k.a,{}):Object(P.jsx)(S.a,{})}),t.onToggleCompact&&Object(P.jsx)(c.a,{color:"inherit","aria-label":t.compact?"toggle-to-dense-view":"toggle-to-compact-view",edge:"start",onClick:t.onToggleCompact,children:t.compact?Object(P.jsx)(C.a,{}):Object(P.jsx)(T.a,{})}),t.onShare&&Object(P.jsx)(c.a,{color:"inherit","aria-label":"share",edge:"start",onClick:t.onShare,children:Object(P.jsx)(O.a,{})}),t.onDownload&&Object(P.jsx)(c.a,{color:"inherit","aria-label":"download",edge:"start",onClick:t.onDownload,children:Object(P.jsx)(g.a,{})}),t.settingsToggle&&Object(P.jsx)(c.a,{color:"inherit","aria-label":"open settings",edge:"end",onClick:t.settingsToggle,children:Object(P.jsx)(j.a,{})})]})})}e.a=r.a.memo(A)},144:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(17);function r(t,e){for(var n=t.concat([e]),r=0,a=[48,24,16,12,8,6,4,3,2,1];r<a.length;r++){var o,s=a[r],c=!0,u=Object(i.a)(n);try{for(u.s();!(o=u.n()).done;){if(o.value%s!==0){c=!1;break}}}catch(l){u.e(l)}finally{u.f()}if(c)return s}throw new Error("Failed to predict base")}},145:function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"a",(function(){return v}));n(0);var i=n(293),r=n(463),a=n(456),o=n(455),s=n(457),c=n(298),u=n(296),l=n(113),m=n(458),p=n(299),h=n(461),d=n(38),f=n(6),j=Object(i.a)((function(t){return{formControl:{margin:t.spacing(1),minWidth:120}}}));function b(t){var e=t.replace(/([A-Z])/g," $1");return e[0].toUpperCase()+e.slice(1)}function g(t){var e=j(t);function n(t){return" "===t?"space":t}function i(t){return"space"===t?" ":t}var g=function(e,n,i){t.onChange({key:e,value:n,local:i})},v=function(e){t.onChange({key:e.target.name,value:e.target.checked,local:!1})};function O(s,c){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,p=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d="form-control-"+s+"-id";return Object(f.jsx)(l.a,{variant:"filled",className:e.formControl,id:d,style:{width:"75%"},children:Object(f.jsxs)(o.a,{style:{width:"100%"},children:[Object(f.jsx)(r.a,{id:"settings-option-{name}",children:s}),Object(f.jsx)(h.a,{labelId:"settings-option-"+s+"-labelID",id:"settings-option-"+s+"-id",value:m(t.settings[s]),name:s,onChange:function(t){return g(t.target.name,u(t.target.value),p)},style:{width:"75%",textAlign:"center"},children:c.map((function(t){return Object(f.jsx)(a.a,{value:m(t),style:{textAlign:"center"},children:m(t)},"settings-menu-item-"+s+"-"+t)}))})]})},d)}for(var x=[],k=0,y=[2,3,4,5,6,7,8,14,16,32];k<y.length;k++){var S=48*y[k];S%t.settings.beatResolution===0&&S<=t.pattern.length&&x.push(S)}x.includes(t.pattern.length)||(x.push(t.pattern.length),x.sort((function(t,e){return t-e})));for(var w=[],C=0,D=[24,36,48,72,96];C<D.length;C++){var T=D[C];T%t.pattern.resolution===0&&t.settings.lineResolution%T===0&&w.push(T)}for(var P=[],R=0,A=[12,16,24,36,48];R<A.length;R++){var M=A[R];M%t.pattern.resolution!==0&&t.pattern.resolution%M!==0||t.settings.lineResolution%M!==0||P.push(M)}return Object(f.jsx)(s.a,{className:e.root,children:Object(f.jsxs)(u.a,{children:[d.a.FORMAT_CONFIG_STRINGS.map((function(t){return O(t[0],t[1])})).reduce((function(t,e){return[t,e]})),d.a.FORMAT_CONFIG_BOOLS.map((function(e){return n=e,Object(f.jsx)(l.a,{children:Object(f.jsx)(c.a,{control:Object(f.jsx)(p.a,{checked:t.settings[n],onChange:v,name:n}),label:b(n)},"switch-"+n)},"form-control-"+n);var n})).reduce((function(t,e){return[t,e]})),Object(f.jsxs)(m.a,{children:["Pattern "+t.pattern.name+" Options"," "]}),O("beatResolution",w,(function(t){return t.toString()}),(function(t){return parseInt(t)}),!0),O("lineResolution",x,(function(e){return t.settings.beatResolution*parseInt(e)}),(function(e){return(e/t.settings.beatResolution).toString()}),!0)]})})}var v=d.a.DEFAULT_FORMAT_CONFIG},263:function(t){t.exports=JSON.parse('{"instruments":[{"id":23,"name":"Stick","volume":0.99569,"muted":false,"gain":1,"drumkit":"GMRockKit","filename":"SideStick-Softest.wav"},{"id":24,"name":"Kick Short","volume":1,"muted":false,"gain":1,"drumkit":"TR808EmulationKit","filename":"808_Kick_Short.flac"},{"id":20,"name":"Stick","volume":0.193966,"muted":false,"gain":1,"drumkit":"DeathMetal"},{"id":26,"name":"Stick","volume":0.99569,"muted":false,"gain":1,"drumkit":"GMRockKit","filename":"SideStick-Softest.wav"},{"id":25,"name":"Kick Short","volume":1,"muted":false,"gain":1,"drumkit":"TR808EmulationKit","filename":"808_Kick_Short.flac"},{"id":22,"name":"tom02","volume":0.65,"muted":false,"gain":1,"drumkit":"DeathMetal"},{"id":27,"name":"snare","volume":0.49,"muted":false,"gain":1,"drumkit":"DeathMetal","filename":"014b.WAV"},{"id":13,"name":"Snare 1","volume":0.35,"muted":false,"gain":0.4,"drumkit":"DeathMetal"},{"id":10,"name":"Djembe4 Slap","volume":0.12931,"muted":false,"gain":1,"drumkit":"circAfrique v4","filename":"Djembe4 Slap.wav"},{"id":11,"name":"Djembe4 Tone","volume":0.12931,"muted":false,"gain":0.95,"drumkit":"circAfrique v4","filename":"Djembe4 Tone.wav"},{"id":12,"name":"Djembe4 Bass","volume":0.181034,"muted":false,"gain":1.5,"drumkit":"circAfrique v4","filename":"Djembe4 Bass.wav"},{"id":16,"name":"Shaker","volume":0.232759,"muted":false,"gain":2.2,"drumkit":"TR808EmulationKit","filename":"808_Shaker.flac"},{"id":21,"name":"Shaker","volume":1.5,"muted":false,"gain":2.45,"drumkit":"TR808EmulationKit","filename":"808_Shaker.flac"}],"patterns":[{"size":384,"name":"k-1","notes":[{"position":0,"instrument":21},{"position":0,"instrument":24},{"position":0,"instrument":26},{"position":0,"instrument":11},{"position":12,"instrument":21},{"position":24,"instrument":11},{"position":24,"instrument":21},{"position":24,"instrument":24},{"position":24,"instrument":26},{"position":24,"instrument":27},{"position":36,"instrument":21},{"position":36,"instrument":11},{"position":48,"instrument":21},{"position":48,"instrument":11},{"position":48,"instrument":23},{"position":48,"instrument":26},{"position":48,"instrument":27},{"position":60,"instrument":24},{"position":72,"instrument":10},{"position":72,"instrument":21},{"position":72,"instrument":26},{"position":84,"instrument":25},{"position":96,"instrument":23},{"position":96,"instrument":26},{"position":108,"instrument":25},{"position":120,"instrument":12},{"position":120,"instrument":25},{"position":144,"instrument":12},{"position":144,"instrument":21},{"position":144,"instrument":23},{"position":144,"instrument":25},{"position":144,"instrument":27},{"position":156,"instrument":21},{"position":168,"instrument":21},{"position":180,"instrument":27},{"position":192,"instrument":11},{"position":192,"instrument":21},{"position":192,"instrument":24},{"position":192,"instrument":26},{"position":216,"instrument":12},{"position":216,"instrument":21},{"position":216,"instrument":24},{"position":216,"instrument":26},{"position":216,"instrument":27},{"position":240,"instrument":11},{"position":240,"instrument":23},{"position":240,"instrument":26},{"position":240,"instrument":27},{"position":252,"instrument":12},{"position":252,"instrument":24},{"position":264,"instrument":21},{"position":264,"instrument":27},{"position":276,"instrument":11},{"position":276,"instrument":25},{"position":288,"instrument":12},{"position":288,"instrument":21},{"position":288,"instrument":24},{"position":288,"instrument":25},{"position":300,"instrument":21},{"position":312,"instrument":11},{"position":312,"instrument":23},{"position":312,"instrument":26},{"position":324,"instrument":12},{"position":324,"instrument":21},{"position":324,"instrument":24},{"position":324,"instrument":25},{"position":336,"instrument":21},{"position":336,"instrument":27},{"position":360,"instrument":21},{"position":360,"instrument":10},{"position":360,"instrument":23},{"position":360,"instrument":26},{"position":360,"instrument":27},{"position":372,"instrument":21},{"position":372,"instrument":27}],"resolution":12,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],"resolution":12},"11":{"rep":[1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0],"resolution":12},"12":{"rep":[0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0],"resolution":12},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"21":{"rep":[1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,0,1,1],"resolution":12},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"23":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0],"resolution":12},"24":{"rep":[1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0],"resolution":12},"25":{"rep":[0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0],"resolution":12},"26":{"rep":[1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0],"resolution":12},"27":{"rep":[0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,1,0,1,1],"resolution":12}}},{"size":384,"name":"k-2","notes":[{"position":0,"instrument":12},{"position":0,"instrument":21},{"position":0,"instrument":24},{"position":0,"instrument":25},{"position":0,"instrument":27},{"position":12,"instrument":12},{"position":12,"instrument":24},{"position":12,"instrument":25},{"position":24,"instrument":12},{"position":24,"instrument":21},{"position":24,"instrument":24},{"position":24,"instrument":25},{"position":36,"instrument":21},{"position":48,"instrument":21},{"position":48,"instrument":10},{"position":48,"instrument":23},{"position":48,"instrument":26},{"position":48,"instrument":27},{"position":72,"instrument":21},{"position":84,"instrument":21},{"position":84,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":23},{"position":96,"instrument":26},{"position":108,"instrument":21},{"position":108,"instrument":27},{"position":120,"instrument":11},{"position":120,"instrument":21},{"position":132,"instrument":10},{"position":132,"instrument":27},{"position":144,"instrument":23},{"position":144,"instrument":26},{"position":144,"instrument":27},{"position":156,"instrument":10},{"position":168,"instrument":12},{"position":168,"instrument":21},{"position":168,"instrument":24},{"position":168,"instrument":25},{"position":180,"instrument":12},{"position":180,"instrument":24},{"position":180,"instrument":25},{"position":192,"instrument":12},{"position":192,"instrument":21},{"position":192,"instrument":24},{"position":192,"instrument":25},{"position":192,"instrument":27},{"position":216,"instrument":21},{"position":216,"instrument":11},{"position":228,"instrument":11},{"position":228,"instrument":21},{"position":228,"instrument":27},{"position":240,"instrument":21},{"position":240,"instrument":23},{"position":240,"instrument":26},{"position":240,"instrument":27},{"position":252,"instrument":10},{"position":264,"instrument":21},{"position":264,"instrument":11},{"position":276,"instrument":21},{"position":276,"instrument":27},{"position":288,"instrument":11},{"position":288,"instrument":21},{"position":288,"instrument":23},{"position":288,"instrument":26},{"position":300,"instrument":11},{"position":312,"instrument":21},{"position":324,"instrument":10},{"position":336,"instrument":11},{"position":336,"instrument":23},{"position":336,"instrument":26},{"position":360,"instrument":21}],"resolution":12,"instrumentTracks":{"10":{"rep":[0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],"resolution":12},"11":{"rep":[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,0,0,1,0,0,0],"resolution":12},"12":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"21":{"rep":[1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,0,0,1,0],"resolution":12},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"23":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":12},"24":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"25":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"26":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":12},"27":{"rep":[1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0],"resolution":12}}},{"size":192,"name":"lightbulb","notes":[{"position":0,"instrument":24},{"position":12,"instrument":24},{"position":24,"instrument":24},{"position":36,"instrument":24},{"position":48,"instrument":24},{"position":96,"instrument":27},{"position":144,"instrument":24},{"position":160,"instrument":24},{"position":176,"instrument":24}],"resolution":4,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"11":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"12":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"21":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"23":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"24":{"rep":[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":4},"25":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"26":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"27":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4}}},{"size":192,"name":"break","notes":[{"position":24,"instrument":21},{"position":24,"instrument":11},{"position":24,"instrument":27},{"position":48,"instrument":21},{"position":48,"instrument":11},{"position":48,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":11},{"position":96,"instrument":27},{"position":120,"instrument":21},{"position":120,"instrument":11},{"position":120,"instrument":27},{"position":144,"instrument":24},{"position":168,"instrument":21},{"position":168,"instrument":11},{"position":168,"instrument":24},{"position":168,"instrument":27}],"resolution":24,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"11":{"rep":[0,1,1,0,1,1,0,1],"resolution":24},"12":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"13":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"16":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"20":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"21":{"rep":[0,1,1,0,1,1,0,1],"resolution":24},"22":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"23":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"24":{"rep":[0,0,0,0,0,0,1,1],"resolution":24},"25":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"26":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"27":{"rep":[0,1,1,0,1,1,0,1],"resolution":24}}},{"size":192,"name":"squash","notes":[{"position":0,"instrument":21},{"position":0,"instrument":12},{"position":0,"instrument":24},{"position":0,"instrument":27},{"position":48,"instrument":21},{"position":48,"instrument":12},{"position":48,"instrument":24},{"position":48,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":12},{"position":96,"instrument":24},{"position":96,"instrument":27},{"position":144,"instrument":21},{"position":144,"instrument":12},{"position":144,"instrument":24},{"position":144,"instrument":27}],"resolution":48,"instrumentTracks":{"10":{"rep":[0,0,0,0],"resolution":48},"11":{"rep":[0,0,0,0],"resolution":48},"12":{"rep":[1,1,1,1],"resolution":48},"13":{"rep":[0,0,0,0],"resolution":48},"16":{"rep":[0,0,0,0],"resolution":48},"20":{"rep":[0,0,0,0],"resolution":48},"21":{"rep":[1,1,1,1],"resolution":48},"22":{"rep":[0,0,0,0],"resolution":48},"23":{"rep":[0,0,0,0],"resolution":48},"24":{"rep":[1,1,1,1],"resolution":48},"25":{"rep":[0,0,0,0],"resolution":48},"26":{"rep":[0,0,0,0],"resolution":48},"27":{"rep":[1,1,1,1],"resolution":48}}}]}')},283:function(t,e,n){"use strict";(function(t){var i=n(0),r=n.n(i),a=n(302),o=n(296),s=n(64),c=n(113),u=n(294),l=n(301),m=n(100),p=n(148),h=n.n(p),d=n(149),f=n.n(d),j=n(53),b=n(6),g=function(t){var e=t.selectPattern,n=t.index,i=t.pattern,a=t.onRemove,o=r.a.useCallback((function(){e&&e(n)}),[n,e]),m=r.a.useCallback((function(t){t.stopPropagation(),t.preventDefault(),a(n)}),[n,a]);return Object(b.jsxs)(c.a,{button:!0,onClick:o,children:[Object(b.jsx)(u.a,{primary:i.name}),a&&Object(b.jsx)(l.a,{children:Object(b.jsx)(s.a,{edge:"end",size:"small",onClick:m,children:Object(b.jsx)(h.a,{fontSize:"small"})})})]},"drawer-pattern"+n.toString())};function v(t){var e,n=Object(j.a)();return Object(b.jsxs)(r.a.Fragment,{children:[n?null:Object(b.jsx)(m.a,{placeholder:!0}),Object(b.jsx)("div",{style:{overflow:"auto"},children:Object(b.jsxs)(o.a,{children:[(null!==(e=t.patterns)&&void 0!==e?e:[]).map((function(e,n){return Object(b.jsx)(g,{pattern:e,index:n,onRemove:t.onRemove,selectPattern:t.selectPattern},"pattern-key-"+String(n))})),t.onAdd&&Object(b.jsxs)(c.a,{children:[Object(b.jsx)(u.a,{}),Object(b.jsx)(l.a,{children:Object(b.jsx)(s.a,{size:"small",edge:"end",onClick:function(){t.onAdd()},"aria-label":"add",children:Object(b.jsx)(f.a,{size:"small"})})})]},"drawer-add-button")]})})]})}var O=r.a.memo(v);function x(e){var n=t.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent),i=Object(j.a)();return Object(b.jsx)(a.a,{disableBackdropTransition:!n,disableDiscovery:n,variant:i?void 0:"persistent",open:e.open,onOpen:e.onOpen,onClose:e.onClose,ModalProps:{keepMounted:!0},children:Object(b.jsx)(O,{patterns:e.patterns,onRemove:e.onRemove,selectPattern:e.selectPattern,onAdd:e.onAdd})})}e.a=r.a.memo(x)}).call(this,n(66))},284:function(t,e,n){"use strict";(function(t){var i=n(0),r=n.n(i),a=n(38),o=n(302),s=n(291),c=n(453),u=n(145),l=n(53),m=n(100),p=n(299),h=n(298),d=n(6);function f(e){var n,i=t.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent),f=Object(l.a)(),j=e.pattern?{name:e.pattern.name,resolution:e.pattern.resolution,length:a.a.getPatternLength(e.pattern)}:null;return Object(d.jsxs)(o.a,{disableBackdropTransition:!i,disableDiscovery:i,className:e.className,variant:f?void 0:"persistent",anchor:e.anchor,open:e.open,onOpen:e.onOpen,onClose:e.onClose,style:{overflow:"hidden"},children:[f?null:Object(d.jsx)(m.a,{placeholder:!0}),j&&Object(d.jsx)(u.b,{onChange:null!==(n=e.onChange)&&void 0!==n?n:function(){},settings:e.settings,pattern:j}),Object(d.jsx)("div",{children:Object(d.jsx)(h.a,{control:Object(d.jsx)(p.a,{checked:e.animating,onChange:function(t){e.onChange&&e.onChange({key:"animate",value:t.target.checked,local:!1})},name:"Display Beat"}),label:"Display Beat"},"DisplayBeat")}),j&&e.onSave&&Object(d.jsxs)(r.a.Fragment,{children:[Object(d.jsx)(s.a,{onClick:function(t){e.onSave()},children:"Download"}),Object(d.jsx)(c.a,{})]}),j&&e.onShare&&Object(d.jsx)(s.a,{onClick:function(t){e.onShare()},children:"Share"})]})}e.a=r.a.memo(f)}).call(this,n(66))},326:function(t,e,n){},334:function(t,e){},336:function(t,e){},356:function(t,e,n){},38:function(t,e,n){"use strict";var i=n(17),r=n(16),a=n(15),o=n(1),s=n(2),c=n(92),u=function(){function t(){Object(o.a)(this,t)}return Object(s.a)(t,null,[{key:"validateConfig",value:function(t,e){if(null!=e&&t.beatResolution%e!==0)throw new Error("patternResolution doesn't divide beatResolution");if(t.lineResolution<=0)throw new Error("config.lineResolution must be greater than zero")}},{key:"resolveConfig",value:function(e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(!t.DEFAULT_FORMAT_CONFIG.hasOwnProperty(r))throw new Error("passed unrecognised property "+r)}return Object.assign(Object.assign({},t.DEFAULT_FORMAT_CONFIG),e)}},{key:"chunkString",value:function(t,e){if(e<=0)throw new Error("chunkSize must be > 0");return t.match(new RegExp(".{1,"+e+"}","g"))}},{key:"chunkArray",value:function(t,e){if(e<=0)throw new Error("chunkSize must be > 0");for(var n=[],i=0;i<t.length;i+=e)n.push(t.slice(i,Math.min(i+e,t.length)));return n}},{key:"createNumberMarker",value:function(t,e,n,i){if(i<=0)throw new Error("lineLength <= 0");if(e%n!==0)throw new Error("patternResolution "+n.toString()+" does not divide beatResolution "+e.toString());for(var r=Math.ceil(i/e),a=Array.from(Array(i/n),(function(e){return t})),o=0;o<r;o++)a[o*(e/n)]=((o+1)%10).toString();return a}},{key:"formatLineWithMarkers",value:function(e,n,i,r){t.validateConfig(e);for(var a=e.beatResolution/i,o=r?function(t,e){return"<span class='note-"+(n=e,((n+="").length>=(i=4)?n:new Array(i-n.length+1).join("0")+n)+"'>")+t+"</span>";var n,i}:function(t,e){return t},s="",c=0;c<n.length;++c){var u=i*c;s+=o(n.charAt(c),u)}var l=e.showBeatMark?t.chunkString(s,a*o("X",0).length).join(e.beatMark):s;return e.lineMark+l+e.lineMark}},{key:"defaultLineResolution",value:function(t,e){var n=Object.values(t);if(0===n.length)return 384;var i=n[0].length(),r=i/e;return r<=12?i:r>32?768:[i,i/2,i/3,i/2,i,i/3,i,i/4,i/3,i/2,i,i/3,i/5,i,i/3,i/4,i,i/6,i,i/4][r-13]}},{key:"guessPerPatternSettings",value:function(e){return{lineResolution:t.defaultLineResolution(e,48),beatResolution:48}}},{key:"formatPatternString",value:function(t,e,n){if(0===Object.values(e).length)return"";for(var i=Object.keys(t)[0],r=e[i].resolution,o=e[i].length(),s=Array(o/r).fill(n),c=0;c<s.length;++c)for(var u=0,l=Object.entries(t);u<l.length;u++){var m=Object(a.a)(l[u],2),p=m[0],h=m[1],d=e[p];null!=d&&1===d.rep[c]&&(s[c]=h)}return s}},{key:"fromInstrumentAndTrack",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=t.resolveConfig(r),o=Object.values(n);if(0===o.length)return"";var s=t.formatPatternString(e,n,a.restMark),c=s.join(""),u=o[0].resolution,l=o[0].length(),m=t.chunkString(c,a.lineResolution/u),p=[];a.showBeatNumbers&&p.push(t.formatLineWithMarkers(a,t.createNumberMarker(a.numberRestMark,a.beatResolution,u,Math.min(a.lineResolution,l)).join(""),u,i));for(var h=0;h<m.length;++h)p.push(t.formatLineWithMarkers(a,m[h],u,i));return p.join("\n")}},{key:"getPatternLength",value:function(t){for(var e=48,n=0,i=Object.entries(t.instrumentTracks);n<i.length;n++){var r=Object(a.a)(i[n],2)[1];e=Math.max(e,r.length())}return e}},{key:"getPatternResolution",value:function(t){for(var e=48,n=0,i=Object.entries(t.instrumentTracks);n<i.length;n++){var r=Object(a.a)(i[n],2)[1];e=Math.min(e,r.resolution)}return e}},{key:"clonePattern",value:function(t,e){var n=Object.keys(e.instrumentTracks).map((function(t){return[t,e.instrumentTracks[t].clone()]}));return{size:e.size,name:t,resolution:e.resolution,instrumentTracks:Object.fromEntries(n)}}},{key:"combinePatterns",value:function(t,e,n){var a,o=c.a.optimalResolution(e.resolution,n.resolution),s=e.size+n.size,u=new Set([].concat(Object(r.a)(Object.keys(e.instrumentTracks)),Object(r.a)(Object.keys(e.instrumentTracks)))),l={},m=Object(i.a)(u);try{for(m.s();!(a=m.n()).done;){var p=a.value;l[p]=c.a.combine(e.instrumentTracks[p],n.instrumentTracks[p],s,o)}}catch(h){m.e(h)}finally{m.f()}return{resolution:o,size:s,name:t,instrumentTracks:l}}}]),t}();u.DEFAULT_FORMAT_CONFIG={restMark:"-",beatMark:"|",lineMark:"|",numberRestMark:"-",beatResolution:48,showBeatMark:!0,showBeatNumbers:!0,compactDisplay:!1,lineResolution:384},u.FORMAT_CONFIG_STRINGS=[["restMark",["-","."," "]],["numberRestMark",["-","."," "]]],u.FORMAT_CONFIG_BOOLS=["showBeatMark","showBeatNumbers"],e.a=u},450:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(27),o=n.n(a),s=(n(326),n(24)),c=n(109),u=n(1),l=n(2),m=n(4),p=n(3),h=n(13),d=n(10),f=n(61),j=n(291),b=n(6),g=["onImport","accept"],v=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).hiddenFileInput=r.a.createRef(),i}return Object(l.a)(n,[{key:"onChange",value:function(t){var e=this,n=t.target.files[0],i=new FileReader;i.onload=function(t){e.props.onImport&&e.props.onImport({file:n,content:t.target.result})},i.readAsText(n)}},{key:"render",value:function(){var t=this,e=Object(d.a)({},this.props),n=(e.onImport,e.accept),i=Object(f.a)(e,g);return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(j.a,Object(d.a)(Object(d.a)({onClick:function(e){t.hiddenFileInput.current.click()}},i),{},{children:"Import File"})),Object(b.jsx)("input",{type:"file",hidden:!0,accept:n,onChange:function(e){return t.onChange(e)},ref:this.hiddenFileInput})]})}}]),n}(r.a.Component),O=n(16),x=n(293),k=n(296),y=n(295),S=n(71),w=n(113),C=n(294),D=n(453),T=Object(x.a)((function(t){return{root:{width:"100%",height:400,minWidth:200,maxWidth:300,maxHeight:200,overflow:"auto"}}}));var P=function(t){var e=T(),n=t.data;return Object(b.jsx)("div",{className:e.root,children:Object(b.jsxs)(y.a,{children:[Object(b.jsx)(S.a,{children:"Recently viewed"}),Object(b.jsx)(D.a,{}),Object(b.jsx)(k.a,{children:Object(O.a)(n.keys()).map((function(e){return function(t){return Object(b.jsx)(w.a,{button:!0,style:t.style,onClick:t.onClick,children:Object(b.jsx)(C.a,{primary:t.name,secondary:new Date(t.date).toLocaleDateString()})},t.index)}({index:e,name:n[e].name,id:n[e].id,date:n[e].date,onClick:function(){t.onClick&&t.onClick(n[e])}})}))})]})})},R=n(504),A=n(509),M=n(507),I=n(508),N=n(506);var E=function(t){return Object(b.jsxs)(R.a,{open:t.open,onClose:t.onClose,children:[Object(b.jsx)(N.a,{id:"text-dialog-title",children:t.title}),Object(b.jsx)(M.a,{children:Object(b.jsx)(I.a,{children:t.children})}),Object(b.jsx)(A.a,{children:Object(b.jsx)(j.a,{onClick:t.onClose,variant:"contained",children:"ok"})})]})},F=n(57),L=(n(356),function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).state={error:t.props.error,songHistory:[]},t.componentDidMount=function(){t.setState({songHistory:F.d()})},t}return Object(l.a)(n,[{key:"render",value:function(){var t=this,e=Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(j.a,{variant:"contained",onClick:function(){t.props.navigate("/example")},style:{margin:"1em"},children:"Load example"}),Object(b.jsx)(v,{style:{margin:"1em"},variant:"contained",onImport:function(e){t.props.navigate("/import",{state:{filename:e.file.name,content:e.content}})},accept:".tabit,.h2song"})]}),n=this.props.classes;return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"tabit"}),Object(b.jsx)("p",{children:"I read .h2songs and write tab"}),e]}),Object(b.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto"},children:this.state.songHistory.length>0&&Object(b.jsx)(P,{data:this.state.songHistory,onClick:function(e){t.props.navigate("/recent/"+e.id+"/",{state:{songName:e.name}})}})}),!!this.state.error&&Object(b.jsx)(E,{title:"Something went wrong.",open:!!this.state.error,onClose:function(){t.setState({error:null})},children:this.state.error}),Object(b.jsx)("div",{className:n.licenseBanner,children:Object(b.jsxs)("p",{children:["tabit relies on publicly available sound libraries listed at ",Object(b.jsx)("a",{href:"https://github.com/andrew-murray/tabit",children:"https://github.com/andrew-murray/tabit"})]})})]})}}]),n}(r.a.Component)),B=Object(h.a)((function(t){return{licenseBanner:{position:"absolute",bottom:0,width:"95%",textAlign:"center",backgroundColor:"#212121",zIndex:t.zIndex.drawer},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:t.palette.background.paper,border:"2px solid #000",boxShadow:t.shadows[5],padding:t.spacing(2,4,3)}}}))(L),z=n(525),_=n(530),G=n(290),V=n(524),H=n(523),W=n(522),K=n(15),J=n(17),U=n(263),q={"Djembe Slap":"S","Djembe Tone":"t","Djembe Bass":"O","Snare Ghost":"x","Snare Accent":"X","Shaker Ghost":"x","Shaker Accent":"X",Click:"X",Bass:"O",Tom:"O",Default:"X"};function X(t){var e,n=[],i=Object(J.a)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value,a=Object.assign({},r);a.name=a.name.toLowerCase(),n.push(a)}}catch(o){i.e(o)}finally{i.f()}return n}function $(t,e,n,i){var r=[];if(2===t.length){var a=t[0],o=t[1],s=a.volume>o.volume||a.volume===o.volume&&a.gain>o.gain,c={};c[a.id.toString()]=s?n:i,c[o.id.toString()]=s?i:n,r.push([e,c])}else{var u,l=Object(J.a)(t);try{for(l.s();!(u=l.n()).done;){var m=u.value,p={};p[m.id.toString()]=n,r.push([e,p])}}catch(h){l.e(h)}finally{l.f()}}return r}function Y(t){var e,n=new Set,i=Object(J.a)(t);try{for(i.s();!(e=i.n()).done;)for(var r=e.value,a=0,o=Object.entries(r.instrumentTracks);a<o.length;a++){var s=Object(K.a)(o[a],2),c=s[0];s[1].empty()||n.add(parseInt(c))}}catch(u){i.e(u)}finally{i.f()}return n}function Z(t,e){var n=e.toLowerCase();return n.includes("click")||n.includes("stick")?t.Click:n.includes("bass")||n.includes("kick")?t.Bass:n.includes("snare")?t["Snare Accent"]:n.includes("shaker")?t.Shaker:n.includes("tom")?t.Tom:n.includes("djembe")?n.includes("slap")?t["Djembe Slap"]:n.includes("tone")?t["Djembe Tone"]:t["Djembe Bass"]:t.Default}function Q(t,e,n){var i=[];i=i.concat(function(t,e,n){for(var i=X(t),r=Y(n),a=i.filter((function(t){return r.has(t.id)&&!t.name.includes("djembe")&&(t.name.includes("click")||t.name.includes("stick")||t.name.includes("tom")||t.name.includes("bass")||t.name.includes("kick"))})),o=Array.from(a,(function(t){return t.name.includes("click")||t.name.includes("stick")})),s=1,c=1,u=[],l=0;l<Math.floor(a.length/2);++l)if(o[2*l]!==o[2*l+1]){var m=o[2*l]?a[2*l]:a[2*l+1],p=o[2*l]?a[2*l+1]:a[2*l],h=p.name.includes("tom"),d=h?"Tom":"Bass",f="";h?(f=d+(s>=2?" "+s.toString():""),s+=1):(f=d+(c>=2?" "+c.toString():""),c+=1);var j={};j[p.id.toString()]=e[d],j[m.id.toString()]=e.Click,u.push([f,j])}if(a.length%2!==0&&!o[a.length-1]){var b=a[a.length-1],g=b.name.includes("tom"),v=g?"Tom":"Bass",O="";g?(O=v+(s>=2?" "+s.toString():""),s+=1):(O=v+(c>=2?" "+c.toString():""),c+=1);var x={};x[b.id.toString()]=e[v],u.push([O,x])}return u}(t,e,n)),i=i.concat(function(t,e){var n=X(t).filter((function(t){return t.name.includes("djembe")}));if(0===n.length)return[];if(n.length<=3){for(var i=Array.from(n,(function(t){return t.name.includes("slap")})),r=Array.from(n,(function(t){return t.name.includes("tone")})),a=Array.from(n,(function(t){return t.name.includes("bass")})),o=0;o<n.length;++o)if(1!==i[o]+r[o]+a[o])return[];for(var s={},c=0;c<n.length;++c)i[c]?s[n[c].id.toString()]=e["Djembe Slap"]:r[c]?s[n[c].id.toString()]=e["Djembe Tone"]:a[c]&&(s[n[c].id.toString()]=e["Djembe Bass"]);return[["Djembe",s]]}return[]}(t,e)),i=i.concat(function(t,e){return $(X(t).filter((function(t){return t.name.includes("snare")})),"Snare",e["Snare Accent"],e["Snare Ghost"])}(t,e)),i=i.concat(function(t,e){return $(X(t).filter((function(t){return t.name.includes("shaker")})),"Shaker",e["Shaker Accent"],e["Shaker Ghost"])}(t,e));var r,a=Y(n),o=Object(J.a)(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(a.has(s.id)){var c,u=!1,l=Object(J.a)(i);try{for(l.s();!(c=l.n()).done;){var m=c.value;s.id.toString()in m[1]&&(u=!0)}}catch(h){l.e(h)}finally{l.f()}if(!1===u){var p={};p[s.id.toString()]=Z(e,s.name),i.push([s.name,p])}}}}catch(h){o.e(h)}finally{o.f()}return i}function tt(t,e){for(var n=Array(t.length),i=0;i<t.length;++i)for(var r=t[i].id,a=0;a<e.length;++a){var o=e[a];r.toString()in o[1]&&(n[i]=a)}return n}function et(t){var e=t.match(/\d+/);return e?t.substr(0,2)+e[0]:t.substr(0,2)}var nt=n(92),it=n(145),rt=n(38),at=function t(e,n,i,r,a,o,s,c){Object(u.a)(this,t),this.title=e,this.sourceFile=n,this.instruments=i,this.instrumentIndex=r,this.instrumentMask=a,this.patterns=o,this.formatSettings=s,this.patternSettings=c};function ot(t,e,n,i){return new Promise((function(r){var a=function(t){var e,n=[],i=Object(J.a)(t);try{for(i.s();!(e=i.n()).done;){for(var r=e.value,a={},o=0,s=Object.entries(r.instrumentTracks);o<s.length;o++){var c=Object(K.a)(s[o],2),u=c[0],l=c[1];a[u]=new nt.a(l.rep,l.resolution)}var m=Object.assign({},r);m.instrumentTracks=a,n.push(m)}}catch(p){i.e(p)}finally{i.f()}return n}(t.patterns),o=function(t){return t.map((function(t){return 2===t.length?[t[0],t[1],{shortName:et(t[0])}]:t}))}(i?Q(t.instruments,q,a):t.instruments),s=t.instrumentIndex?t.instrumentIndex:function(t){var e,n=Object(J.a)(t);try{for(n.s();!(e=n.n()).done;)e.value.volume=.5}catch(i){n.e(i)}finally{n.f()}return t}(function(t,e){var n,i=Y(e),r=[],a=Object(J.a)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.has(o.id)&&r.push(o)}}catch(s){a.e(s)}finally{a.f()}return r}(t.instruments,a)),c=tt(s,o),u=t.formatSettings?t.formatSettings:Object.assign({},it.a),l=t.patternSettings?t.patternSettings:function(t){return Array.from(t,(function(t){return rt.a.guessPerPatternSettings(t.instrumentTracks)}))}(a);r(new at(e,n,o,s,c,a,u,l))}))}var st={LoadExample:function(){return ot(U,"kuva","kuva.example",!0)},LoadJSON:ot},ct=n(48),ut=function(t){return{root:{fontFamily:"Roboto Mono",fontSize:"1.2rem","@media (min-width:800px)":{fontSize:"1.4rem"}}}},lt=Object(h.a)(ut)(S.a),mt=Object(h.a)((function(t){return{root:{fontFamily:"Roboto Mono",fontSize:"0.8rem","@media (min-width:800px)":{fontSize:"1.1rem"}}}}))(S.a),pt=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).state={},i}return Object(l.a)(n,[{key:"render",value:function(){var t=this;if(0===Object.values(this.props.tracks).length)return Object(b.jsx)(r.a.Fragment,{});var e=rt.a.formatPatternString(this.props.instrument,this.props.tracks,this.props.config.restMark),n=Object.keys(this.props.instrument)[0],i=this.props.tracks[n].resolution;if(this.props.config.lineResolution%this.props.config.beatResolution!==0&&e.length*i>this.props.config.lineResolution)throw new Error("This code only supports a beatResolution that divides the lineResolution");var a=rt.a.chunkArray(e,this.props.config.lineResolution/i,0),o=this.props.config.lineResolution/this.props.config.beatResolution,s=this.props.config.beatResolution/i,c=a.map((function(t){return rt.a.chunkArray(t,s)})),u=Object(O.a)(a.keys()),l=this.props.dense?mt:lt,m=function(e,n,i,a){var o=Object(O.a)(n.keys()),s=function(t){return i.map((function(e){return"partNote"+(t+e).toString()})).join(" ")};return Object(b.jsxs)(l,{component:"div",children:[a&&Object(b.jsx)(l,{variant:"subtitle1",component:"span",style:{display:"inline-block"},children:a},"line-prefix-"+e),Object(b.jsx)(l,{variant:"subtitle1",component:"span",style:{display:"inline-block"},children:t.props.config.lineMark},"line-start-"+e),o.map((function(e){return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)(l,{variant:"subtitle1",component:"span",className:s(e),style:{display:"inline-block"},children:n[e].join("")},"span-beat-"+(e+i[0]).toString()),Object(b.jsx)(l,{variant:"subtitle1",component:"span",style:{display:"inline-block"},children:t.props.config.showBeatMark&&e!==o[o.length-1]?t.props.config.beatMark:""},"span-beat-marker-"+(e+i[0]).toString())]},"fragment-beat-"+(e+i[0]).toString())})),Object(b.jsx)(l,{variant:"subtitle1",component:"span",children:t.props.config.lineMark},"line-end-"+e)]},"pattern-line-"+e)},p=rt.a.createNumberMarker(this.props.config.numberRestMark,this.props.config.beatResolution,i,Math.min(this.props.config.lineResolution,a[0].length*i)),h=rt.a.chunkArray(p,this.props.config.beatResolution/i),d=this.props.prefix?" ".repeat(this.props.prefix.length):null;return Object(b.jsxs)("div",{children:[this.props.config.showBeatNumbers?m("beat",h,[0],d):"",u.map((function(e){return m(e.toString(),c[e],[o*e],0===e?t.props.prefix:d)}))]})}}]),n}(r.a.Component),ht=Object(h.a)(ut)(pt);var dt=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).state={},i}return Object(l.a)(n,[{key:"render",value:function(){var t=function(t,e){var n=t?t.toLowerCase():"";return["h1","h2","h3","h4","h5","h6"].includes(n)?n:e}(this.props.headingLevel,"h4");return Object(b.jsxs)("article",{children:[Object(b.jsx)(t,{children:this.props.instrumentName}),Object(b.jsx)(ht,{instrument:this.props.instrument,tracks:this.props.tracks,config:this.props.config,dense:this.props.dense})]})}}]),n}(r.a.Component),ft=r.a.memo((function(t){var e,n=Object(O.a)(t.instruments.keys()),i=t.instruments.map((function(t){return t[2].shortName.length})),r=Math.max.apply(Math,Object(O.a)(i)),a=new Map,o=Object(J.a)(t.instruments);try{for(o.s();!(e=o.n()).done;){var s,c=e.value,u=Object.keys(c[1]),l=Object(J.a)(u);try{for(l.s();!(s=l.n()).done;){var m=s.value;a[m]=t.tracks[m]}}catch(p){l.e(p)}finally{l.f()}}}catch(p){o.e(p)}finally{o.f()}return t.config.compactDisplay?Object(b.jsx)("div",{style:{margin:"auto"},children:n.map((function(e){return Object(b.jsx)(ht,{instrument:t.instruments[e][1],tracks:a,config:(i=t.config,o=e,0===o?Object(d.a)({},i):Object(d.a)(Object(d.a)({},i),{},{showBeatNumbers:!1})),prefix:(n=t.instruments[e][2].shortName,n+" ".repeat(r-n.length))},"part-"+e.toString());var n,i,o}))}):Object(b.jsx)("div",{style:{margin:"auto"},children:n.map((function(e){return Object(b.jsx)(dt,{instrumentName:t.instruments[e][0],instrument:t.instruments[e][1],tracks:a,config:t.config,dense:!0},"part-"+e.toString())}))})})),jt=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).ref=r.a.createRef(),i}return Object(l.a)(n,[{key:"calculateBeat",value:function(t,e){return void 0!==e&&null!==e?Math.floor(e/t.beatResolution):null}},{key:"changePatternTime",value:function(t,e,n){if(e!==t||n){if(null!==t){var i,r=this.ref.current.getElementsByClassName("partNote"+t.toString()),a=Object(J.a)(r);try{for(a.s();!(i=a.n()).done;){i.value.classList.remove("activeNote")}}catch(u){a.e(u)}finally{a.f()}}if(null!==e){var o,s=this.ref.current.getElementsByClassName("partNote"+e.toString()),c=Object(J.a)(s);try{for(c.s();!(o=c.n()).done;){o.value.classList.add("activeNote")}}catch(u){c.e(u)}finally{c.f()}}}}},{key:"componentDidUpdate",value:function(t,e,n){if(t.instruments!==this.props.instruments||t.tracks!==this.props.tracks||t.config!==this.props.config||t.classes!==this.props.classes)return this.changePatternTime(this.calculateBeat(t.config,t.patternTime),this.calculateBeat(this.props.config,this.props.patternTime),!0),!0}},{key:"shouldComponentUpdate",value:function(t,e){return t.instruments!==this.props.instruments||t.tracks!==this.props.tracks||t.config!==this.props.config||t.classes!==this.props.classes||t.patternTime!==this.props.patternTime&&(this.changePatternTime(this.calculateBeat(this.props.config,this.props.patternTime),this.calculateBeat(t.config,t.patternTime),!0),!1)}},{key:"render",value:function(){return Object(b.jsx)("div",{className:this.props.classes.root,ref:this.ref,children:Object(b.jsx)(ft,{instruments:this.props.instruments,tracks:this.props.tracks,config:this.props.config})})}}]),n}(r.a.Component),bt=Object(h.a)((function(t){return{root:{fontFamily:"Roboto Mono",textAlign:"left",whiteSpace:"pre",margin:"auto",paddingLeft:10,paddingRight:10,"& .activeNote":{color:t.palette.secondary.main}}}}))(jt),gt=n(64),vt=n(265),Ot=n.n(vt),xt=n(266),kt=n.n(xt),yt=n(533),St=n(513),wt=n(532);function Ct(t){var e="Playback disabled while content unlocked.",n=t.disabled?e:"",i=t.disabled?e:"";return Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsxs)("div",{children:[Object(b.jsx)(wt.a,{title:n,"aria-label":n,children:Object(b.jsx)(gt.a,{onClick:t.disabled?void 0:function(){t.onPlay&&t.onPlay()},disableRipple:t.disabled,disableFocusRipple:t.disabled,children:Object(b.jsx)(Ot.a,{style:{color:t.disabled?"#cccccc":"#4cbb17"}})})}),Object(b.jsx)(wt.a,{title:i,"aria-label":i,children:Object(b.jsx)(gt.a,{onClick:t.disabled?void 0:function(){t.onStop&&t.onStop()},disableRipple:t.disabled,disableFocusRipple:t.disabled,children:Object(b.jsx)(kt.a,{style:{color:t.disabled?"#cccccc":"#ff0800"}})})})]}),Object(b.jsxs)(St.a,{container:!0,children:[Object(b.jsx)(St.a,{item:!0,xs:4}),Object(b.jsx)(St.a,{item:!0,xs:4,children:Object(b.jsx)(yt.a,{defaultValue:100,min:60,step:1,max:180,onChange:function(e,n){t.onTempoChange&&t.onTempoChange(n)},valueLabelDisplay:"auto"})}),Object(b.jsx)(St.a,{item:!0,xs:4})]})]})}var Dt=r.a.memo(Ct),Tt=n(298),Pt=n(528),Rt=n(516),At=n(518),Mt=n(514),It=n(519),Nt=n(517),Et=n(515),Ft=n(272),Lt=n.n(Ft),Bt=n(273),zt=n.n(Bt),_t=n(149),Gt=n.n(_t),Vt=n(193),Ht=n.n(Vt),Wt=n(148),Kt=n.n(Wt),Jt=n(534),Ut=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).state={currentValue:null},i}return Object(l.a)(n,[{key:"render",value:function(){var t,e=this,n=function(){e.props.onCancel&&e.props.onCancel(),e.setState({currentValue:null})},i=function(){null!==e.state.currentName?e.state.currentValue.trim().length>0?(e.props.onChange&&e.props.onChange(e.state.currentValue),e.setState({currentValue:null})):alert('You selected an invalid name "'+e.state.currentValue+'".\nMust be non-empty.'):n()};return Object(b.jsxs)(R.a,{open:this.props.open,onClose:n,"aria-labelledby":"form-dialog-title",children:[Object(b.jsx)(N.a,{id:"form-dialog-title"}),Object(b.jsxs)(M.a,{children:[Object(b.jsx)(I.a,{children:this.props.instruction}),Object(b.jsx)(Jt.a,{margin:"dense",id:"name",fullWidth:!0,value:null!==(t=this.state.currentValue)&&void 0!==t?t:this.props.value,onChange:function(t){e.setState({currentValue:t.target.value})},onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),i())},autoFocus:!0})]}),Object(b.jsxs)(A.a,{children:[Object(b.jsx)(j.a,{onClick:n,color:"primary",children:"Cancel"}),Object(b.jsx)(j.a,{onClick:i,color:"primary",children:"Confirm"})]})]})}}]),n}(r.a.Component),qt=n(37),Xt=n(268),$t=n.n(Xt),Yt=n(269),Zt=n.n(Yt),Qt=n(270),te=n.n(Qt),ee=n(271),ne=n.n(ee),ie=n(267),re=n.n(ie),ae=n(53),oe=Object(x.a)((function(t){return{root:{display:"flex"}}})),se=Object(h.a)({root:{marginLeft:0,marginRight:0}})(Tt.a),ce=Object(h.a)({root:{padding:2}})(gt.a),ue=Object(h.a)((function(t){return{root:{borderBottom:"none",textAlign:"center",paddingBottom:t.spacing(0)}}}))(Mt.a),le=Object(h.a)((function(t){return{root:{textAlign:"center"}}}))(Mt.a);function me(t){var e=r.a.useState(!1),n=Object(K.a)(e,2),i=n[0],a=n[1],o=r.a.useState(100),s=Object(K.a)(o,2),c=s[0],u=s[1],l=r.a.useState(t.muted),m=Object(K.a)(l,2),p=m[0],h=m[1],d=r.a.useRef(null),f=t.height?t.height/3:24,j={height:3*f,position:"absolute",top:-f},g=Object.assign(i?{}:{visibility:"hidden",paddingLeft:"0px"},j),v=i?{visibility:"hidden"}:{},O=Object(ae.a)();return Object(b.jsx)(re.a,{time:.5,onClickNHold:O?function(t,e){i||a(!0)}:function(t,e){i||a(!0),d&&d.current.dispatchEvent(e.nativeEvent)},onEnd:O?null:function(t){a(!1)},children:Object(b.jsxs)(ce,{disableRipple:!0,disableFocusRipple:!0,onClick:function(){h(!p),t.onMuteEvent(!p)},children:[Object(b.jsx)("div",{style:g,children:Object(b.jsx)(yt.a,{defaultValue:100,orientation:"vertical","aria-labelledby":"vertical-slider",onChange:function(e,n){O&&a(!1),function(e,n){u(n),t.onChange&&t.onChange(n)}(0,n)},ref:d})}),Object(b.jsx)("div",{style:v,children:p?Object(b.jsx)($t.a,{fontSize:"small"}):c<10?Object(b.jsx)(Zt.a,{fontSize:"small"}):c<50?Object(b.jsx)(te.a,{fontSize:"small"}):Object(b.jsx)(ne.a,{fontSize:"small"})})]})})}var pe=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this,t)).state={currentSymbol:null},i}return Object(l.a)(n,[{key:"render",value:function(){var t,e=this,n=function(t){e.setState({currentSymbol:null}),e.props.onCancel&&e.props.onCancel()},i=function(t){null!==e.state.currentSymbol&&1===e.state.currentSymbol.length?e.props.onChange&&(e.props.onChange(e.state.currentSymbol),e.setState({currentSymbol:null})):alert('You selected an invalid symbol "'+e.state.currentSymbol+'".\nSymbols must be precisely 1 character.')};return Object(b.jsxs)(R.a,{open:this.props.open,onClose:n,"aria-labelledby":"form-dialog-title",children:[Object(b.jsx)(N.a,{id:"form-dialog-title"}),Object(b.jsxs)(M.a,{children:[Object(b.jsx)(I.a,{children:"Enter notation symbol"}),Object(b.jsx)(Jt.a,{autoFocus:!0,margin:"dense",id:"name",fullWidth:!0,value:null!==(t=this.state.currentSymbol)&&void 0!==t?t:this.props.value,onChange:function(t){e.setState({currentSymbol:t.target.value})},onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),i())}})]}),Object(b.jsxs)(A.a,{children:[Object(b.jsx)(j.a,{onClick:n,color:"primary",children:"Cancel"}),Object(b.jsx)(j.a,{onClick:i,color:"primary",children:"Confirm"})]})]})}}]),n}(r.a.Component);function he(t){var e=oe(),n=r.a.useState(!1),i=Object(K.a)(n,2),a=i[0],o=i[1],s=function(e,n){return Object(b.jsx)(Mt.a,{align:"center",children:Object(b.jsx)(se,{control:Object(b.jsx)(Pt.a,{checked:t.instrumentMask[e]===n,onChange:function(i){!function(e,n,i){var r=t.instrumentIndex[e].id,a=t.instruments.findIndex((function(t){return r in t[1]})),o=n;if(a!==o){var s=t.instruments[a],c=["",{}];if(null!=s){c[0]=s[0];for(var u=0,l=Object.keys(s[1]);u<l.length;u++){var m=l[u];m!==r.toString()&&(c[1][m]=s[1][m])}}var p=[t.instruments[o][0],Object.assign({},t.instruments[o][1])];p[1][r.toString()]=null!=s?s[1][r]:"X";for(var h=[],d=0;d<t.instruments.length;++d)d===a?h.push(c):d===o?h.push(p):h.push(t.instruments[d]);t.onChange(h)}}(e,n)},name:e+","+n.toString()})})},"instrumentPanel-cell-"+n.toString()+"-"+e.toString())},c=function(e){return Object(b.jsxs)(Et.a,{children:[Object(b.jsxs)(Mt.a,{component:"th",scope:"row",children:[Object(b.jsx)(S.a,{children:t.instruments[e][0]}),Object(b.jsx)(ce,{onClick:function(n){!function(e){t.onEditRow&&t.onEditRow(e)}(e)},children:Object(b.jsx)(Ht.a,{fontSize:"small"})}),Object(b.jsx)(ce,{onClick:function(n){!function(e){t.onRemoveRow&&t.onRemoveRow(e)}(e)},children:Object(b.jsx)(Kt.a,{fontSize:"small"})})]},"instrumentPanel-row-"+e.toString()+"-name"),Object(O.a)(Array(t.instrumentMask.length).keys()).map((function(t){return s(t,e)}))]},"instrumentPanel-row-"+e.toString())};return Object(b.jsxs)(Rt.a,{className:e.table,"aria-label":"simple table",children:[Object(b.jsxs)(Nt.a,{children:[Object(b.jsxs)(Et.a,{children:[t.showAdvanced&&Object(b.jsx)(ue,{},"instrumentPanel-row-instrument"),Object(O.a)(Array(t.instrumentIndex.length).keys()).map((function(e){return Object(b.jsx)(ue,{children:Object(b.jsx)(S.a,{children:t.instrumentIndex[e].name})},"instrumentPanel-row-header-cell-"+e.toString())}))]},"instrumentPanel-row-header"),Object(b.jsxs)(Et.a,{children:[t.showAdvanced&&Object(b.jsx)(le,{children:Object(b.jsx)(gt.a,{"aria-label":"Show Instrument Matcher",size:"small",onClick:function(){return o(!a)},children:a?Object(b.jsx)(Lt.a,{}):Object(b.jsx)(zt.a,{})})},"instrumentPanel-row-instrument"),Object(O.a)(Array(t.instrumentIndex.length).keys()).map((function(e){return Object(b.jsx)(le,{children:Object(b.jsxs)(St.a,{container:!0,children:[Object(b.jsx)(St.a,{item:!0,xs:6,children:Object(b.jsx)(ce,{onClick:function(n){!function(e){t.onEditColumn&&t.onEditColumn(e)}(e)},children:Object(b.jsx)(Ht.a,{fontSize:"small"})})}),Object(b.jsx)(St.a,{item:!0,xs:6,children:Object(b.jsx)(me,{muted:t.instrumentIndex[e].muted,onChange:function(n){t.onVolumeEvent({instrument:e,volume:n/100})},onMuteEvent:function(n){t.onVolumeEvent({instrument:e,muted:n})}})})]})},"instrumentPanel-row-controls-cell-"+e.toString())}))]},"instrumentPanel-row-controls")]}),Object(b.jsxs)(At.a,{children:[a&&t.showAdvanced&&Object(O.a)(Array(t.instruments.length).keys()).map((function(t){return c(t)})),a&&t.showAdvanced&&Object(b.jsx)(Et.a,{children:Object(b.jsx)(Mt.a,{component:"th",scope:"row",children:Object(b.jsx)(gt.a,{onClick:function(e){t.onAddRow&&t.onAddRow()},"aria-label":"add",children:Object(b.jsx)(Gt.a,{})})},"instrumentPanel-row-edit-cell")},"instrumentPanel-row-edit")]})]})}function de(t){var e,n=Object(qt.a)(),i=r.a.useState(null),a=Object(K.a)(i,2),o=a[0],s=a[1],c=r.a.useState(null),u=Object(K.a)(c,2),l=u[0],m=u[1],p=function(e){if(null!==e){var n=t.instrumentIndex[o].id,i=t.instruments.findIndex((function(t){return n in t[1]})),r=Array.from(t.instruments);r[i][1][n]=e,t.onChange(r)}s(null)};return Object(b.jsxs)("div",{style:{paddingBottom:n.spacing(1)},children:[Object(b.jsx)(Ut,{open:null!==l,onCancel:function(){m(null)},onChange:function(e){!function(e){if(l===t.instruments.length){var n=[e,{}],i=Array.from(t.instruments);i.push(n),t.onChange(i)}else{var r=Array.from(t.instruments);r[l][0]=e,t.onChange(r)}m(null)}(e)},value:null!==l?(e=l,e<t.instruments.length?t.instruments[e][0]:""):"",instruction:"Enter instrument name"}),Object(b.jsx)(pe,{open:null!==o,onCancel:function(){p(null)},onChange:function(t){p(t)},value:null!==o?function(e){var n=t.instrumentIndex[o].id,i=t.instruments.findIndex((function(t){return n in t[1]}));return t.instruments[i][1][n]}():""}),Object(b.jsx)(It.a,{component:y.a,style:{border:"2px solid rgba(255, 255, 255, 0.5)",outline:"none",borderRadius:"8px"},children:Object(b.jsx)(he,{instrumentIndex:t.instrumentIndex,instrumentMask:t.instrumentMask,instruments:t.instruments,onEditColumn:function(t){s(t)},onEditRow:function(t){m(t)},onAddRow:function(){m(t.instruments.length)},onRemoveRow:function(e){!function(e){var n=t.instruments.slice(0,e).concat(t.instruments.slice(e+1));t.onChange(n)}(e)},onVolumeEvent:t.onVolumeEvent,onChange:t.onChange,showAdvanced:t.showAdvanced})})]})}var fe=r.a.memo(de),je=n(526),be=n(527),ge=n(521),ve=n(529),Oe=n(100),xe=n(283),ke=function(){function t(){Object(u.a)(this,t)}return Object(l.a)(t,null,[{key:"createWebContext",value:function(){return new(window.AudioContext||window.webkitAudioContext||Object)}},{key:"determineMinResolution",value:function(t,e){for(var n=48,i=function(){var e=Object(K.a)(a[r],2),i=e[0],o=e[1];t.filter((function(t){return t.id.toString()===i})).length>0&&!o.empty()&&(n=Math.min(n,o.resolution))},r=0,a=Object.entries(e);r<a.length;r++)i();return n}},{key:"determineTrackLength",value:function(t,e){for(var n=48,i=function(){var e=Object(K.a)(a[r],2),i=e[0],o=e[1];t.filter((function(t){return t.id.toString()===i})).length>0&&!o.empty()&&(n=Math.max(n,o.length()))},r=0,a=Object.entries(e);r<a.length;r++)i();return n}},{key:"peakAmplitude",value:function(t){for(var e=0,n=0;n<t.numberOfChannels;n++)for(var i=t.getChannelData(n),r=0;r<i.length;++r)e=Math.max(Math.abs(i[r]),e);return e}},{key:"normalizeAudioBuffer",value:function(e){var n=t.peakAmplitude(e);if(n>1)for(var i=0;i<e.numberOfChannels;i++)for(var r=e.getChannelData(i),a=0;a<r.length;++a)r[a]=r[a]/n;return e}},{key:"createMasterTrack",value:function(e,n,i,r,a){for(var o=t.determineTrackLength(i,n),s=44100*(o*(60/a*1e3/48))/1e3,c=Math.floor(s),u=Math.floor(c/o),l=e.createBuffer(2,c,44100),m=0;m<l.numberOfChannels;m++)for(var p=l.getChannelData(m),h=function(){var t=Object(K.a)(f[d],2),e=t[0],n=t[1],a=i.filter((function(t){return t.id.toString()===e}));if(a.length>0&&a[0].id in r&&!n.empty()){var o,s=r[a[0].id],c=2===s.numberOfChannels?s.getChannelData(m):s.getChannelData(0),l=n.toPoints(),h=Object(J.a)(l);try{for(h.s();!(o=h.n()).done;)for(var j=o.value*u,b=0;b<s.length;++b)p[j+b]=p[j+b]+c[b]}catch(g){h.e(g)}finally{h.f()}}},d=0,f=Object.entries(n);d<f.length;d++)h();return t.normalizeAudioBuffer(l)}},{key:"createAudioSource",value:function(t,e,n){var i=t.createBufferSource();return i.buffer=e,i.loop=!0,null!==n&&(i.playbackRate.value=n/100),i.connect(t.destination),i}},{key:"createOneShotAudioSource",value:function(t,e,n){var i=t.createBufferSource();return i.buffer=e,i.loop=!1,null!==n&&(i.playbackRate.value=n/100),i.connect(t.destination),i}}]),t}(),ye=n(26),Se=.05,we=function(t){Se=t},Ce=["circAfrique v4","DeathMetal","The Black Pearl 1.0","GMRockKit","TR808EmulationKit","Millo_MultiLayered3","BFS drumming"],De=function(t){return Math.pow(t,2.5)},Te=function(){function t(e,n,i,r,a,o){if(Object(u.a)(this,t),o){var s=n.map((function(t){return t.name})),c=new Set(s);s.length!==c.size&&o("Warning: tabit currently only supports inputs where all the pattern names are unique. Good luck!")}if(a&&ye.f.latencyHint!==a){var l=new ye.a({latencyHint:a});ye.i(l)}we("playback"===a?.2:.05),this.latencyHint=a,this.samples={},this.currentPattern=null,this.gain=new ye.b,this.gain.toDestination(),this.onPatternTimeChange=r,ye.h().bpm.value=i,ye.h().loop=!0,this.sampleCount=0,this.expectedSampleCount=0,this.patternDetails={};var m,p=[],h=Object(J.a)(n);try{for(h.s();!(m=h.n()).done;){var d=m.value;this.patternDetails[d.name]={resolution:ke.determineMinResolution(e,d.instrumentTracks),length:ke.determineTrackLength(e,d.instrumentTracks),name:d.name,tracks:d.instrumentTracks,pattern:d},this.populateSamples(e,d.instrumentTracks,p)}}catch(k){h.e(k)}finally{h.f()}if(this.currentPatternName=null,this.instrumentIndex=e,p.length>0&&o){for(var f=function(t){var e,n=[],i=Object(J.a)(t);try{for(i.s();!(e=i.n()).done;){var r,a=Object(K.a)(e.value,2),o=a[0],s=a[1],c=!0,u=Object(J.a)(n);try{for(u.s();!(r=u.n()).done;){var l=Object(K.a)(r.value,2),m=l[0],p=l[1];if(o===m&&s===p){c=!1;break}}}catch(k){u.e(k)}finally{u.f()}c&&n.push([o,s])}}catch(k){i.e(k)}finally{i.f()}return n.sort(),n}(p),j=f.length>1,b=j?"s":"",g="Failed to load sample"+b+" for instrument"+b+": "+(j?"{":""),v=0;v<f.length;++v){var O=Object(K.a)(f[v],2),x=O[0];g+=O[1],""!==x&&(g+=" ("+x+")"),v!==f.length-1?g+=", ":g+=(j?"}":"")+"."}o(g+="\ntabit's supported drumkits are "+Ce.join(", ")+".")}}return Object(l.a)(t,[{key:"teardown",value:function(){this.stop(),ye.h().cancel()}},{key:"samplesReady",value:function(){return this.sampleCount===this.expectedSampleCount}},{key:"populateSamples",value:function(t,e,n){var i=this;this.sampleCount=0;for(var r=function(){var e=Object(K.a)(o[a],1)[0],r=t.filter((function(t){return t.id.toString()===e}));if(r.length>0){var s=r[0],c=De(Math.min(Math.max(0,s.volume),1));if(s.id in i.samples)return"continue";if("drumkit"in s&&"filename"in s&&Ce.includes(s.drumkit)){var u=s.filename.replace(".flac",".wav"),l=new ye.c("/tabit/wav/"+s.drumkit+"/"+u,(function(){i.sampleCount++}));l.mute=s.muted,l.name=s.name;var m=new ye.b(c,"normalRange");l.connect(m),m.connect(i.gain),i.samples[s.id]={player:l,gain:m},i.expectedSampleCount++}else if("drumkit"in s){var p=function(t,e){var n=e.toLowerCase();return n.includes("kick")?"The Black Pearl 1.0/PearlKick-Hard.wav":n.includes("stick")?"DeathMetal/16297_ltibbits_sticks_low_pitch.wav":n.includes("tom")?"Millo_MultiLayered3/ft_01.wav":n.includes("clap")?"TR808EmulationKit/808_Clap.wav":n.includes("snare")?"GMRockKit/Snare-Soft.wav":n.includes("cowbell")?"GMRockKit/Cowbell-Softest.wav":null}(s.drumkit,s.name);if(null!==p){var h=new ye.c("/tabit/wav/"+p,(function(){i.sampleCount++}));h.mute=s.muted,h.name=s.name;var d=new ye.b(c,"normalRange");h.connect(d),d.connect(i.gain),i.samples[s.id]={player:h,gain:d},i.expectedSampleCount++}else n.push([s.drumkit,s.name])}else n.push(["",s.name])}},a=0,o=Object.entries(e);a<o.length;a++)r()}},{key:"createSequenceForPattern",value:function(t,e){var n=this.patternDetails[e.name].resolution,i=this.patternDetails[e.name].length,r=function(t,e){var n=e.samplesReady();return function(i,r){if(n||(n=e.samplesReady())){var a=r%(t.length/t.resolution);window.trace&&window.trace("playing sequence callback at time "+String(i)+" index "+String(r));for(var o=0,s=Object.entries(t.tracks);o<s.length;o++){var c=Object(K.a)(s[o],2),u=c[0];if(c[1].rep[a]){var l=e.samples[u];void 0!==l&&(l.player.stop(i+Se),l.player.start(i+Se))}}e.onPatternTimeChange&&ye.g().schedule((function(){if("started"===ye.h().state){var n=a*t.resolution%t.length;e.onPatternTimeChange&&e.onPatternTimeChange(n)}}),i+Se)}}}(this.patternDetails[e.name],this),a=new ye.d(r,Object(O.a)(Array(i/n).keys()),ye.e("4n")*(n/48));return a._part.mute=!0,a.start(0),a}},{key:"createSequences",value:function(t,e){var n,i={},r=Object(J.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;i[a.name]=this.createSequenceForPattern(t,a)}}catch(o){r.e(o)}finally{r.f()}return i}},{key:"setActivePattern",value:function(t){var e=this;if(t!==this.currentPatternName){var n=null!==this.currentPatternName?this.currentPatternName:null,i=this.patternDetails[t].length,r=null!==n?this.patternDetails[n]:null,a=ye.h().loopEnd-(ye.h().toSeconds(ye.h().position)-Se),o="playback"===this.latencyHint,s=!o&&null!==n&&"started"===ye.h().state&&a>0&&a<ye.h().toSeconds(ye.e("8n")),c=this.createSequenceForPattern(this.instrumentIndex,this.patternDetails[t].pattern),u=function(a){null!==n&&(e.sequence._part.mute=!0),null!==n&&r===i||ye.h().setLoopPoints(0,ye.e("4n")*(i/48)),e.sequence=c,e.sequence._part.mute=!1,e.currentPatternName=t},l="started"===ye.h().state;o&&l&&this.stop(),s?ye.h().scheduleOnce(u,ye.e("0")):u(),o&&l&&this.play()}}},{key:"play",value:function(){ye.j().then((function(){ye.h().start()}))}},{key:"stop",value:function(){var t=this;"started"===ye.h().state&&(ye.h().stop(),this.onPatternTimeChange&&ye.g().schedule((function(){t.onPatternTimeChange(null)}),ye.h().now()))}},{key:"setAnimateCallback",value:function(t){this.onPatternTimeChange&&this.onPatternTimeChange(null),this.onPatternTimeChange=t}},{key:"setMutedForInstrument",value:function(t,e){this.samples[t].player.mute=e}},{key:"setVolumeForInstrument",value:function(t,e){this.samples[t].gain.set({gain:De(e)})}},{key:"setTempo",value:function(t){ye.h().bpm.value=t}}]),t}(),Pe=n(284),Re=n(285),Ae=n.n(Re),Me=n(286),Ie=n.n(Me);function Ne(t){return Object(b.jsx)(R.a,{open:t.open,onClose:t.onClose,"aria-labelledby":"sharing-dialog","aria-describedby":"sharing-dialog",children:Object(b.jsxs)(M.a,{children:[Object(b.jsx)(I.a,{children:"Your song is available at"}),Object(b.jsxs)(I.a,{children:[t.url,Object(b.jsx)(gt.a,{onClick:function(e){Ae()(t.url)},children:Object(b.jsx)(Ie.a,{})})]}),Object(b.jsx)(A.a,{children:Object(b.jsx)(j.a,{onClick:t.onClose,children:"Close"})})]})})}var Ee=r.a.memo(Ne),Fe=n(520),Le=n(287),Be=n.n(Le),ze=Object(x.a)((function(t){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:t.spacing(.5,0)}}}));function _e(t){var e=t.items,n=t.selectedItems,i=t.onChange,a=ze(),o=r.a.useState(e.map((function(t){return!1}))),s=Object(K.a)(o,2),c=s[0],u=s[1],l=function(t,e){return Object(b.jsx)(y.a,{className:a.paper,children:Object(b.jsxs)(k.a,{dense:!0,component:"div",role:"list",children:[t.map((function(t){var n="transfer-list-item-".concat(t.value,"-label");return Object(b.jsxs)(w.a,{role:"listitem",button:!0,onClick:function(){!function(t){var e=Object(O.a)(c.keys()).map((function(e){return e===t?!c[e]:c[e]}));u(e)}(t.value)},children:[e&&Object(b.jsx)(Fe.a,{children:Object(b.jsx)(Pt.a,{checked:c[t.value],tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":n}})}),Object(b.jsx)(C.a,{id:n,primary:t.label})]},t.value)})),Object(b.jsx)(w.a,{})]})})};return Object(b.jsxs)(St.a,{container:!0,spacing:2,justify:"center",alignItems:"center",className:a.root,children:[Object(b.jsx)(St.a,{item:!0,children:l(e,!0)}),Object(b.jsx)(St.a,{item:!0,children:Object(b.jsxs)(St.a,{container:!0,direction:"column",alignItems:"center",children:[Object(b.jsx)(gt.a,{size:"small",className:a.button,onClick:function(){var t=n.concat(e.filter((function(t){return c[t.value]})));i&&i(t),u(e.map((function(t){return!1})))},"aria-label":"move selected right",children:">"}),Object(b.jsx)(gt.a,{variant:"outlined",size:"small",className:a.button,onClick:function(){i&&i([]),u(e.map((function(t){return!1})))},"aria-label":"reset",children:Object(b.jsx)(Be.a,{})})]})}),Object(b.jsx)(St.a,{item:!0,children:l(n,!1)})]})}var Ge=function(t){var e=r.a.useState(null),n=Object(K.a)(e,2),i=n[0],a=n[1],o=r.a.useState([]),s=Object(K.a)(o,2),c=s[0],u=s[1],l=function(e){e&&c.length&&i&&t.onChange({name:i,recipe:c}),u([]),a(null),t.onClose()},m=Object(O.a)(t.patterns.keys()).map((function(e){return{value:e,label:t.patterns[e]}})),p=i&&-1!==t.patterns.indexOf(i);return Object(b.jsx)(R.a,{open:t.open,onClose:t.onClose,"aria-labelledby":"pattern-edit-dialog","aria-describedby":"pattern-edit-dialog",children:Object(b.jsxs)(M.a,{children:[Object(b.jsx)(I.a,{children:"Combine Patterns"}),Object(b.jsx)(_e,{items:m,selectedItems:c,onChange:u}),Object(b.jsx)(je.a,{style:{display:"flex",flexDirection:"column"},children:Object(b.jsx)(Jt.a,{error:p,label:"Pattern Name",helperText:p?"Pattern names must be unique.":void 0,variant:"outlined",onChange:function(t){a(t.target.value)},style:{alignSelf:"flex-end"}})}),Object(b.jsxs)(A.a,{children:[Object(b.jsx)(j.a,{onClick:function(){l(!0)},disabled:0===c.length||!i||p,children:"Confirm"}),Object(b.jsx)(j.a,{onClick:function(){l(!1)},children:"Close"})]})]})})},Ve=n(300),He=n(288),We=Object(He.a)((function(t,e){var n=Object.assign({},t);return e&&(n=Object.assign(n,e)),n})),Ke=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).state={selectedPattern:0,patternSettings:t.props.songData.patternSettings,formatSettings:t.props.songData.formatSettings,songData:{instruments:t.props.songData.instruments,instrumentIndex:t.props.songData.instrumentIndex,instrumentMask:t.props.songData.instrumentMask,patterns:t.props.songData.patterns,title:t.props.songData.title},settingsOpen:!1,patternsOpen:!0,sharingDialogOpen:!1,patternCreateDialogOpen:!1,patternTime:null,errorAlert:null,locked:!0,animating:!0},t.removePattern=function(e){if(t.audio&&t.audio.stop(),1===t.state.songData.patterns.length)return t.setError("Can't delete the last pattern");var n=Object(O.a)(Array(t.state.songData.patterns.length).keys()).filter((function(t){return t!==e})),i=n.map((function(e){return t.state.songData.patterns[e]})),r=n.map((function(e){return t.state.patternSettings[e]})),a=Object.assign(Object.assign({},t.state.songData),{patterns:i}),o=e<=t.state.selectedPattern?t.state.selectedPattern-1:t.state.selectedPattern,s=Math.min(Math.max(0,o),n.length-1);t.setState({songData:a,patternSettings:r,selectedPattern:s},(function(){t.createController()}))},t.addCombinedPattern=function(e,n){t.audio&&t.audio.stop();for(var i=rt.a.clonePattern(e,t.state.songData.patterns[n[0].value]),r=1;r<n.length;++r)i=rt.a.combinePatterns(e,i,t.state.songData.patterns[n[r].value]);var a=rt.a.guessPerPatternSettings(i.instrumentTracks),o=Object.assign(Object.assign({},t.state.songData),{patterns:t.state.songData.patterns.concat(i)});t.setState({songData:o,patternSettings:t.state.patternSettings.concat(a)},(function(){t.createController()}))},t.changeInstruments=function(e){var n=Object.assign({},t.state.songData);n.instruments=e,n.instrumentMask=tt(t.state.songData.instrumentIndex,e),t.setState({songData:n})},t.sendVolumeEvent=function(e){if("volume"in e){var n=t.state.songData.instrumentIndex[e.instrument].id;t.audio&&t.audio.setVolumeForInstrument(n,e.volume)}else if("muted"in e){var i=t.state.songData.instrumentIndex[e.instrument].id;t.audio&&t.audio.setMutedForInstrument(i,e.muted)}},t.handleSettingsChange=function(e){if("animate"!==e.key)if(e.local){t.setState((function(t){return{patternSettings:t.patternSettings.map((function(n,i){return i!==t.selectedPattern?n:Object.assign({},t.patternSettings[t.selectedPattern],Object(ct.a)({},e.key,e.value))}))}}))}else{var n=Object.assign({},t.state.formatSettings,Object(ct.a)({},e.key,e.value));t.setState({formatSettings:n})}else!0===e.value?t.setState({animating:!0},(function(){t.audio&&t.audio.setAnimateCallback(t.createAnimateCallback())})):t.setState({animating:!1},(function(){t.audio&&t.audio.setAnimateCallback(null)}))},t.handlePatternsToggle=function(e){t.setState({patternsOpen:!t.state.patternsOpen})},t.handleSettingsToggle=function(e){t.setState({settingsOpen:!t.state.settingsOpen})},t.selectPattern=function(e){t.audio&&t.audio.setActivePattern(t.state.songData.patterns[e].name),t.setState({selectedPattern:e})},t.onShare=function(){F.e(t.getExportState()).then((function(e){var n=window.origin+"/tabit/song/"+e;t.setState({permanentUrl:n,sharingDialogOpen:!0})})).catch((function(t){alert("Couldn't contact external server at this time.")}))},t.onDownload=function(){F.b(t.getExportState())},t.closePatternCreateDialog=function(){t.setState({patternCreateDialogOpen:!1})},t.openPatternCreateDialog=function(){t.setState({patternCreateDialogOpen:!0})},t.onSave=function(){F.f(t.getExportState())},t.onHideView=function(){t.onStop()},t.handleSettingsToggle=function(e){t.setState({settingsOpen:!t.state.settingsOpen})},t.handlePatternsToggle=function(e){t.setState({patternsOpen:!t.state.patternsOpen})},t.closeSharingDialog=function(){t.setState({sharingDialogOpen:!1})},t.onPlay=function(){t.audio&&t.audio.play()},t.onStop=function(){t.audio&&t.audio.stop(),t.setState({patternTime:null})},t.onSetTempo=function(e){t.audio&&t.audio.setTempo(e)},t.setError=function(e){t.setState({errorAlert:e})},t.onToggleLocked=function(){t.setState((function(e){var n=!e.locked;return!n&&t.audio&&t.audio.stop(),{locked:n,patternsOpen:e.patternsOpen||!n}}))},t.onToggleCompact=function(){t.setState((function(e){var n=!t.state.formatSettings.compactDisplay;return{formatSettings:Object(d.a)(Object(d.a)({},t.state.formatSettings),{},{compactDisplay:n})}}))},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.createController(),window.addEventListener("beforeunload",this.onSave),Object(ae.a)()&&window.addEventListener("visibilitychange",this.onHideView)}},{key:"createAnimateCallback",value:function(){var t=this;return function(e){window.trace&&window.trace("animate step "+String(e));var n=null===t.state.patternTime!==(null===e),i=t.state.patternSettings[t.state.selectedPattern].beatResolution,r=Math.floor(t.state.patternTime/i),a=Math.floor(e/i);(n||r!==a)&&(window.trace&&window.trace("setting pattern time (currentBeat, nextBeat, state.patternTime, time) ("+String(r)+", "+String(a)+","+String(t.state.patternTime)+","+String(e)+")"),t.setState({patternTime:e}))}}},{key:"createController",value:function(){this.audio&&this.audio.teardown();var t=Object(ae.a)()?"playback":null,e=this.createAnimateCallback();this.audio=new Te(this.state.songData.instrumentIndex,this.state.songData.patterns,100,e,t,this.setError),this.audio.setActivePattern(this.state.songData.patterns[this.state.selectedPattern].name)}},{key:"componentWillUnmount",value:function(){this.onSave(),window.removeEventListener("beforeunload",this.onSave),Object(ae.a)()&&window.removeEventListener("visibilitychange",this.onHideView),this.audio&&(this.audio.teardown(),delete this.audio)}},{key:"getExportState",value:function(){return{instruments:this.state.songData.instruments,instrumentIndex:this.state.songData.instrumentIndex,patterns:this.state.songData.patterns,songName:this.state.songData.title,formatSettings:this.state.formatSettings,patternSettings:this.state.patternSettings,version:"1.1.0"}}},{key:"render",value:function(){var t=this,e=this.state.songData.patterns[this.state.selectedPattern],n=this.state.songData&&this.state.patternSettings?this.state.patternSettings[this.state.selectedPattern]:null,i=We(this.state.formatSettings,n),r=Object(ae.a)()?12:8;return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(Ve.a,{variant:"dense"}),Object(b.jsx)(Oe.a,{title:this.state.songData.title,settingsToggle:this.handleSettingsToggle,patternsToggle:this.handlePatternsToggle,onShare:this.onShare,locked:this.state.locked,onLockUnlock:this.onToggleLocked,compact:this.state.formatSettings.compactDisplay,onToggleCompact:this.onToggleCompact}),this.state.errorAlert&&Object(b.jsx)(ve.a,{severity:"error",open:!0,autoHideDuration:5e3,onClose:function(){t.setState({errorAlert:null})},children:Object(b.jsxs)(be.a,{severity:"error",onClose:function(){t.setState({errorAlert:null})},children:[Object(b.jsx)(ge.a,{children:"Error"}),Object(b.jsx)(je.a,{children:this.state.errorAlert.split("\n").map((function(t){return Object(b.jsx)(je.a,{children:t})}))})]})}),Object(b.jsx)("div",{style:{display:"flex",overflowX:"auto",flexDirection:"column",justifyContent:"safe center",width:"100%",maxWidth:"100%"},children:Object(b.jsx)(bt,{instruments:this.state.songData.instruments,tracks:e.instrumentTracks,config:i,patternTime:this.state.patternTime})}),Object(b.jsx)("div",{style:{display:"flex",flexGrow:1}}),Object(b.jsx)(Dt,{onPlay:this.onPlay,onStop:this.onStop,onTempoChange:this.onSetTempo,disabled:!this.state.locked}),Object(b.jsx)("div",{style:{display:"flex",overflowX:"auto",flexDirection:"column",justifyContent:"safe center",width:"100%",maxWidth:"100%"},children:Object(b.jsxs)(St.a,{container:!0,children:[r<12?Object(b.jsx)(St.a,{item:!0,xs:(12-r)/2}):null,Object(b.jsx)(St.a,{item:!0,xs:r,children:Object(b.jsx)(fe,{instruments:this.state.songData.instruments,instrumentIndex:this.state.songData.instrumentIndex,instrumentMask:this.state.songData.instrumentMask,onChange:this.changeInstruments,onVolumeEvent:this.sendVolumeEvent,showAdvanced:!this.state.locked})}),r<12?Object(b.jsx)(St.a,{item:!0,xs:(12-r)/2}):null]})}),Object(b.jsx)(xe.a,{open:this.state.patternsOpen,onOpen:this.handlePatternsToggle,onClose:this.handlePatternsToggle,patterns:this.state.songData.patterns,selectPattern:this.selectPattern,onRemove:this.state.locked?void 0:this.removePattern,onAdd:this.state.locked?void 0:this.openPatternCreateDialog}),Object(b.jsx)(Pe.a,{open:this.state.settingsOpen,onOpen:this.handleSettingsToggle,onClose:this.handleSettingsToggle,anchor:"right",pattern:e,settings:i,onChange:this.handleSettingsChange,onSave:this.onDownload,animating:this.state.animating}),Object(b.jsx)(Ee,{open:this.state.sharingDialogOpen,onClose:this.closeSharingDialog,url:this.state.permanentUrl}),Object(b.jsx)(Ge,{open:this.state.patternCreateDialogOpen,onClose:this.closePatternCreateDialog,onChange:function(e){t.addCombinedPattern(e.name,e.recipe)},patterns:Object(O.a)(this.state.songData.patterns.keys()).map((function(e){return t.state.songData.patterns[e].name}))})]})}}]),n}(r.a.Component),Je=Ke,Ue=n(143),qe=n.n(Ue),Xe=n(9),$e=n.n(Xe),Ye=n(19),Ze=n(289),Qe=n.n(Ze),tn=n(144);function en(t,e){var n=Array.from(t.notes,(function(t){return t.position}));return Object(tn.a)(n,e)}function nn(t){var e=t.song.instrumentList[0].instrument,n=Array.from(e,(function(t){var e=t.instrumentComponent[0],n={id:parseInt(t.id),name:t.name[0],volume:parseFloat(t.volume),muted:"true"===t.isMuted[0],gain:parseFloat(t.gain),drumkit:t.drumkit[0]};return"layer"in e&&(n.filename=e.layer[0].filename[0]),n})),i=t.song.patternList[0].pattern,r=Array.from(i,(function(t){var e=t.noteList[0].note,n=parseInt(t.size),i=[];return e&&(i=(i=Array.from(e,(function(t){return{position:parseInt(t.position),instrument:parseInt(t.instrument)}}))).filter((function(t){return t.position<n}))),{size:n,name:t.name[0],notes:i}})),a=Array.from(r,(function(t){var e,i=en(t,t.size),r={},a=Object(J.a)(n);try{var o=function(){var n=e.value,a=t.notes.filter((function(t){return t.instrument===n.id})),o=Array.from(a,(function(t){return t.position}));r[n.id.toString()]=nt.a.fromPositions(o,t.size,i)};for(a.s();!(e=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}return t.resolution=i,t.instrumentTracks=r,t}));if(t.song.virtualPatternList){var o=t.song.virtualPatternList[0].pattern;if(o){for(var s={},c=0,u=Array.from(o);c<u.length;c++){var l=u[c],m=l.name[0],p=Array.from(l.virtual);s[m]=new Set(p)}for(var h=0;h<20;++h){for(var d={},f=!1,j=0,b=Object.entries(s);j<b.length;j++){var g,v=Object(K.a)(b[j],2),x=v[0],k=v[1],y=new Set(k),S=Object(J.a)(y);try{for(S.s();!(g=S.n()).done;){var w=g.value;w in s&&(y=new Set([].concat(Object(O.a)(y),Object(O.a)(s[w]))))}}catch(P){S.e(P)}finally{S.f()}f=f||y.size!==k.size,d[x]=y}if(!f)break;if(20===h)throw new Error("Reached max virtual_pattern recursion depth.");s=d}for(var C=function(){var t,e=Object(K.a)(T[D],2),n=e[0],i=e[1],r=a.find((function(t){return t.name===n})),o=Object(J.a)(i);try{var s=function(){for(var e=t.value,n=a.find((function(t){return t.name===e})),i=0,o=Object.entries(n.instrumentTracks);i<o.length;i++){var s=Object(K.a)(o[i],2),c=s[0],u=s[1];if(c in r.instrumentTracks){var l=r.instrumentTracks[c].aggregate(u);l.rep.length=r.size/l.resolution,r.instrumentTracks[c]=l}else{var m=u.format(r.resolution);m.length=r.size/r.resolution,r.instrumentTracks[c]=m}}};for(o.s();!(t=o.n()).done;)s()}catch(P){o.e(P)}finally{o.f()}var c=en(r,r.size);r.resolution=c;for(var u=0,l=Object.entries(r.instrumentTracks);u<l.length;u++){var m=Object(K.a)(l[u],2),p=m[0],h=m[1];r[p]=h.format(c)}},D=0,T=Object.entries(s);D<T.length;D++)C()}}return{instruments:n,patterns:a}}function rn(){return(rn=Object(Ye.a)($e.a.mark((function t(e){var n;return $e.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Qe.a.Parser,t.abrupt("return",n.parseStringPromise(e).then(nn));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var an={parseHydrogenPromise:function(t){return rn.apply(this,arguments)}},on=an;function sn(t){return Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("div",{children:[Object(b.jsx)(W.a,{color:"secondary"}),Object(b.jsx)(S.a,{children:" Loading song... "})]})})}var cn=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).state={songData:null},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;st.LoadExample().then((function(e){t.setState({songData:e})})).catch((function(e){t.setState({error:"Failed to load example data. This likely represents a bug - please raise an issue in github!"})}))}},{key:"render",value:function(){return this.state.error?Object(b.jsx)(s.a,{to:"/",state:{error:this.state.error}}):this.state.songData?Object(b.jsx)(Je,{songData:this.state.songData},this.state.songData):Object(b.jsx)(sn,{})}}]),n}(r.a.Component);function un(t){return null===t||void 0===t?null:t.includes(".")?t.split(".").slice(0,-1).join("."):t}var ln=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).state={songData:null},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=function(e){t.setState({songData:e})},n=function(e){t.setState({error:"Failed to load "+t.props.filename+". If you're sure this is a Hydrogen file, please consider raising an issue in github!"})};this.props.filename&&(this.props.filename.includes("h2song")?on.parseHydrogenPromise(this.props.content).then((function(e){return st.LoadJSON(e,un(t.props.filename),t.props.filename,!0)})).then(e).catch(n):Promise.resolve(this.props.content).then((function(t){return"string"===typeof t?JSON.parse(t):t})).then((function(e){return st.LoadJSON(e,e.songName?e.songName:un(t.props.filename),t.props.filename,!1)})).then(e).catch(n))}},{key:"render",value:function(){return this.props.filename?this.state.error?Object(b.jsx)(s.a,{to:"/",state:{error:this.state.error}}):this.state.songData?Object(b.jsx)(Je,{songData:this.state.songData},this.state.songData):Object(b.jsx)(sn,{}):Object(b.jsx)(s.a,{to:"/"})}}]),n}(r.a.Component),mn=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).state={songData:null},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;F.c(this.props.songID).then((function(t){return st.LoadJSON(t,t.songName,t.loadedFile,!1)})).then((function(e){t.setState({songData:e})})).catch((function(e){t.setState({error:"Failed to load song "+t.props.songID+" from database. This could represent a corrupted entry/a bug in our software. Please consider raising an issue in github!"})}))}},{key:"render",value:function(){return this.state.error?Object(b.jsx)(s.a,{to:"/",state:{error:this.state.error}}):this.state.songData?Object(b.jsx)(Je,{songData:this.state.songData},this.state.songData):Object(b.jsx)(sn,{})}}]),n}(r.a.Component),pn=function(t){Object(m.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).state={songData:null},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=function(e){t.setState({error:"Failed to load recently viewed song "+t.props.name+". "})},n=F.d().filter((function(e){return e.id===t.props.songID}));n.length<1&&e(),Promise.resolve(n[0]).then((function(e){if(qe()(e.content)!==t.props.songID)throw new Error("Hash did not match");return Object(F.a)(e.content)})).then((function(t){return st.LoadJSON(t,t.songName,t.songName,!1)})).then((function(e){t.setState({songData:e})})).catch(e)}},{key:"render",value:function(){return this.state.error?Object(b.jsx)(s.a,{to:"/",state:{error:this.state.error}}):this.state.songData?Object(b.jsx)(Je,{songData:this.state.songData},this.state.songData):Object(b.jsx)(sn,{})}}]),n}(r.a.Component),hn=function(t){var e=Object(s.f)(),n=Object(s.g)(),i=e.state||{};return Object(b.jsx)(B,{navigate:n,location:e,error:i.error})},dn=function(t){var e=Object(s.f)();return Object(b.jsx)(cn,{location:e})},fn=function(t){var e=Object(s.h)().songID,n=Object(s.f)();return Object(b.jsx)(mn,{location:n,songID:e})},jn=function(t){var e=Object(s.f)();return Object(b.jsx)(ln,{location:e,filename:e.state.filename,content:e.state.content})},bn=function(t){var e=Object(s.h)().songID,n=Object(s.f)(),i=n.state||{};return Object(b.jsx)(pn,{location:n,songID:e,name:i.songName})};function gn(t){var e=Object(H.a)("(prefers-color-scheme: dark)"),n=Object(_.a)(r.a.useMemo((function(){return Object(G.a)({palette:{type:e?"dark":"light",primary:{main:"#d7ccc8"},secondary:{main:"#00acc1"}}})}),[e]));return Object(b.jsx)(c.a,{basename:"/tabit",children:Object(b.jsxs)(V.a,{theme:n,children:[Object(b.jsx)(z.a,{}),Object(b.jsxs)(s.d,{children:[Object(b.jsx)(s.b,{exact:!0,path:"/",element:Object(b.jsx)(hn,{})}),Object(b.jsx)(s.b,{exact:!0,path:"/example",element:Object(b.jsx)(dn,{})}),Object(b.jsx)(s.b,{path:"/song/:songID",element:Object(b.jsx)(fn,{})}),Object(b.jsx)(s.b,{path:"/import",element:Object(b.jsx)(jn,{})}),Object(b.jsx)(s.b,{path:"/recent/:songID",element:Object(b.jsx)(bn,{})})]})]})})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(gn,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},53:function(t,e,n){"use strict";function i(){var t=navigator.userAgent||navigator.vendor||window.opera;return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((function(e){return t.match(e)}))}n.d(e,"a",(function(){return i}))},57:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return p})),n.d(e,"e",(function(){return m})),n.d(e,"b",(function(){return f})),n.d(e,"d",(function(){return h})),n.d(e,"f",(function(){return d}));var i=n(143),r=n.n(i),a=n(192),o=n.n(a),s=n(262),c=function(t){var e=JSON.stringify(t);return{state:o.a.deflateSync(e).toString("base64")}},u=function(e){var n=new t(e.state,"base64"),i=o.a.inflateSync(n);return JSON.parse(i)},l="https://api.jsonbin.io/b",m=function(t,e){var n=(e||t.songName).slice(0,64),i=c(t),r={method:"POST",headers:{"Content-Type":"application/json","secret-key":"$2b$10$Z2eAUT2PfRKn5RB55/Y30ujW8aUB1CCgRuUua3Jo9JX2WTetZRfIG","collection-id":"60218fa606934b65f53046ad",private:!1,name:n},body:JSON.stringify(i)};return fetch(l,r).then((function(t){if(t.ok)return t.json();throw new Error("Failed to upload song")})).then((function(t){return t.id}))},p=function(t){return fetch(l+"/"+t,{headers:{"Content-Type":"application/json"}}).then((function(t){if(t.ok)return t.json();throw new Error("Failed to upload song")})).then((function(t){return u(t)}))},h=function(){if(!function(t){var e;try{e=window[t];var n="__storage_test__";return e.setItem(n,n),e.removeItem(n),!0}catch(i){return i instanceof DOMException&&(22===i.code||1014===i.code||"QuotaExceededError"===i.name||"NS_ERROR_DOM_QUOTA_REACHED"===i.name)&&e&&0!==e.length}}("localStorage"))return[];var t=localStorage.getItem("tabit-history");return t?JSON.parse(t).sort((function(t,e){return e.date-t.date})):[]},d=function(t){var e=c(t),n=r()(e),i=h(),a=i.filter((function(e){return e.id===n&&e.name===t.songName}));if(0!==a.length)a[0].date=Date.now();else{var o={name:t.songName,id:n,date:Date.now(),content:e};i.push(o)}var s=i.sort((function(t,e){return e.date-t.date})).slice(0,30);localStorage.setItem("tabit-history",JSON.stringify(s))},f=function(t){var e=t.songName+".tabit",n=JSON.stringify(t,null,4),i=new Blob([n],{type:"application/json"});Object(s.saveAs)(i,e)}}).call(this,n(75).Buffer)},92:function(t,e,n){"use strict";var i=n(16),r=n(17),a=n(1),o=n(2),s=n(144);var c=function(){function t(e,n){if(Object(a.a)(this,t),0===e.length)throw new Error("patternArray must not be zero length");this.rep=e,this.resolution=n}return Object(o.a)(t,[{key:"length",value:function(){return this.rep.length*this.resolution}},{key:"empty",value:function(){return 0===this.rep.reduce((function(t,e){return t+e}))}},{key:"_sumOverlapsOfArrays",value:function(t,e){for(var n=0,i=0;i<t.length;++i)t[i]&&e[i]&&n++;return n}},{key:"countOverlaps",value:function(e){if(this.resolution===e.resolution)return this._sumOverlapsOfArrays(this.rep,e.rep);var n=t.optimalResolution(this.resolution,e.resolution),i=this.formatResolution(n),r=e.formatResolution(n);return this._sumOverlapsOfArrays(i.rep,r.rep)}},{key:"aggregate",value:function(e){if(this.resolution===e.resolution){for(var n=Math.max(this.rep.length,e.rep.length),i=new Array(n).fill(0),r=0;r<i.length;++r)i[r]=(r<this.rep.length?this.rep[r]:0)||(r<e.rep.length?e.rep[r]:0);return new t(i,this.resolution)}var a=t.optimalResolution(this.resolution,e.resolution),o=this.formatResolution(a),s=e.formatResolution(a);return o.aggregate(s)}},{key:"compatible",value:function(t){var e=this.toPoints();if(this.length()%t!==0)return!1;var n,i=Object(r.a)(e);try{for(i.s();!(n=i.n()).done;){if(n.value%t!==0)return!1}}catch(a){i.e(a)}finally{i.f()}return!0}},{key:"format",value:function(e){var n=this.resolution*this.rep.length,i=this.toPoints(),r=t.representPoints(i,e,n);return r?new t(r,e):null}},{key:"toPoints",value:function(){var t,e=[],n=Object(r.a)(Array(this.rep.length).keys());try{for(n.s();!(t=n.n()).done;){var i=t.value;this.rep[i]&&e.push(this.resolution*i)}}catch(a){n.e(a)}finally{n.f()}return e}},{key:"clone",value:function(){return new t(Object(i.a)(this.rep),this.resolution)}}],[{key:"optimalResolution",value:function(t,e){return function(t,e){if(t<1||e<1)throw new Error("x<1 || y<1");for(;Math.max(t,e)%Math.min(t,e)!==0;)t>e?t%=e:e%=t;return Math.min(t,e)}(t,e)}},{key:"representPoints",value:function(t,e,n){if(n<=0)throw new Error("size must be greater than zero");if(n<e||n%e!==0)throw new Error("resolution must be less than size and divide it evenly");var i,a=new Array(n/e).fill(0),o=Object(r.a)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s%e!==0)throw new Error("Failed to represent point "+s.toString()+" at resolution "+e.toString());if(s>=n)throw new Error("Failed to represent point "+s.toString()+" for invalid specified size "+n.toString());a[s/e]=1}}catch(c){o.e(c)}finally{o.f()}return a}},{key:"fromPositions",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!==i&&void 0!==i?i:Object(s.a)(e,n);return new t(t.representPoints(e,r,n),r)}},{key:"combine",value:function(e,n,r,a){if(!e&&!n)throw new Error("Can't combine two null tracks");if(!r||!a)throw new Error("Need size and resolution parameters to be set");var o=e?e.toPoints():[],s=e?e.length():r-n.length(),c=n?n.toPoints().map((function(t){return t+s})):[],u=[].concat(Object(i.a)(o),Object(i.a)(c));return t.fromPositions(u,r,a)}}]),t}();e.a=c}},[[450,1,2]]]);
//# sourceMappingURL=main.1034de66.chunk.js.map