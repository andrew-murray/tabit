(this.webpackJsonptabit=this.webpackJsonptabit||[]).push([[0],{149:function(e,t,n){e.exports=n(187)},154:function(e,t,n){},173:function(e,t){},175:function(e,t){},185:function(e,t,n){},187:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(10),o=n.n(i),s=(n(154),n(12)),l=n(21),u=n(22),c=n(45),m=n(44),f=n(3),h=n(67),p=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).onChange=r.onChange.bind(Object(h.a)(r)),r}return Object(u.a)(n,[{key:"onChange",value:function(e){var t=this,n=e.target.files[0],r=new FileReader;r.onload=function(e){t.props.onImport&&t.props.onImport({file:n,content:e.target.result})},r.readAsText(n)}},{key:"render",value:function(){return a.a.createElement("input",{type:"file",onChange:this.onChange})}}]),n}(a.a.Component),d=n(29),v=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"validateConfig",value:function(e,t){if(null!=t&&e.beatResolution%t!==0)throw new Error("patternResolution doesn't divide beatResolution");if(e.lineResolution<=0)throw new Error("config.lineResolution doesn't divide patternResolution")}},{key:"chunkString",value:function(e,t){if(t<=0)throw new Error("chunkSize must be > 0");return e.match(new RegExp(".{1,"+t+"}","g"))}},{key:"createNumberMarker",value:function(t,n,r){if(n<=0||r<=0)throw new Error("(patternResolution, patternSize) arguments <= 0");if(r%n!==0)throw new Error("patternSize,doesn't divide patternResolution");e.validateConfig(t,n);for(var a=Math.min(r,t.lineResolution),i=Math.ceil(a/t.beatResolution),o=Array.from(Array(a/n),(function(e){return t.numberRestMark})),s=0;s<i;s++)o[s*(t.beatResolution/n)]=((s+1)%10).toString();return o.join("")}},{key:"formatLineWithMarkers",value:function(t,n,r){e.validateConfig(t);var a=t.beatResolution/r,i=t.showBeatMark?e.chunkString(n,a).join(t.beatMark):n;return t.lineMark+i+t.lineMark}},{key:"fromInstrumentAndTrack",value:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=0,i=Object.keys(r);a<i.length;a++){var o=i[a];if(!e.DEFAULT_FORMAT_CONFIG.hasOwnProperty(o))throw new Error("passed unrecognised property "+o)}var s=Object.assign(Object.assign({},e.DEFAULT_FORMAT_CONFIG),r),l=Object.values(n);if(0===l.length)return"";for(var u=l[0].length(),c=l[0].resolution,m=l[0].length()/l[0].resolution,f=Array(m).fill(s.restMark),h=0;h<f.length;++h)for(var p=0,v=Object.entries(t);p<v.length;p++){var g=Object(d.a)(v[p],2),b=g[0],y=g[1],k=n[b];null!=k&&1===k.rep[h]&&(f[h]=y)}var O=f.join(""),E=e.chunkString(O,s.lineResolution/c),j=[];s.showBeatNumbers&&j.push(e.formatLineWithMarkers(s,e.createNumberMarker(s,c,u),c));for(var w=0;w<E.length;++w)j.push(e.formatLineWithMarkers(s,E[w],c));return j.join("\n")}}]),e}();v.DEFAULT_FORMAT_CONFIG={restMark:"-",beatMark:"|",lineMark:"|",numberRestMark:"-",beatResolution:48,showBeatMark:!0,showBeatNumbers:!0,lineResolution:768},v.FORMAT_CONFIG_STRINGS=[["restMark",["-","."," "]],["numberRestMark",["-","."," "]],["beatResolution",["24","48","96"]]],v.FORMAT_CONFIG_BOOLS=["showBeatMark","showBeatNumbers"];var g=v,b=n(4),y=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={},r}return Object(u.a)(n,[{key:"formatText",value:function(e){var t,n=this.props.config,r=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var i=Object(d.a)(t.value,2),o=i[0],l=i[1],u=g.fromInstrumentAndTrack(l,this.props.tracks,n);r.push(o);var c,m=Object(s.a)(u.split("\n"));try{for(m.s();!(c=m.n()).done;){var f=c.value;r.push(f)}}catch(h){m.e(h)}finally{m.f()}}}catch(h){a.e(h)}finally{a.f()}return r}},{key:"render",value:function(){var e=this.props.classes;return a.a.createElement("div",{className:e.root},this.formatText(this.props.instruments).map((function(e,t){return a.a.createElement("p",{key:t.toString()},e)})))}}]),n}(a.a.Component),k=Object(b.a)((function(e){return{root:{"margin-bottom":e.spacing(2),fontFamily:"Roboto Mono",textAlign:"left",whiteSpace:"pre"}}}))(y),O=n(103),E=n.n(O),j=n(130);function w(e,t){for(var n=e.concat([t]),r=0,a=[48,24,16,12,8,6,4,3,2,1];r<a.length;r++){var i,o=a[r],l=!0,u=Object(s.a)(n);try{for(u.s();!(i=u.n()).done;){if(i.value%o!==0){l=!1;break}}}catch(c){u.e(c)}finally{u.f()}if(l)return o}throw new Error("Failed to predict base")}var S=function(){function e(t,n){if(Object(l.a)(this,e),0===t.length)throw new Error("patternArray must not be zero length");this.rep=t,this.resolution=n}return Object(u.a)(e,[{key:"length",value:function(){return this.rep.length*this.resolution}},{key:"empty",value:function(){return 0===this.rep.reduce((function(e,t){return e+t}))}},{key:"_sumOverlapsOfArrays",value:function(e,t){for(var n=0,r=0;r<e.length;++r)e[r]&&t[r]&&n++;return n}},{key:"countOverlaps",value:function(e){if(this.resolution===e.resolution)return this._sumOverlapsOfArrays(this.rep,e.rep);var t=function(e,t){if(e<1||t<1)throw new Error("x<1 || y<1");for(;Math.max(e,t)%Math.min(e,t)!==0;)e>t?e%=t:t%=e;return Math.min(e,t)}(this.resolution,e.resolution),n=this.formatResolution(t),r=e.formatResolution(t);return this._sumOverlapsOfArrays(n.rep,r.rep)}},{key:"format",value:function(t){var n=this.resolution*this.rep.length,r=this.toPoints(),a=e.representPoints(r,t,n);return a?new e(a,t):null}},{key:"toPoints",value:function(){var e,t=[],n=Object(s.a)(Array(this.rep.length).keys());try{for(n.s();!(e=n.n()).done;){var r=e.value;this.rep[r]&&t.push(this.resolution*r)}}catch(a){n.e(a)}finally{n.f()}return t}}],[{key:"representPoints",value:function(e,t,n){if(n<=0)throw new Error("size must be greater than zero");if(n<t||n%t!==0)throw new Error("resolution must be less than size and divide it evenly");var r,a=new Array(n/t).fill(0),i=Object(s.a)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o%t!==0)throw new Error("Failed to represent point "+o.toString()+" at resolution "+t.toString());if(o>=n)throw new Error("Failed to represent point "+o.toString()+" for invalid specified size "+n.toString());a[o/t]=1}}catch(l){i.e(l)}finally{i.f()}return a}},{key:"fromPositions",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null!==r&&void 0!==r?r:w(t,n);return new e(e.representPoints(t,a,n),a)}}]),e}(),C=n(131),A=n.n(C);function M(e){var t=e.song.instrumentList[0].instrument,n=Array.from(t,(function(e){return{id:parseInt(e.id),name:e.name,volume:parseFloat(e.volume),muted:"true"===e.isMuted[0],gain:parseFloat(e.gain)}})),r=e.song.patternList[0].pattern,a=Array.from(r,(function(e){var t=e.noteList[0].note,n=parseInt(e.size),r=[];return t&&(r=(r=Array.from(t,(function(e){return{position:parseInt(e.position),instrument:parseInt(e.instrument)}}))).filter((function(e){return e.position<n}))),{size:n,name:e.name,notes:r}})),i=Array.from(a,(function(e){var t,r=function(e,t){return w(Array.from(e.notes,(function(e){return e.position})),t)}(e,e.size),a={},i=Object(s.a)(n);try{var o=function(){var n=t.value,i=e.notes.filter((function(e){return e.instrument===n.id})),o=Array.from(i,(function(e){return e.position}));a[n.id.toString()]=S.fromPositions(o,e.size,r)};for(i.s();!(t=i.n()).done;)o()}catch(l){i.e(l)}finally{i.f()}return e.resolution=r,e.instrumentTracks=a,e}));return{instruments:n,patterns:i}}function I(){return(I=Object(j.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new A.a.Parser,e.abrupt("return",n.parseStringPromise(t).then(M));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F={parseHydrogenPromise:function(e){return I.apply(this,arguments)}},R=(n(185),n(268)),T=n(135),x=n(264),N=n(270),P=n(265),_=n(245),B=n(189),G=n(266),D=n(190),L=n(133),z=n.n(L),W=n(134),U=n.n(W),X=n(54),H=n(56),J=n(241),$=n(273),Z=n(246),q=n(242),K=n(249),Q=n(247),V=n(248),Y=n(267),ee=n(250),te=Object(J.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function ne(e){var t=e.replace(/([A-Z])/g," $1");return t[0].toUpperCase()+t.slice(1)}function re(e){var t=te();function n(e){return" "===e?"space":e}var r=function(t){var n,r=Object(H.a)(Object(H.a)({},e.settings),{},Object(X.a)({},t.target.name,"space"===(n=t.target.value)?" ":n));e.onChange(r)},i=function(t){var n=Object(H.a)(Object(H.a)({},e.settings),{},Object(X.a)({},t.target.name,t.target.checked));e.onChange(n)};return a.a.createElement(K.a,{className:t.root},g.FORMAT_CONFIG_STRINGS.map((function(i){return function(i,o){var s="form-control-"+i+"-id";return a.a.createElement(q.a,{variant:"filled",className:t.formControl,key:s,id:s},a.a.createElement($.a,{id:"settings-option-{name}"},i),a.a.createElement(Y.a,{labelId:"settings-option-"+i+"-labelID",id:"settings-option-"+i+"-id",value:n(e.settings[i]),name:i,onChange:r},o.map((function(e){return a.a.createElement(Z.a,{key:"settings-menu-item-"+i+"-"+e,value:n(e)},n(e))}))))}(i[0],i[1])})).reduce((function(e,t){return[e,a.a.createElement(ee.a,null),t]})),a.a.createElement(ee.a,null),g.FORMAT_CONFIG_BOOLS.map((function(t){return n=t,a.a.createElement(Q.a,{control:a.a.createElement(V.a,{checked:e.settings[n],onChange:i,name:n}),label:ne(n),key:"switch-"+n});var n})).reduce((function(e,t){return[e,a.a.createElement(ee.a,null),t]})))}var ae=g.DEFAULT_FORMAT_CONFIG,ie=n(78),oe=n(269),se=n(260),le=n(262),ue=n(251),ce=n(259),me=n(261),fe=n(252),he=n(132),pe=n.n(he),de=n(253),ve=n(271),ge=n(254),be=n(258),ye=n(256),ke=n(257),Oe=n(255),Ee=Object(J.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(1)}}}));function je(e){var t=Ee(),n=a.a.useState(-1),r=Object(d.a)(n,2),i=r[0],o=r[1],s=function(t,n){return a.a.createElement(ue.a,null,a.a.createElement(Q.a,{control:a.a.createElement(oe.a,{checked:e.instrumentMask[t]===n,onChange:function(r){return function(t,n,r){var a=e.instrumentIndex[t].id,i=e.instruments.findIndex((function(e){return a in e[1]})),o=n;if(i!==o){var s=e.instruments[i],l=["",{}];if(null!=s){l[0]=s[0];for(var u=0,c=Object.keys(s[1]);u<c.length;u++){var m=c[u];m!==a.toString()&&(l[1][m]=s[1][m])}}var f=[e.instruments[o][0],Object.assign({},e.instruments[o][1])];f[1][a.toString()]=null!=s?s[1][a]:"X";for(var h=[],p=0;p<e.instruments.length;++p)p===i?h.push(l):p===o?h.push(f):h.push(e.instruments[p]);e.onChange(h)}}(t,n)},name:t+","+n.toString()})}))};return a.a.createElement(a.a.Fragment,null,a.a.createElement(ge.a,{open:i>=0,onClose:function(e){return o(-1)},"aria-labelledby":"form-dialog-title"},a.a.createElement(Oe.a,{id:"form-dialog-title"}),a.a.createElement(ye.a,null,a.a.createElement(ke.a,null,"Enter instrument name"),a.a.createElement(ve.a,{autoFocus:!0,margin:"dense",id:"name",fullWidth:!0})),a.a.createElement(be.a,null,a.a.createElement(de.a,{onClick:function(e){return o(-1)},color:"primary"},"Cancel"),a.a.createElement(de.a,{onClick:function(e){console.log("renameInstrument fired"),o(-1)},color:"primary"},"Confirm"))),a.a.createElement(ce.a,null,a.a.createElement(se.a,{className:t.table,"aria-label":"simple table"},a.a.createElement(me.a,null,a.a.createElement(fe.a,null,a.a.createElement(ue.a,null," Instrument "),Object(ie.a)(Array(e.instrumentIndex.length).keys()).map((function(t){return a.a.createElement(ue.a,null,e.instrumentIndex[t].name)})))),a.a.createElement(le.a,null,Object(ie.a)(Array(e.instruments.length).keys()).map((function(t){return function(t){return a.a.createElement(fe.a,null,a.a.createElement(ue.a,{component:"th",scope:"row"},a.a.createElement(de.a,{onClick:function(e){return o(t)}},e.instruments[t][0])),Object(ie.a)(Array(e.instrumentIndex.length).keys()).map((function(e){return s(e,t)})))}(t)})),a.a.createElement(fe.a,null,a.a.createElement(ue.a,{component:"th",scope:"row"},a.a.createElement(D.a,{onClick:function(t){return o(e.instruments.length)},"aria-label":"add"},a.a.createElement(pe.a,null))))))))}function we(e,t){for(var n=Array(e.length),r=0;r<e.length;++r)for(var a=e[r].id,i=0;i<t.length;++i){var o=t[i];a.toString()in o[1]&&(n[r]=i)}return n}var Se={"Djembe Slap":"S","Djembe Tone":"t","Djembe Bass":"O","Snare Ghost":"-","Snare Accent":"X","Shaker Ghost":"x","Shaker Accent":"X",Click:"X",Bass:"O",Tom:"O",Default:"X"};function Ce(e){var t,n=[],r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=Object.assign({},a);i.name=i.name[0].toLowerCase(),n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n}function Ae(e,t,n,r){var a=[];if(2===e.length){var i=e[0],o=e[1],l=i.volume>o.volume||i.volume===o.volume&&i.gain>o.gain,u={};u[i.id.toString()]=l?n:r,u[o.id.toString()]=l?r:n,a.push([t,u])}else{var c,m=Object(s.a)(e);try{for(m.s();!(c=m.n()).done;){var f=c.value,h={};h[f.id.toString()]=n,a.push([t,h])}}catch(p){m.e(p)}finally{m.f()}}return a}function Me(e){var t,n=new Set,r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=0,o=Object.entries(a.instrumentTracks);i<o.length;i++){var l=Object(d.a)(o[i],2),u=l[0];l[1].empty()||n.add(parseInt(u))}}catch(c){r.e(c)}finally{r.f()}return n}function Ie(e,t,n){var r=[];r=(r=(r=(r=r.concat(function(e,t,n){for(var r=Ce(e),a=Me(n),i=r.filter((function(e){return a.has(e.id)&&!e.name.includes("djembe")&&(e.name.includes("click")||e.name.includes("stick")||e.name.includes("tom")||e.name.includes("bass")||e.name.includes("kick"))})),o=Array.from(i,(function(e){return e.name.includes("click")||e.name.includes("stick")})),s=[],l=0;l<Math.floor(i.length/2);++l)if(o[2*l]!==o[2*l+1]){var u=o[2*l]?i[2*l]:i[2*l+1],c=o[2*l]?i[2*l+1]:i[2*l],m=c.name.includes("tom")?"Tom":"Bass",f={};f[c.id.toString()]=t[m],f[u.id.toString()]=t.Click,s.push([m,f])}if(i.length%2!==0&&!o[i.length-1]){var h=i[i.length-1],p=h.name.includes("tom")?"Tom":"Bass",d={};d[h.id.toString()]=t[p],s.push([p,d])}return s}(e,t,n))).concat(function(e,t){var n=Ce(e).filter((function(e){return e.name.includes("djembe")}));if(0===n.length)return[];if(n.length<=3){for(var r=Array.from(n,(function(e){return e.name.includes("slap")})),a=Array.from(n,(function(e){return e.name.includes("tone")})),i=Array.from(n,(function(e){return e.name.includes("bass")})),o=0;o<n.length;++o){if(1!==r[o]+a[o]+i[o])return[]}for(var s={},l=0;l<n.length;++l)r[l]?s[n[l].id.toString()]=t["Djembe Slap"]:a[l]?s[n[l].id.toString()]=t["Djembe Tone"]:i[l]&&(s[n[l].id.toString()]=t["Djembe Bass"]);return[["Djembe",s]]}return[]}(e,t))).concat(function(e,t){return Ae(Ce(e).filter((function(e){return e.name.includes("snare")})),"Snare",t["Snare Accent"],t["Snare Ghost"])}(e,t))).concat(function(e,t){return Ae(Ce(e).filter((function(e){return e.name.includes("shaker")})),"Shaker",t["Shaker Accent"],t["Shaker Ghost"])}(e,t));var a,i=Me(n),o=Object(s.a)(e);try{for(o.s();!(a=o.n()).done;){var l=a.value;if(i.has(l.id)){var u,c=!1,m=Object(s.a)(r);try{for(m.s();!(u=m.n()).done;){var f=u.value;l.id.toString()in f[1]&&(c=!0)}}catch(p){m.e(p)}finally{m.f()}if(!1===c){var h={};h[l.id.toString()]=t.Default,r.push([l.name[0],h])}}}}catch(p){o.e(p)}finally{o.f()}return r}var Fe=n(263),Re=Object(T.a)({palette:{type:"dark",primary:{main:"#36d9be"},secondary:{main:"#f50057"}}}),Te=function(e){Object(c.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={instruments:null,instrumentIndex:null,instrumentMask:null,patterns:null,selectedPattern:null,loadedFile:null,settingsOpen:!1,formatSettings:Object.assign({},ae)},r}return Object(u.a)(n,[{key:"handleFileImport",value:function(e){var t=this;F.parseHydrogenPromise(e.content).then((function(n){var r=Ie(n.instruments,Se,n.patterns),a=function(e,t){var n,r=Me(t),a=[],i=Object(s.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.has(o.id)&&a.push(o)}}catch(l){i.e(l)}finally{i.f()}return a}(n.instruments,n.patterns);t.setState({instrumentIndex:a,instrumentMask:we(a,r),instruments:r,patterns:n.patterns,selectedPattern:0===n.patterns.length?null:0,loadedFile:e.file.name})}))}},{key:"selectPattern",value:function(e){this.setState({selectedPattern:e})}},{key:"renderPattern",value:function(e,t){var n=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement(k,{instruments:this.state.instruments,tracks:e.instrumentTracks,config:this.state.formatSettings}),a.a.createElement(Fe.a,{container:!0},a.a.createElement(Fe.a,{item:!0,xs:2}),a.a.createElement(Fe.a,{item:!0,xs:8},a.a.createElement(je,{instruments:this.state.instruments,instrumentIndex:this.state.instrumentIndex,instrumentMask:this.state.instrumentMask,onChange:function(e){n.setState({instruments:e,instrumentMask:we(n.state.instrumentIndex,e)})}})),a.a.createElement(Fe.a,{item:!0,xs:2})))}},{key:"renderMainContent",value:function(){var e=this;if(null==this.state.patterns||0===this.state.patterns.length){var t=null!=this.state.patterns&&0===this.state.patterns.length?a.a.createElement(R.a,{severity:"error"},this.state.loadedFile," contained no patterns! Try another."):"";return a.a.createElement("div",null,a.a.createElement("h2",null,"tabit"),a.a.createElement(p,{onImport:this.handleFileImport.bind(this)}),t)}var n=null;if(null==this.state.selectedPattern){n=[];var r,i=Object(s.a)(this.state.patterns);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.push(this.renderPattern(o))}}catch(c){i.e(c)}finally{i.f()}}else{var l=this.state.patterns[this.state.selectedPattern];n=this.renderPattern(l)}var u=this.props;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{display:"flex",width:"95%"}},a.a.createElement("div",{className:"content-title",style:{flexGrow:1}}),a.a.createElement(D.a,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:function(){e.setState({settingsOpen:!0})},className:Object(f.a)(this.state.settingsOpen&&u.hide)},a.a.createElement(z.a,null))),n,a.a.createElement(N.a,{className:u.drawer,variant:"persistent",anchor:"right",open:this.state.settingsOpen,classes:{paper:u.drawerPaper}},a.a.createElement("div",{className:u.drawerHeader},a.a.createElement(D.a,{onClick:function(){e.setState({settingsOpen:!1})}},a.a.createElement(U.a,null))),a.a.createElement(re,{onChange:function(t){e.setState({formatSettings:t})},settings:this.state.formatSettings})))}},{key:"render",value:function(){var e,t=this,n=this.props,r=null!=this.state.patterns,i=this.renderMainContent();return a.a.createElement("div",{className:"App"},a.a.createElement(x.a,{theme:Re},a.a.createElement(P.a,null),a.a.createElement(N.a,{className:n.drawer,variant:"persistent",open:r},a.a.createElement("div",{className:n.drawerContainer},a.a.createElement(_.a,null,(null!==(e=this.state.patterns)&&void 0!==e?e:[]).map((function(e,n){return a.a.createElement(B.a,{button:!0,key:"drawer-pattern"+n.toString(),onClick:function(){return t.selectPattern(n)}},a.a.createElement(G.a,{primary:e.name}))}))))),i))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[149,1,2]]]);
//# sourceMappingURL=main.006f6c96.chunk.js.map