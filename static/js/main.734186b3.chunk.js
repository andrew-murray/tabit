(this.webpackJsonptabit=this.webpackJsonptabit||[]).push([[0],{140:function(e,t,n){e.exports=n(178)},145:function(e,t,n){},164:function(e,t){},166:function(e,t){},176:function(e,t,n){},178:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(9),o=n.n(i),s=(n(145),n(11)),u=n(19),l=n(20),c=n(43),f=n(41),m=n(3),h=n(65),p=function(e){Object(c.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onChange=r.onChange.bind(Object(h.a)(r)),r}return Object(l.a)(n,[{key:"onChange",value:function(e){var t=this,n=e.target.files[0],r=new FileReader;r.onload=function(e){t.props.onImport&&t.props.onImport({file:n,content:e.target.result})},r.readAsText(n)}},{key:"render",value:function(){return a.a.createElement("input",{type:"file",onChange:this.onChange})}}]),n}(a.a.Component),v=n(42),d=function(){function e(){Object(u.a)(this,e)}return Object(l.a)(e,null,[{key:"validateConfig",value:function(e,t){if(null!=t&&e.beatResolution%t!==0)throw new Error("patternResolution doesn't divide beatResolution");if(e.lineResolution<=0)throw new Error("config.lineResolution doesn't divide patternResolution")}},{key:"chunkString",value:function(e,t){if(t<=0)throw new Error("chunkSize must be > 0");return e.match(new RegExp(".{1,"+t+"}","g"))}},{key:"createNumberMarker",value:function(t,n,r){if(n<=0||r<=0)throw new Error("(patternResolution, patternSize) arguments <= 0");if(r%n!==0)throw new Error("patternSize,doesn't divide patternResolution");e.validateConfig(t,n);for(var a=Math.min(r,t.lineResolution),i=Math.ceil(a/t.beatResolution),o=Array.from(Array(a/n),(function(e){return t.numberRestMark})),s=0;s<i;s++)o[s*(t.beatResolution/n)]=((s+1)%10).toString();return o.join("")}},{key:"formatLineWithMarkers",value:function(t,n,r){e.validateConfig(t);var a=t.beatResolution/r,i=t.showBeatMark?e.chunkString(n,a).join(t.beatMark):n;return t.lineMark+i+t.lineMark}},{key:"fromInstrumentAndTrack",value:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=0,i=Object.keys(r);a<i.length;a++){var o=i[a];if(!e.DEFAULT_FORMAT_CONFIG.hasOwnProperty(o))throw new Error("passed unrecognised property "+o)}var s=Object.assign(Object.assign({},e.DEFAULT_FORMAT_CONFIG),r),u=Object.values(n);if(0===u.length)return"";for(var l=u[0].length(),c=u[0].resolution,f=u[0].length()/u[0].resolution,m=Array(f).fill(s.restMark),h=0;h<m.length;++h)for(var p=0,d=Object.entries(t);p<d.length;p++){var g=Object(v.a)(d[p],2),b=g[0],y=g[1],k=n[b];null!=k&&1===k.rep[h]&&(m[h]=y)}var O=m.join(""),j=e.chunkString(O,s.lineResolution/c),E=[];s.showBeatNumbers&&E.push(e.formatLineWithMarkers(s,e.createNumberMarker(s,c,l),c));for(var S=0;S<j.length;++S)E.push(e.formatLineWithMarkers(s,j[S],c));return E.join("\n")}}]),e}();d.DEFAULT_FORMAT_CONFIG={restMark:"-",beatMark:"|",lineMark:"|",numberRestMark:"-",beatResolution:48,showBeatMark:!0,showBeatNumbers:!0,lineResolution:768},d.FORMAT_CONFIG_STRINGS=[["restMark",["-","."," "]],["numberRestMark",["-","."," "]],["beatResolution",["24","48","96"]]],d.FORMAT_CONFIG_BOOLS=["showBeatMark","showBeatNumbers"];var g=d,b=n(4),y=function(e){Object(c.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={},r}return Object(l.a)(n,[{key:"formatText",value:function(e){var t,n=this.props.config,r=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var i=Object(v.a)(t.value,2),o=i[0],u=i[1],l=g.fromInstrumentAndTrack(u,this.props.tracks,n);r.push(o);var c,f=Object(s.a)(l.split("\n"));try{for(f.s();!(c=f.n()).done;){var m=c.value;r.push(m)}}catch(h){f.e(h)}finally{f.f()}}}catch(h){a.e(h)}finally{a.f()}return r}},{key:"render",value:function(){var e=this.props.classes;return a.a.createElement("div",{className:e.root},this.formatText(this.props.instruments).map((function(e,t){return a.a.createElement("p",{key:t.toString()},e)})))}}]),n}(a.a.Component),k=Object(b.a)((function(e){return{root:{"margin-bottom":e.spacing(2),fontFamily:"Roboto Mono",textAlign:"left",whiteSpace:"pre"}}}))(y),O=n(96),j=n.n(O),E=n(123);function S(e,t){for(var n=e.concat([t]),r=0,a=[48,24,16,12,8,6,4,3,2,1];r<a.length;r++){var i,o=a[r],u=!0,l=Object(s.a)(n);try{for(l.s();!(i=l.n()).done;){if(i.value%o!==0){u=!1;break}}}catch(c){l.e(c)}finally{l.f()}if(u)return o}throw new Error("Failed to predict base")}var w=function(){function e(t,n){if(Object(u.a)(this,e),0===t.length)throw new Error("patternArray must not be zero length");this.rep=t,this.resolution=n}return Object(l.a)(e,[{key:"length",value:function(){return this.rep.length*this.resolution}},{key:"empty",value:function(){return 0===this.rep.reduce((function(e,t){return e+t}))}},{key:"_sumOverlapsOfArrays",value:function(e,t){for(var n=0,r=0;r<e.length;++r)e[r]&&t[r]&&n++;return n}},{key:"countOverlaps",value:function(e){if(this.resolution===e.resolution)return this._sumOverlapsOfArrays(this.rep,e.rep);var t=function(e,t){if(e<1||t<1)throw new Error("x<1 || y<1");for(;Math.max(e,t)%Math.min(e,t)!==0;)e>t?e%=t:t%=e;return Math.min(e,t)}(this.resolution,e.resolution),n=this.formatResolution(t),r=e.formatResolution(t);return this._sumOverlapsOfArrays(n.rep,r.rep)}},{key:"format",value:function(t){var n=this.resolution*this.rep.length,r=this.toPoints(),a=e.representPoints(r,t,n);return a?new e(a,t):null}},{key:"toPoints",value:function(){var e,t=[],n=Object(s.a)(Array(this.rep.length).keys());try{for(n.s();!(e=n.n()).done;){var r=e.value;this.rep[r]&&t.push(this.resolution*r)}}catch(a){n.e(a)}finally{n.f()}return t}}],[{key:"representPoints",value:function(e,t,n){if(n<=0)throw new Error("size must be greater than zero");if(n<t||n%t!==0)throw new Error("resolution must be less than size and divide it evenly");var r,a=new Array(n/t).fill(0),i=Object(s.a)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o%t!==0)throw new Error("Failed to represent point "+o.toString()+" at resolution "+t.toString());if(o>=n)throw new Error("Failed to represent point "+o.toString()+" for invalid specified size "+n.toString());a[o/t]=1}}catch(u){i.e(u)}finally{i.f()}return a}},{key:"fromPositions",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null!==r&&void 0!==r?r:S(t,n);return new e(e.representPoints(t,a,n),a)}}]),e}(),M=n(124),A=n.n(M);function C(e){var t=e.song.instrumentList[0].instrument,n=Array.from(t,(function(e){return{id:parseInt(e.id),name:e.name,volume:parseFloat(e.volume),muted:"true"===e.isMuted[0],gain:parseFloat(e.gain)}})),r=e.song.patternList[0].pattern,a=Array.from(r,(function(e){var t=e.noteList[0].note,n=parseInt(e.size),r=[];return t&&(r=(r=Array.from(t,(function(e){return{position:parseInt(e.position),instrument:parseInt(e.instrument)}}))).filter((function(e){return e.position<n}))),{size:n,name:e.name,notes:r}})),i=Array.from(a,(function(e){var t,r=function(e,t){return S(Array.from(e.notes,(function(e){return e.position})),t)}(e,e.size),a={},i=Object(s.a)(n);try{var o=function(){var n=t.value,i=e.notes.filter((function(e){return e.instrument===n.id})),o=Array.from(i,(function(e){return e.position}));a[n.id.toString()]=w.fromPositions(o,e.size,r)};for(i.s();!(t=i.n()).done;)o()}catch(u){i.e(u)}finally{i.f()}return e.resolution=r,e.instrumentTracks=a,e}));return{instruments:n,patterns:i}}function F(){return(F=Object(E.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new A.a.Parser,e.abrupt("return",n.parseStringPromise(t).then(C));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I={parseHydrogenPromise:function(e){return F.apply(this,arguments)}},R=(n(176),n(231)),T=n(127),N=n(227),P=n(233),x=n(228),_=n(221),B=n(180),G=n(229),D=n(181),L=n(125),z=n.n(L),W=n(126),U=n.n(W),X=n(52),H=n(54),J=n(217),$=n(219),Z=n(222),q=n(218),K=n(225),Q=n(223),V=n(224),Y=n(230),ee=n(226),te=Object(J.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function ne(e){var t=e.replace(/([A-Z])/g," $1");return t[0].toUpperCase()+t.slice(1)}function re(e){var t=te();function n(e){return" "===e?"space":e}var r=function(t){var n,r=Object(H.a)(Object(H.a)({},e.settings),{},Object(X.a)({},t.target.name,"space"===(n=t.target.value)?" ":n));e.onChange(r)},i=function(t){var n=Object(H.a)(Object(H.a)({},e.settings),{},Object(X.a)({},t.target.name,t.target.checked));e.onChange(n)};return a.a.createElement(K.a,{className:t.root},g.FORMAT_CONFIG_STRINGS.map((function(i){return function(i,o){var s="form-control-"+i+"-id";return a.a.createElement(q.a,{variant:"filled",className:t.formControl,key:s,id:s},a.a.createElement($.a,{id:"settings-option-{name}"},i),a.a.createElement(Y.a,{labelId:"settings-option-"+i+"-labelID",id:"settings-option-"+i+"-id",value:n(e.settings[i]),name:i,onChange:r},o.map((function(e){return a.a.createElement(Z.a,{key:"settings-menu-item-"+i+"-"+e,value:n(e)},n(e))}))))}(i[0],i[1])})).reduce((function(e,t){return[e,a.a.createElement(ee.a,null),t]})),a.a.createElement(ee.a,null),g.FORMAT_CONFIG_BOOLS.map((function(t){return n=t,a.a.createElement(Q.a,{control:a.a.createElement(V.a,{checked:e.settings[n],onChange:i,name:n}),label:ne(n),key:"switch-"+n});var n})).reduce((function(e,t){return[e,a.a.createElement(ee.a,null),t]})))}var ae=g.DEFAULT_FORMAT_CONFIG,ie=n(97),oe=n(179),se=n(234),ue=Object(J.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(1)}}}));function le(e){var t=ue(),n=function(t,n,r){var a=e.instrumentIndex[t].id,i=e.instruments.findIndex((function(e){return a in e[1]})),o=n;if(i!==o){var s=e.instruments[i],u=["",{}];if(null!=s){u[0]=s[0];for(var l=0,c=Object.keys(s[1]);l<c.length;l++){var f=c[l];f!==a.toString()&&(u[1][f]=s[1][f])}}var m=[e.instruments[o][0],Object.assign({},e.instruments[o][1])];m[1][a.toString()]=null!=s?s[1][a]:"X";for(var h=[],p=0;p<e.instruments.length;++p)p===i?h.push(u):p===o?h.push(m):h.push(e.instruments[p]);e.onChange(h)}},r=function(r,i){return a.a.createElement(q.a,{component:"fieldset",className:t.formControl,key:"track-form-"+i.toString()+"-"+r},a.a.createElement(oe.a,{component:"legend"},r),a.a.createElement(K.a,null,Object(ie.a)(Array(e.instruments.length).keys()).map((function(t){return function(t,r){return 0===t?a.a.createElement(Q.a,{control:a.a.createElement(se.a,{checked:e.instrumentMask[t]===r,onChange:function(e){return n(t,r)},name:t+","+r.toString()}),label:e.instruments[r][0],labelPlacement:"start"}):a.a.createElement(Q.a,{control:a.a.createElement(se.a,{checked:e.instrumentMask[t]===r,onChange:function(e){return n(t,r)},name:t+","+r.toString()})})}(i,t)}))))};return a.a.createElement(K.a,{className:t.root,row:!0},Object(ie.a)(Array(e.instrumentIndex.length).keys()).map((function(t){return r(e.instrumentIndex[t].name,t)})))}function ce(e,t){for(var n=Array(e.length),r=0;r<e.length;++r)for(var a=e[r].id,i=0;i<t.length;++i){var o=t[i];a.toString()in o[1]&&(n[r]=i)}return n}var fe={"Djembe Slap":"S","Djembe Tone":"t","Djembe Bass":"O","Snare Ghost":"-","Snare Accent":"X","Shaker Ghost":"x","Shaker Accent":"X",Click:"X",Bass:"O",Tom:"O",Default:"X"};function me(e){var t,n=[],r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=Object.assign({},a);i.name=i.name[0].toLowerCase(),n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n}function he(e,t,n,r){var a=[];if(2===e.length){var i=e[0],o=e[1],u=i.volume>o.volume||i.volume===o.volume&&i.gain>o.gain,l={};l[i.id.toString()]=u?n:r,l[o.id.toString()]=u?r:n,a.push([t,l])}else{var c,f=Object(s.a)(e);try{for(f.s();!(c=f.n()).done;){var m=c.value,h={};h[m.id.toString()]=n,a.push([t,h])}}catch(p){f.e(p)}finally{f.f()}}return a}function pe(e){var t,n=new Set,r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=0,o=Object.entries(a.instrumentTracks);i<o.length;i++){var u=Object(v.a)(o[i],2),l=u[0];u[1].empty()||n.add(parseInt(l))}}catch(c){r.e(c)}finally{r.f()}return n}function ve(e,t,n){var r=[];r=(r=(r=(r=r.concat(function(e,t,n){for(var r=me(e),a=pe(n),i=r.filter((function(e){return a.has(e.id)&&!e.name.includes("djembe")&&(e.name.includes("click")||e.name.includes("stick")||e.name.includes("tom")||e.name.includes("bass")||e.name.includes("kick"))})),o=Array.from(i,(function(e){return e.name.includes("click")||e.name.includes("stick")})),s=[],u=0;u<Math.floor(i.length/2);++u)if(o[2*u]!==o[2*u+1]){var l=o[2*u]?i[2*u]:i[2*u+1],c=o[2*u]?i[2*u+1]:i[2*u],f=c.name.includes("tom")?"Tom":"Bass",m={};m[c.id.toString()]=t[f],m[l.id.toString()]=t.Click,s.push([f,m])}if(i.length%2!==0&&!o[i.length-1]){var h=i[i.length-1],p=h.name.includes("tom")?"Tom":"Bass",v={};v[h.id.toString()]=t[p],s.push([p,v])}return s}(e,t,n))).concat(function(e,t){var n=me(e).filter((function(e){return e.name.includes("djembe")}));if(0===n.length)return[];if(n.length<=3){for(var r=Array.from(n,(function(e){return e.name.includes("slap")})),a=Array.from(n,(function(e){return e.name.includes("tone")})),i=Array.from(n,(function(e){return e.name.includes("bass")})),o=0;o<n.length;++o){if(1!==r[o]+a[o]+i[o])return[]}for(var s={},u=0;u<n.length;++u)r[u]?s[n[u].id.toString()]=t["Djembe Slap"]:a[u]?s[n[u].id.toString()]=t["Djembe Tone"]:i[u]&&(s[n[u].id.toString()]=t["Djembe Bass"]);return[["Djembe",s]]}return[]}(e,t))).concat(function(e,t){return he(me(e).filter((function(e){return e.name.includes("snare")})),"Snare",t["Snare Accent"],t["Snare Ghost"])}(e,t))).concat(function(e,t){return he(me(e).filter((function(e){return e.name.includes("shaker")})),"Shaker",t["Shaker Accent"],t["Shaker Ghost"])}(e,t));var a,i=pe(n),o=Object(s.a)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value;if(i.has(u.id)){var l,c=!1,f=Object(s.a)(r);try{for(f.s();!(l=f.n()).done;){var m=l.value;u.id.toString()in m[1]&&(c=!0)}}catch(p){f.e(p)}finally{f.f()}if(!1===c){var h={};h[u.id.toString()]=t.Default,r.push([u.name[0],h])}}}}catch(p){o.e(p)}finally{o.f()}return r}var de=Object(T.a)({palette:{type:"dark",primary:{main:"#36d9be"},secondary:{main:"#f50057"}}}),ge=function(e){Object(c.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={instruments:null,instrumentIndex:null,instrumentMask:null,patterns:null,selectedPattern:null,loadedFile:null,settingsOpen:!1,formatSettings:Object.assign({},ae)},r}return Object(l.a)(n,[{key:"handleFileImport",value:function(e){var t=this;I.parseHydrogenPromise(e.content).then((function(n){var r=ve(n.instruments,fe,n.patterns),a=function(e,t){var n,r=pe(t),a=[],i=Object(s.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.has(o.id)&&a.push(o)}}catch(u){i.e(u)}finally{i.f()}return a}(n.instruments,n.patterns);t.setState({instrumentIndex:a,instrumentMask:ce(a,r),instruments:r,patterns:n.patterns,selectedPattern:0===n.patterns.length?null:0,loadedFile:e.file.name})}))}},{key:"selectPattern",value:function(e){this.setState({selectedPattern:e})}},{key:"renderPattern",value:function(e,t){var n=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement(k,{instruments:this.state.instruments,tracks:e.instrumentTracks,config:this.state.formatSettings}),a.a.createElement(le,{instruments:this.state.instruments,instrumentIndex:this.state.instrumentIndex,instrumentMask:this.state.instrumentMask,onChange:function(e){n.setState({instruments:e,instrumentMask:ce(n.state.instrumentIndex,e)})}}))}},{key:"renderMainContent",value:function(){var e=this;if(null==this.state.patterns||0===this.state.patterns.length){var t=null!=this.state.patterns&&0===this.state.patterns.length?a.a.createElement(R.a,{severity:"error"},this.state.loadedFile," contained no patterns! Try another."):"";return a.a.createElement("div",null,a.a.createElement("h2",null,"tabit"),a.a.createElement(p,{onImport:this.handleFileImport.bind(this)}),t)}var n=null;if(null==this.state.selectedPattern){n=[];var r,i=Object(s.a)(this.state.patterns);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.push(this.renderPattern(o))}}catch(c){i.e(c)}finally{i.f()}}else{var u=this.state.patterns[this.state.selectedPattern];n=this.renderPattern(u)}var l=this.props;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{display:"flex",width:"95%"}},a.a.createElement("div",{className:"content-title",style:{flexGrow:1}}),a.a.createElement(D.a,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:function(){e.setState({settingsOpen:!0})},className:Object(m.a)(this.state.settingsOpen&&l.hide)},a.a.createElement(z.a,null))),n,a.a.createElement(P.a,{className:l.drawer,variant:"persistent",anchor:"right",open:this.state.settingsOpen,classes:{paper:l.drawerPaper}},a.a.createElement("div",{className:l.drawerHeader},a.a.createElement(D.a,{onClick:function(){e.setState({settingsOpen:!1})}},a.a.createElement(U.a,null))),a.a.createElement(re,{onChange:function(t){e.setState({formatSettings:t})},settings:this.state.formatSettings})))}},{key:"render",value:function(){var e,t=this,n=this.props,r=null!=this.state.patterns,i=this.renderMainContent();return a.a.createElement("div",{className:"App"},a.a.createElement(N.a,{theme:de},a.a.createElement(x.a,null),a.a.createElement(P.a,{className:n.drawer,variant:"persistent",open:r},a.a.createElement("div",{className:n.drawerContainer},a.a.createElement(_.a,null,(null!==(e=this.state.patterns)&&void 0!==e?e:[]).map((function(e,n){return a.a.createElement(B.a,{button:!0,key:"drawer-pattern"+n.toString(),onClick:function(){return t.selectPattern(n)}},a.a.createElement(G.a,{primary:e.name}))}))))),i))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[140,1,2]]]);
//# sourceMappingURL=main.734186b3.chunk.js.map