(this.webpackJsonptabit=this.webpackJsonptabit||[]).push([[0],{133:function(t,n,e){"use strict";e.d(n,"b",(function(){return b})),e.d(n,"a",(function(){return v}));var i=e(7),r=(e(0),e(275)),o=e(438),a=e(429),s=e(428),u=e(432),c=e(430),l=e(277),m=e(137),p=e(433),h=e(431),f=e(436),d=e(43),j=Object(r.a)((function(t){return{formControl:{margin:t.spacing(1),minWidth:120}}}));function g(t){var n=t.replace(/([A-Z])/g," $1");return n[0].toUpperCase()+n.slice(1)}function b(t){var n=j(t);function e(t){return" "===t?"space":t}function r(t){return"space"===t?" ":t}var b=function(n,e,i){t.onChange({key:n,value:e,local:i})},v=function(n){t.onChange({key:n.target.name,value:n.target.checked,local:!1})};function O(u,c){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,h=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d="form-control-"+u+"-id";return Object(i.jsx)(m.a,{variant:"filled",className:n.formControl,id:d,style:{width:"75%"},children:Object(i.jsxs)(s.a,{style:{width:"100%"},children:[Object(i.jsx)(o.a,{id:"settings-option-{name}",children:u}),Object(i.jsx)(f.a,{labelId:"settings-option-"+u+"-labelID",id:"settings-option-"+u+"-id",value:p(t.settings[u]),name:u,onChange:function(t){return b(t.target.name,l(t.target.value),h)},style:{width:"75%",textAlign:"center"},children:c.map((function(t){return Object(i.jsx)(a.a,{value:p(t),style:{textAlign:"center"},children:p(t)},"settings-menu-item-"+u+"-"+t)}))})]})},d)}for(var y=[],x=0,k=[2,3,4,5,6,7,8,14,16,32];x<k.length;x++){var S=48*k[x];S%t.settings.beatResolution===0&&S<=t.pattern.length&&y.push(S)}y.includes(t.pattern.length)||(y.push(t.pattern.length),y.sort((function(t,n){return t-n})));for(var w=[],C=0,D=[24,36,48,72,96];C<D.length;C++){var T=D[C];T%t.pattern.resolution===0&&t.settings.lineResolution%T===0&&w.push(T)}return Object(i.jsx)(u.a,{className:n.root,children:Object(i.jsxs)(l.a,{children:[d.a.FORMAT_CONFIG_STRINGS.map((function(t){return O(t[0],t[1])})).reduce((function(t,n){return[t,n]})),d.a.FORMAT_CONFIG_BOOLS.map((function(n){return e=n,Object(i.jsx)(m.a,{children:Object(i.jsx)(c.a,{control:Object(i.jsx)(h.a,{checked:t.settings[e],onChange:v,name:e}),label:g(e)},"switch-"+e)},"form-control-"+e);var e})).reduce((function(t,n){return[t,n]})),Object(i.jsxs)(p.a,{children:["Pattern "+t.pattern.name+" Options"," "]}),O("beatResolution",w,(function(t){return t.toString()}),(function(t){return parseInt(t)}),!0),O("lineResolution",y,(function(n){return t.settings.beatResolution*parseInt(n)}),(function(n){return(n/t.settings.beatResolution).toString()}),!0)]})})}var v=d.a.DEFAULT_FORMAT_CONFIG},249:function(t){t.exports=JSON.parse('{"instruments":[{"id":23,"name":"Stick","volume":0.99569,"muted":false,"gain":1,"drumkit":"GMRockKit","filename":"SideStick-Softest.wav"},{"id":24,"name":"Kick Short","volume":1,"muted":false,"gain":1,"drumkit":"TR808EmulationKit","filename":"808_Kick_Short.flac"},{"id":20,"name":"Stick","volume":0.193966,"muted":false,"gain":1,"drumkit":"DeathMetal"},{"id":26,"name":"Stick","volume":0.99569,"muted":false,"gain":1,"drumkit":"GMRockKit","filename":"SideStick-Softest.wav"},{"id":25,"name":"Kick Short","volume":1,"muted":false,"gain":1,"drumkit":"TR808EmulationKit","filename":"808_Kick_Short.flac"},{"id":22,"name":"tom02","volume":0.65,"muted":false,"gain":1,"drumkit":"DeathMetal"},{"id":27,"name":"snare","volume":0.49,"muted":false,"gain":1,"drumkit":"DeathMetal","filename":"014b.WAV"},{"id":13,"name":"Snare 1","volume":0.35,"muted":false,"gain":0.4,"drumkit":"DeathMetal"},{"id":10,"name":"Djembe4 Slap","volume":0.12931,"muted":false,"gain":1,"drumkit":"circAfrique v4","filename":"Djembe4 Slap.wav"},{"id":11,"name":"Djembe4 Tone","volume":0.12931,"muted":false,"gain":0.95,"drumkit":"circAfrique v4","filename":"Djembe4 Tone.wav"},{"id":12,"name":"Djembe4 Bass","volume":0.181034,"muted":false,"gain":1.5,"drumkit":"circAfrique v4","filename":"Djembe4 Bass.wav"},{"id":16,"name":"Shaker","volume":0.232759,"muted":false,"gain":2.2,"drumkit":"TR808EmulationKit","filename":"808_Shaker.flac"},{"id":21,"name":"Shaker","volume":1.5,"muted":false,"gain":2.45,"drumkit":"TR808EmulationKit","filename":"808_Shaker.flac"}],"patterns":[{"size":384,"name":"k-1","notes":[{"position":0,"instrument":21},{"position":0,"instrument":24},{"position":0,"instrument":26},{"position":0,"instrument":11},{"position":12,"instrument":21},{"position":24,"instrument":11},{"position":24,"instrument":21},{"position":24,"instrument":24},{"position":24,"instrument":26},{"position":24,"instrument":27},{"position":36,"instrument":21},{"position":36,"instrument":11},{"position":48,"instrument":21},{"position":48,"instrument":11},{"position":48,"instrument":23},{"position":48,"instrument":26},{"position":48,"instrument":27},{"position":60,"instrument":24},{"position":72,"instrument":10},{"position":72,"instrument":21},{"position":72,"instrument":26},{"position":84,"instrument":25},{"position":96,"instrument":23},{"position":96,"instrument":26},{"position":108,"instrument":25},{"position":120,"instrument":12},{"position":120,"instrument":25},{"position":144,"instrument":12},{"position":144,"instrument":21},{"position":144,"instrument":23},{"position":144,"instrument":25},{"position":144,"instrument":27},{"position":156,"instrument":21},{"position":168,"instrument":21},{"position":180,"instrument":27},{"position":192,"instrument":11},{"position":192,"instrument":21},{"position":192,"instrument":24},{"position":192,"instrument":26},{"position":216,"instrument":12},{"position":216,"instrument":21},{"position":216,"instrument":24},{"position":216,"instrument":26},{"position":216,"instrument":27},{"position":240,"instrument":11},{"position":240,"instrument":23},{"position":240,"instrument":26},{"position":240,"instrument":27},{"position":252,"instrument":12},{"position":252,"instrument":24},{"position":264,"instrument":21},{"position":264,"instrument":27},{"position":276,"instrument":11},{"position":276,"instrument":25},{"position":288,"instrument":12},{"position":288,"instrument":21},{"position":288,"instrument":24},{"position":288,"instrument":25},{"position":300,"instrument":21},{"position":312,"instrument":11},{"position":312,"instrument":23},{"position":312,"instrument":26},{"position":324,"instrument":12},{"position":324,"instrument":21},{"position":324,"instrument":24},{"position":324,"instrument":25},{"position":336,"instrument":21},{"position":336,"instrument":27},{"position":360,"instrument":21},{"position":360,"instrument":10},{"position":360,"instrument":23},{"position":360,"instrument":26},{"position":360,"instrument":27},{"position":372,"instrument":21},{"position":372,"instrument":27}],"resolution":12,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],"resolution":12},"11":{"rep":[1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0],"resolution":12},"12":{"rep":[0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0],"resolution":12},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"21":{"rep":[1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,0,1,1],"resolution":12},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"23":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0],"resolution":12},"24":{"rep":[1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0],"resolution":12},"25":{"rep":[0,0,0,0,0,0,0,1,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0],"resolution":12},"26":{"rep":[1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0],"resolution":12},"27":{"rep":[0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,1,0,1,1],"resolution":12}}},{"size":384,"name":"k-2","notes":[{"position":0,"instrument":12},{"position":0,"instrument":21},{"position":0,"instrument":24},{"position":0,"instrument":25},{"position":0,"instrument":27},{"position":12,"instrument":12},{"position":12,"instrument":24},{"position":12,"instrument":25},{"position":24,"instrument":12},{"position":24,"instrument":21},{"position":24,"instrument":24},{"position":24,"instrument":25},{"position":36,"instrument":21},{"position":48,"instrument":21},{"position":48,"instrument":10},{"position":48,"instrument":23},{"position":48,"instrument":26},{"position":48,"instrument":27},{"position":72,"instrument":21},{"position":84,"instrument":21},{"position":84,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":23},{"position":96,"instrument":26},{"position":108,"instrument":21},{"position":108,"instrument":27},{"position":120,"instrument":11},{"position":120,"instrument":21},{"position":132,"instrument":10},{"position":132,"instrument":27},{"position":144,"instrument":23},{"position":144,"instrument":26},{"position":144,"instrument":27},{"position":156,"instrument":10},{"position":168,"instrument":12},{"position":168,"instrument":21},{"position":168,"instrument":24},{"position":168,"instrument":25},{"position":180,"instrument":12},{"position":180,"instrument":24},{"position":180,"instrument":25},{"position":192,"instrument":12},{"position":192,"instrument":21},{"position":192,"instrument":24},{"position":192,"instrument":25},{"position":192,"instrument":27},{"position":216,"instrument":21},{"position":216,"instrument":11},{"position":228,"instrument":11},{"position":228,"instrument":21},{"position":228,"instrument":27},{"position":240,"instrument":21},{"position":240,"instrument":23},{"position":240,"instrument":26},{"position":240,"instrument":27},{"position":252,"instrument":10},{"position":264,"instrument":21},{"position":264,"instrument":11},{"position":276,"instrument":21},{"position":276,"instrument":27},{"position":288,"instrument":11},{"position":288,"instrument":21},{"position":288,"instrument":23},{"position":288,"instrument":26},{"position":300,"instrument":11},{"position":312,"instrument":21},{"position":324,"instrument":10},{"position":336,"instrument":11},{"position":336,"instrument":23},{"position":336,"instrument":26},{"position":360,"instrument":21}],"resolution":12,"instrumentTracks":{"10":{"rep":[0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0],"resolution":12},"11":{"rep":[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,0,0,1,0,0,0],"resolution":12},"12":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"21":{"rep":[1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,0,0,1,0],"resolution":12},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"23":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":12},"24":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"25":{"rep":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":12},"26":{"rep":[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":12},"27":{"rep":[1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0],"resolution":12}}},{"size":192,"name":"lightbulb","notes":[{"position":0,"instrument":24},{"position":12,"instrument":24},{"position":24,"instrument":24},{"position":36,"instrument":24},{"position":48,"instrument":24},{"position":96,"instrument":27},{"position":144,"instrument":24},{"position":160,"instrument":24},{"position":176,"instrument":24}],"resolution":4,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"11":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"12":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"13":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"16":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"20":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"21":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"22":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"23":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"24":{"rep":[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],"resolution":4},"25":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"26":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4},"27":{"rep":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"resolution":4}}},{"size":192,"name":"break","notes":[{"position":24,"instrument":21},{"position":24,"instrument":11},{"position":24,"instrument":27},{"position":48,"instrument":21},{"position":48,"instrument":11},{"position":48,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":11},{"position":96,"instrument":27},{"position":120,"instrument":21},{"position":120,"instrument":11},{"position":120,"instrument":27},{"position":144,"instrument":24},{"position":168,"instrument":21},{"position":168,"instrument":11},{"position":168,"instrument":24},{"position":168,"instrument":27}],"resolution":24,"instrumentTracks":{"10":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"11":{"rep":[0,1,1,0,1,1,0,1],"resolution":24},"12":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"13":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"16":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"20":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"21":{"rep":[0,1,1,0,1,1,0,1],"resolution":24},"22":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"23":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"24":{"rep":[0,0,0,0,0,0,1,1],"resolution":24},"25":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"26":{"rep":[0,0,0,0,0,0,0,0],"resolution":24},"27":{"rep":[0,1,1,0,1,1,0,1],"resolution":24}}},{"size":192,"name":"squash","notes":[{"position":0,"instrument":21},{"position":0,"instrument":12},{"position":0,"instrument":24},{"position":0,"instrument":27},{"position":48,"instrument":21},{"position":48,"instrument":12},{"position":48,"instrument":24},{"position":48,"instrument":27},{"position":96,"instrument":21},{"position":96,"instrument":12},{"position":96,"instrument":24},{"position":96,"instrument":27},{"position":144,"instrument":21},{"position":144,"instrument":12},{"position":144,"instrument":24},{"position":144,"instrument":27}],"resolution":48,"instrumentTracks":{"10":{"rep":[0,0,0,0],"resolution":48},"11":{"rep":[0,0,0,0],"resolution":48},"12":{"rep":[1,1,1,1],"resolution":48},"13":{"rep":[0,0,0,0],"resolution":48},"16":{"rep":[0,0,0,0],"resolution":48},"20":{"rep":[0,0,0,0],"resolution":48},"21":{"rep":[1,1,1,1],"resolution":48},"22":{"rep":[0,0,0,0],"resolution":48},"23":{"rep":[0,0,0,0],"resolution":48},"24":{"rep":[1,1,1,1],"resolution":48},"25":{"rep":[0,0,0,0],"resolution":48},"26":{"rep":[0,0,0,0],"resolution":48},"27":{"rep":[1,1,1,1],"resolution":48}}}]}')},266:function(t,n,e){"use strict";(function(t){var i=e(7),r=e(0),o=e.n(r),a=e(280),s=e(277),u=e(137),c=e(425),l=e(94),m=e(68);function p(n){var e,r=t.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent),o=Object(m.a)();return Object(i.jsxs)(a.a,{disableBackdropTransition:!r,disableDiscovery:r,variant:o?void 0:"persistent",open:n.open,onOpen:n.onOpen,onClose:n.onClose,children:[o?null:Object(i.jsx)(l.a,{placeholder:!0}),Object(i.jsx)("div",{style:{overflow:"auto"},children:Object(i.jsx)(s.a,{children:(null!==(e=n.patterns)&&void 0!==e?e:[]).map((function(t,e){return Object(i.jsx)(u.a,{button:!0,onClick:function(){n.selectPattern&&n.selectPattern(e)},children:Object(i.jsx)(c.a,{primary:t.name})},"drawer-pattern"+e.toString())}))})})]})}n.a=o.a.memo(p)}).call(this,e(63))},267:function(t,n,e){"use strict";(function(t){var i=e(7),r=e(0),o=e.n(r),a=e(43),s=e(280),u=e(273),c=e(426),l=e(133),m=e(68),p=e(94);function h(n){var e,r=t.browser&&/iPad|iPhone|iPod/.test(navigator.userAgent),h=Object(m.a)(),f=n.pattern?{name:n.pattern.name,resolution:n.pattern.resolution,length:a.a.getPatternLength(n.pattern)}:null;return Object(i.jsxs)(s.a,{disableBackdropTransition:!r,disableDiscovery:r,className:n.className,variant:h?void 0:"persistent",anchor:n.anchor,open:n.open,onOpen:n.onOpen,onClose:n.onClose,style:{overflow:"hidden"},children:[h?null:Object(i.jsx)(p.a,{placeholder:!0}),f&&Object(i.jsx)(l.b,{onChange:null!==(e=n.onChange)&&void 0!==e?e:function(){},settings:n.settings,pattern:f}),f&&n.onSave&&Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(u.a,{onClick:function(t){n.onSave()},children:"Download"}),Object(i.jsx)(c.a,{})]}),f&&n.onShare&&Object(i.jsx)(u.a,{onClick:function(t){n.onShare()},children:"Share"})]})}n.a=o.a.memo(h)}).call(this,e(63))},300:function(t,n,e){},304:function(t,n,e){},307:function(t,n){},309:function(t,n){},422:function(t,n,e){"use strict";e.r(n);var i=e(7),r=e(0),o=e.n(r),a=e(25),s=e.n(a),u=(e(300),e(136)),c=e(31),l=e(1),m=e(2),p=e(4),h=e(3),f=e(13),d=e(10),j=e(60),g=e(273),b=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(t){var i;return Object(l.a)(this,e),(i=n.call(this,t)).hiddenFileInput=o.a.createRef(),i}return Object(m.a)(e,[{key:"onChange",value:function(t){var n=this,e=t.target.files[0],i=new FileReader;i.onload=function(t){n.props.onImport&&n.props.onImport({file:e,content:t.target.result})},i.readAsText(e)}},{key:"render",value:function(){var t=this,n=Object(d.a)({},this.props),e=(n.onImport,n.accept),r=Object(j.a)(n,["onImport","accept"]);return Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(g.a,Object(d.a)(Object(d.a)({onClick:function(n){t.hiddenFileInput.current.click()}},r),{},{children:"Import File"})),Object(i.jsx)("input",{type:"file",hidden:!0,accept:e,onChange:function(n){return t.onChange(n)},ref:this.hiddenFileInput})]})}}]),e}(o.a.Component),v=e(19),O=e(275),y=e(277),x=e(276),k=e(78),S=e(137),w=e(425),C=e(426),D=Object(O.a)((function(t){return{root:{width:"100%",height:400,minWidth:200,maxWidth:300,maxHeight:200,overflow:"auto"}}}));var T=function(t){var n=D(),e=t.data;return Object(i.jsx)("div",{className:n.root,children:Object(i.jsxs)(x.a,{children:[Object(i.jsx)(k.a,{children:"Recently viewed"}),Object(i.jsx)(C.a,{}),Object(i.jsx)(y.a,{children:Object(v.a)(e.keys()).map((function(n){return function(t){return Object(i.jsx)(S.a,{button:!0,style:t.style,onClick:t.onClick,children:Object(i.jsx)(w.a,{primary:t.name,secondary:new Date(t.date).toLocaleDateString()})},t.index)}({index:n,name:e[n].name,id:e[n].id,date:e[n].date,onClick:function(){t.onClick&&t.onClick(e[n])}})}))})]})})},R=e(479),A=e(483),P=e(481),M=e(482),I=e(480);var N=function(t){return Object(i.jsxs)(R.a,{open:t.open,onClose:t.onClose,children:[Object(i.jsx)(I.a,{id:"text-dialog-title",children:t.title}),Object(i.jsx)(P.a,{children:Object(i.jsx)(M.a,{children:t.children})}),Object(i.jsx)(A.a,{children:Object(i.jsx)(g.a,{onClick:t.onClose,variant:"contained",children:"ok"})})]})},E=(e(304),function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(){var t;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))).state={error:t.props.error},t}return Object(m.a)(e,[{key:"render",value:function(){var t=this,n=this.props.history,e=this.props.songHistory,r=Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(g.a,{variant:"contained",onClick:function(){n.push("/example")},style:{margin:"1em"},children:"Load example"}),Object(i.jsx)(b,{style:{margin:"1em"},variant:"contained",onImport:function(t){n.push({pathname:"/import",filename:t.file.name,content:t.content})},accept:".tabit,.h2song"})]}),a=this.props.classes;return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsxs)("div",{children:[Object(i.jsx)("h2",{children:"tabit"}),Object(i.jsx)("p",{children:"I read .h2songs and write tab"}),r]}),Object(i.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto"},children:e.length>0&&Object(i.jsx)(T,{data:e,onClick:function(t){console.log(t),n.push("/recent/"+t.id+"/")}})}),!!this.state.error&&Object(i.jsx)(N,{title:"Something went wrong.",open:!!this.state.error,onClose:function(){t.setState({error:null})},children:this.state.error}),Object(i.jsx)("div",{className:a.licenseBanner,children:Object(i.jsxs)("p",{children:["tabit relies on publicly available sound libraries listed at ",Object(i.jsx)("a",{href:"https://github.com/andrew-murray/tabit",children:"https://github.com/andrew-murray/tabit"})]})})]})}}]),e}(o.a.Component)),F=Object(f.a)((function(t){return{licenseBanner:{position:"absolute",bottom:0,width:"95%",textAlign:"center",backgroundColor:"#212121",zIndex:t.zIndex.drawer},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:t.palette.background.paper,border:"2px solid #000",boxShadow:t.shadows[5],padding:t.spacing(2,4,3)}}}))(E),B=e(496),L=e(498),_=e(272),z=e(495),G=e(494),K=e(54),J=e(493),W=e(15),U=e(16),q=e(249),H={"Djembe Slap":"S","Djembe Tone":"t","Djembe Bass":"O","Snare Ghost":"x","Snare Accent":"X","Shaker Ghost":"x","Shaker Accent":"X",Click:"X",Bass:"O",Tom:"O",Default:"X"};function V(t){var n,e=[],i=Object(U.a)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=Object.assign({},r);o.name=o.name.toLowerCase(),e.push(o)}}catch(a){i.e(a)}finally{i.f()}return e}function X(t,n,e,i){var r=[];if(2===t.length){var o=t[0],a=t[1],s=o.volume>a.volume||o.volume===a.volume&&o.gain>a.gain,u={};u[o.id.toString()]=s?e:i,u[a.id.toString()]=s?i:e,r.push([n,u])}else{var c,l=Object(U.a)(t);try{for(l.s();!(c=l.n()).done;){var m=c.value,p={};p[m.id.toString()]=e,r.push([n,p])}}catch(h){l.e(h)}finally{l.f()}}return r}function $(t){var n,e=new Set,i=Object(U.a)(t);try{for(i.s();!(n=i.n()).done;)for(var r=n.value,o=0,a=Object.entries(r.instrumentTracks);o<a.length;o++){var s=Object(W.a)(a[o],2),u=s[0];s[1].empty()||e.add(parseInt(u))}}catch(c){i.e(c)}finally{i.f()}return e}function Y(t,n){var e=n.toLowerCase();return e.includes("click")||e.includes("stick")?t.Click:e.includes("bass")||e.includes("kick")?t.Bass:e.includes("snare")?t["Snare Accent"]:e.includes("shaker")?t.Shaker:e.includes("tom")?t.Tom:e.includes("djembe")?e.includes("slap")?t["Djembe Slap"]:e.includes("tone")?t["Djembe Tone"]:t["Djembe Bass"]:t.Default}function Z(t,n,e){var i=[];i=(i=(i=(i=i.concat(function(t,n,e){for(var i=V(t),r=$(e),o=i.filter((function(t){return r.has(t.id)&&!t.name.includes("djembe")&&(t.name.includes("click")||t.name.includes("stick")||t.name.includes("tom")||t.name.includes("bass")||t.name.includes("kick"))})),a=Array.from(o,(function(t){return t.name.includes("click")||t.name.includes("stick")})),s=1,u=1,c=[],l=0;l<Math.floor(o.length/2);++l)if(a[2*l]!==a[2*l+1]){var m=a[2*l]?o[2*l]:o[2*l+1],p=a[2*l]?o[2*l+1]:o[2*l],h=p.name.includes("tom"),f=h?"Tom":"Bass",d="";h?(d=f+(s>=2?" "+s.toString():""),s+=1):(d=f+(u>=2?" "+u.toString():""),u+=1);var j={};j[p.id.toString()]=n[f],j[m.id.toString()]=n.Click,c.push([d,j])}if(o.length%2!==0&&!a[o.length-1]){var g=o[o.length-1],b=g.name.includes("tom"),v=b?"Tom":"Bass",O="";b?(O=v+(s>=2?" "+s.toString():""),s+=1):(O=v+(u>=2?" "+u.toString():""),u+=1);var y={};y[g.id.toString()]=n[v],c.push([O,y])}return c}(t,n,e))).concat(function(t,n){var e=V(t).filter((function(t){return t.name.includes("djembe")}));if(0===e.length)return[];if(e.length<=3){for(var i=Array.from(e,(function(t){return t.name.includes("slap")})),r=Array.from(e,(function(t){return t.name.includes("tone")})),o=Array.from(e,(function(t){return t.name.includes("bass")})),a=0;a<e.length;++a)if(1!==i[a]+r[a]+o[a])return[];for(var s={},u=0;u<e.length;++u)i[u]?s[e[u].id.toString()]=n["Djembe Slap"]:r[u]?s[e[u].id.toString()]=n["Djembe Tone"]:o[u]&&(s[e[u].id.toString()]=n["Djembe Bass"]);return[["Djembe",s]]}return[]}(t,n))).concat(function(t,n){return X(V(t).filter((function(t){return t.name.includes("snare")})),"Snare",n["Snare Accent"],n["Snare Ghost"])}(t,n))).concat(function(t,n){return X(V(t).filter((function(t){return t.name.includes("shaker")})),"Shaker",n["Shaker Accent"],n["Shaker Ghost"])}(t,n));var r,o=$(e),a=Object(U.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(o.has(s.id)){var u,c=!1,l=Object(U.a)(i);try{for(l.s();!(u=l.n()).done;){var m=u.value;s.id.toString()in m[1]&&(c=!0)}}catch(h){l.e(h)}finally{l.f()}if(!1===c){var p={};p[s.id.toString()]=Y(n,s.name),i.push([s.name,p])}}}}catch(h){a.e(h)}finally{a.f()}return i}function Q(t,n){for(var e=Array(t.length),i=0;i<t.length;++i)for(var r=t[i].id,o=0;o<n.length;++o){var a=n[o];r.toString()in a[1]&&(e[i]=o)}return e}function tt(t,n){for(var e=t.concat([n]),i=0,r=[48,24,16,12,8,6,4,3,2,1];i<r.length;i++){var o,a=r[i],s=!0,u=Object(U.a)(e);try{for(u.s();!(o=u.n()).done;){if(o.value%a!==0){s=!1;break}}}catch(c){u.e(c)}finally{u.f()}if(s)return a}throw new Error("Failed to predict base")}function nt(t,n){if(t<1||n<1)throw new Error("x<1 || y<1");for(;Math.max(t,n)%Math.min(t,n)!==0;)t>n?t%=n:n%=t;return Math.min(t,n)}var et=function(){function t(n,e){if(Object(l.a)(this,t),0===n.length)throw new Error("patternArray must not be zero length");this.rep=n,this.resolution=e}return Object(m.a)(t,[{key:"length",value:function(){return this.rep.length*this.resolution}},{key:"empty",value:function(){return 0===this.rep.reduce((function(t,n){return t+n}))}},{key:"_sumOverlapsOfArrays",value:function(t,n){for(var e=0,i=0;i<t.length;++i)t[i]&&n[i]&&e++;return e}},{key:"countOverlaps",value:function(t){if(this.resolution===t.resolution)return this._sumOverlapsOfArrays(this.rep,t.rep);var n=nt(this.resolution,t.resolution),e=this.formatResolution(n),i=t.formatResolution(n);return this._sumOverlapsOfArrays(e.rep,i.rep)}},{key:"aggregate",value:function(n){if(this.resolution===n.resolution){for(var e=Math.max(this.rep.length,n.rep.length),i=new Array(e).fill(0),r=0;r<i.length;++r)i[r]=(r<this.rep.length?this.rep[r]:0)||(r<n.rep.length?n.rep[r]:0);return new t(i,this.resolution)}var o=nt(this.resolution,n.resolution),a=this.formatResolution(o),s=n.formatResolution(o);return a.aggregate(s)}},{key:"format",value:function(n){var e=this.resolution*this.rep.length,i=this.toPoints(),r=t.representPoints(i,n,e);return r?new t(r,n):null}},{key:"toPoints",value:function(){var t,n=[],e=Object(U.a)(Array(this.rep.length).keys());try{for(e.s();!(t=e.n()).done;){var i=t.value;this.rep[i]&&n.push(this.resolution*i)}}catch(r){e.e(r)}finally{e.f()}return n}}],[{key:"representPoints",value:function(t,n,e){if(e<=0)throw new Error("size must be greater than zero");if(e<n||e%n!==0)throw new Error("resolution must be less than size and divide it evenly");var i,r=new Array(e/n).fill(0),o=Object(U.a)(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a%n!==0)throw new Error("Failed to represent point "+a.toString()+" at resolution "+n.toString());if(a>=e)throw new Error("Failed to represent point "+a.toString()+" for invalid specified size "+e.toString());r[a/n]=1}}catch(s){o.e(s)}finally{o.f()}return r}},{key:"fromPositions",value:function(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!==i&&void 0!==i?i:tt(n,e);return new t(t.representPoints(n,r,e),r)}}]),t}(),it=function t(n,e,i,r,o,a){Object(l.a)(this,t),this.title=n,this.sourceFile=e,this.instruments=i,this.instrumentIndex=r,this.instrumentMask=o,this.patterns=a};function rt(t,n,e,i){return new Promise((function(r){var o=function(t){var n,e=[],i=Object(U.a)(t);try{for(i.s();!(n=i.n()).done;){for(var r=n.value,o={},a=0,s=Object.entries(r.instrumentTracks);a<s.length;a++){var u=Object(W.a)(s[a],2),c=u[0],l=u[1];o[c]=new et(l.rep,l.resolution)}var m=Object.assign({},r);m.instrumentTracks=o,e.push(m)}}catch(p){i.e(p)}finally{i.f()}return e}(t.patterns),a=i?Z(t.instruments,H,o):t.instruments,s=t.instrumentIndex?t.instrumentIndex:function(t){var n,e=Object(U.a)(t);try{for(e.s();!(n=e.n()).done;)n.value.volume=.5}catch(i){e.e(i)}finally{e.f()}return t}(function(t,n){var e,i=$(n),r=[],o=Object(U.a)(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;i.has(a.id)&&r.push(a)}}catch(s){o.e(s)}finally{o.f()}return r}(t.instruments,o)),u=Q(s,a);r(new it(n,e,a,s,u,o))}))}var ot={LoadExample:function(){return rt(q,"kuva","kuva.example",!0)},LoadJSON:rt},at=e(46),st=e(43),ut=function(t){return{root:{whiteSpace:"pre",fontFamily:"Roboto Mono",fontSize:"0.8rem","@media (min-width:800px)":{fontSize:"1rem"}}}},ct=Object(f.a)(ut)(k.a),lt=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(t){var i;return Object(l.a)(this,e),(i=n.call(this,t)).state={},i}return Object(m.a)(e,[{key:"render",value:function(){var t=this,n=Object.values(this.props.tracks);if(0===n.length)return Object(i.jsx)(o.a.Fragment,{});var e=st.a.formatPatternString(this.props.instrument,this.props.tracks,this.props.config.restMark),r=n[0].resolution;if(this.props.config.lineResolution%this.props.config.beatResolution!==0&&e.length*r>this.props.config.lineResolution)throw new Error("This code only supports a beatResolution that divides the lineResolution");var a=st.a.chunkArray(e,this.props.config.lineResolution/r,0),s=this.props.config.lineResolution/this.props.config.beatResolution,u=this.props.config.beatResolution/r,c=a.map((function(t){return st.a.chunkArray(t,u)})),l=Object(v.a)(a.keys()),m=function(n,e,r){var a=Object(v.a)(e.keys());return Object(i.jsxs)(ct,{children:[Object(i.jsx)(ct,{variant:"subtitle1",component:"span",children:t.props.config.lineMark},"line-start-"+n),a.map((function(n){return Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(ct,{variant:"subtitle1",component:"span",className:"partNote"+(n+r).toString(),children:e[n].join("")},"span-beat-"+(n+r).toString()),Object(i.jsx)(ct,{variant:"subtitle1",component:"span",children:t.props.config.showBeatMark&&n!==a[a.length-1]?t.props.config.beatMark:""},"span-beat-marker-"+(n+r).toString())]},"fragment-beat-"+(n+r).toString())})),Object(i.jsx)(ct,{variant:"subtitle1",component:"span",children:t.props.config.lineMark},"line-end-"+n)]},"pattern-line-"+n)},p=st.a.createNumberMarker(this.props.config.numberRestMark,this.props.config.beatResolution,r,Math.min(this.props.config.lineResolution,a[0].length*r)),h=st.a.chunkArray(p,this.props.config.beatResolution/r);return Object(i.jsxs)(o.a.Fragment,{children:[this.props.config.showBeatNumbers?m("beat",h,0):"",l.map((function(t){return m(t.toString(),c[t],s*t)}))]})}}]),e}(o.a.Component),mt=Object(f.a)(ut)(lt);var pt=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(t){var i;return Object(l.a)(this,e),(i=n.call(this,t)).state={},i}return Object(m.a)(e,[{key:"render",value:function(){var t=function(t,n){var e=t?t.toLowerCase():"";return["h1","h2","h3","h4","h5","h6"].includes(e)?e:n}(this.props.headingLevel,"h4");return Object(i.jsxs)("article",{children:[Object(i.jsx)(t,{children:this.props.instrumentName}),Object(i.jsx)(mt,{instrument:this.props.instrument,tracks:this.props.tracks,config:this.props.config})]})}}]),e}(o.a.Component),ht=o.a.memo((function(t){t.classes;var n=Object(v.a)(t.instruments.keys());t.config.beatResolution;return Object(i.jsx)("div",{style:{margin:"auto"},children:n.map((function(n){return Object(i.jsx)(pt,{instrumentName:t.instruments[n][0],instrument:t.instruments[n][1],tracks:t.tracks,config:t.config},"part-"+n.toString())}))})})),ft=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(t){var i;return Object(l.a)(this,e),(i=n.call(this,t)).ref=o.a.createRef(),i}return Object(m.a)(e,[{key:"calculateBeat",value:function(t,n){return void 0!==n&&null!==n?Math.floor(n/t.beatResolution):null}},{key:"changePatternTime",value:function(t,n,e){if(n!==t||e){if(null!==t){var i,r=this.ref.current.getElementsByClassName("partNote"+t.toString()),o=Object(U.a)(r);try{for(o.s();!(i=o.n()).done;){i.value.classList.remove("activeNote")}}catch(c){o.e(c)}finally{o.f()}}if(null!==n){var a,s=this.ref.current.getElementsByClassName("partNote"+n.toString()),u=Object(U.a)(s);try{for(u.s();!(a=u.n()).done;){a.value.classList.add("activeNote")}}catch(c){u.e(c)}finally{u.f()}}}}},{key:"componentDidUpdate",value:function(t,n,e){if(t.instruments!==this.props.instruments||t.tracks!==this.props.tracks||t.config!==this.props.config||t.classes!==this.props.classes)return this.changePatternTime(this.calculateBeat(t.config,t.patternTime),this.calculateBeat(this.props.config,this.props.patternTime),!0),!0}},{key:"shouldComponentUpdate",value:function(t,n){return t.instruments!==this.props.instruments||t.tracks!==this.props.tracks||t.config!==this.props.config||t.classes!==this.props.classes||t.patternTime!==this.props.patternTime&&(this.changePatternTime(this.calculateBeat(this.props.config,this.props.patternTime),this.calculateBeat(t.config,t.patternTime),!0),!1)}},{key:"render",value:function(){return Object(i.jsx)("div",{className:this.props.classes.root,ref:this.ref,children:Object(i.jsx)(ht,{instruments:this.props.instruments,tracks:this.props.tracks,config:this.props.config})})}}]),e}(o.a.Component),dt=Object(f.a)((function(t){return{root:{"margin-bottom":t.spacing(2),fontFamily:"Roboto Mono",textAlign:"left",whiteSpace:"pre",margin:"auto","& .activeNote":{color:t.palette.secondary.main}}}}))(ft),jt=e(97),gt=e(250),bt=e.n(gt),vt=e(251),Ot=e.n(vt),yt=e(499),xt=e(484);function kt(t){return Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsxs)("div",{children:[Object(i.jsx)(jt.a,{"aria-label":"play",onClick:function(){t.onPlay&&t.onPlay()},children:Object(i.jsx)(bt.a,{style:{color:"#4cbb17"}})}),Object(i.jsx)(jt.a,{"aria-label":"stop",onClick:function(){t.onStop&&t.onStop()},children:Object(i.jsx)(Ot.a,{style:{color:"#ff0800"}})})]}),Object(i.jsxs)(xt.a,{container:!0,children:[Object(i.jsx)(xt.a,{item:!0,xs:4}),Object(i.jsx)(xt.a,{item:!0,xs:4,children:Object(i.jsx)(yt.a,{defaultValue:100,min:60,step:1,max:180,onChange:function(n,e){t.onTempoChange&&t.onTempoChange(e)},valueLabelDisplay:"auto"})}),Object(i.jsx)(xt.a,{item:!0,xs:4})]})]})}var St=o.a.memo(kt),wt=e(133),Ct=e(430),Dt=e(497),Tt=e(489),Rt=e(491),At=e(487),Pt=e(492),Mt=e(490),It=e(488),Nt=e(259),Et=e.n(Nt),Ft=e(260),Bt=e.n(Ft),Lt=e(258),_t=e.n(Lt),zt=e(181),Gt=e.n(zt),Kt=e(257),Jt=e.n(Kt),Wt=e(500),Ut=e(38),qt=e(253),Ht=e.n(qt),Vt=e(254),Xt=e.n(Vt),$t=e(255),Yt=e.n($t),Zt=e(256),Qt=e.n(Zt),tn=e(252),nn=e.n(tn),en=e(68),rn=Object(O.a)((function(t){return{root:{display:"flex"}}})),on=Object(f.a)({root:{marginLeft:0,marginRight:0}})(Ct.a),an=Object(f.a)({root:{padding:2}})(jt.a),sn=Object(f.a)((function(t){return{root:{borderBottom:"none",textAlign:"center",paddingBottom:t.spacing(0)}}}))(At.a),un=Object(f.a)((function(t){return{root:{textAlign:"center"}}}))(At.a);function cn(t){var n=o.a.useState(!1),e=Object(W.a)(n,2),r=e[0],a=e[1],s=o.a.useState(100),u=Object(W.a)(s,2),c=u[0],l=u[1],m=o.a.useState(t.muted),p=Object(W.a)(m,2),h=p[0],f=p[1],d=o.a.useRef(null),j=t.height?t.height/3:24,g={height:3*j,position:"absolute",top:-j},b=Object.assign(r?{}:{visibility:"hidden",paddingLeft:"0px"},g),v=r?{visibility:"hidden"}:{},O=Object(en.a)();return Object(i.jsx)(nn.a,{time:.5,onClickNHold:O?function(t,n){r||a(!0)}:function(t,n){r||a(!0),d&&d.current.dispatchEvent(n.nativeEvent)},onEnd:O?null:function(t){a(!1)},children:Object(i.jsxs)(an,{disableRipple:!0,disableFocusRipple:!0,onClick:function(){f(!h),t.onMuteEvent(!h)},children:[Object(i.jsx)("div",{style:b,children:Object(i.jsx)(yt.a,{defaultValue:100,orientation:"vertical","aria-labelledby":"vertical-slider",onChange:function(n,e){O&&a(!1),function(n,e){l(e),t.onChange&&t.onChange(e)}(0,e)},ref:d})}),Object(i.jsx)("div",{style:v,children:h?Object(i.jsx)(Ht.a,{fontSize:"small"}):c<10?Object(i.jsx)(Xt.a,{fontSize:"small"}):c<50?Object(i.jsx)(Yt.a,{fontSize:"small"}):Object(i.jsx)(Qt.a,{fontSize:"small"})})]})})}var ln=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(t){var i;return Object(l.a)(this,e),(i=n.call(this,t)).state={currentSymbol:null},i}return Object(m.a)(e,[{key:"render",value:function(){var t,n=this,e=function(t){n.setState({currentSymbol:null}),n.props.onCancel&&n.props.onCancel()},r=function(t){null!==n.state.currentSymbol&&1===n.state.currentSymbol.length?n.props.onChange&&(n.props.onChange(n.state.currentSymbol),n.setState({currentSymbol:null})):alert('You selected an invalid symbol "'+n.state.currentSymbol+'".\nSymbols must be precisely 1 character.')};return Object(i.jsxs)(R.a,{open:this.props.open,onClose:e,"aria-labelledby":"form-dialog-title",children:[Object(i.jsx)(I.a,{id:"form-dialog-title"}),Object(i.jsxs)(P.a,{children:[Object(i.jsx)(M.a,{children:"Enter notation symbol"}),Object(i.jsx)(Wt.a,{autoFocus:!0,margin:"dense",id:"name",fullWidth:!0,value:null!==(t=this.state.currentSymbol)&&void 0!==t?t:this.props.value,onChange:function(t){n.setState({currentSymbol:t.target.value})},onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),r())}})]}),Object(i.jsxs)(A.a,{children:[Object(i.jsx)(g.a,{onClick:e,color:"primary",children:"Cancel"}),Object(i.jsx)(g.a,{onClick:r,color:"primary",children:"Confirm"})]})]})}}]),e}(o.a.Component),mn=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(t){var i;return Object(l.a)(this,e),(i=n.call(this,t)).state={currentName:null},i}return Object(m.a)(e,[{key:"render",value:function(){var t,n=this,e=function(){n.props.onCancel&&n.props.onCancel(),n.setState({currentName:null})},r=function(){null!==n.state.currentName?n.state.currentName.trim().length>0?(n.props.onChange&&n.props.onChange(n.state.currentName),n.setState({currentName:null})):alert('You selected an invalid instrument name "'+n.state.currentName+'".\nMust be non-empty.'):e()};return Object(i.jsxs)(R.a,{open:this.props.open,onClose:e,"aria-labelledby":"form-dialog-title",children:[Object(i.jsx)(I.a,{id:"form-dialog-title"}),Object(i.jsxs)(P.a,{children:[Object(i.jsx)(M.a,{children:"Enter instrument name"}),Object(i.jsx)(Wt.a,{margin:"dense",id:"name",fullWidth:!0,value:null!==(t=this.state.currentName)&&void 0!==t?t:this.props.value,onChange:function(t){n.setState({currentName:t.target.value})},onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),r())},autoFocus:!0})]}),Object(i.jsxs)(A.a,{children:[Object(i.jsx)(g.a,{onClick:e,color:"primary",children:"Cancel"}),Object(i.jsx)(g.a,{onClick:r,color:"primary",children:"Confirm"})]})]})}}]),e}(o.a.Component);function pn(t){var n=rn(),e=o.a.useState(!1),r=Object(W.a)(e,2),a=r[0],s=r[1],u=function(n,e){return Object(i.jsx)(At.a,{align:"center",children:Object(i.jsx)(on,{control:Object(i.jsx)(Dt.a,{checked:t.instrumentMask[n]===e,onChange:function(i){!function(n,e,i){var r=t.instrumentIndex[n].id,o=t.instruments.findIndex((function(t){return r in t[1]})),a=e;if(o!==a){var s=t.instruments[o],u=["",{}];if(null!=s){u[0]=s[0];for(var c=0,l=Object.keys(s[1]);c<l.length;c++){var m=l[c];m!==r.toString()&&(u[1][m]=s[1][m])}}var p=[t.instruments[a][0],Object.assign({},t.instruments[a][1])];p[1][r.toString()]=null!=s?s[1][r]:"X";for(var h=[],f=0;f<t.instruments.length;++f)f===o?h.push(u):f===a?h.push(p):h.push(t.instruments[f]);t.onChange(h)}}(n,e)},name:n+","+e.toString()})})},"instrumentPanel-cell-"+e.toString()+"-"+n.toString())},c=function(n){return Object(i.jsxs)(It.a,{children:[Object(i.jsxs)(At.a,{component:"th",scope:"row",children:[Object(i.jsx)(k.a,{children:t.instruments[n][0]}),Object(i.jsx)(an,{onClick:function(e){!function(n){t.onEditRow&&t.onEditRow(n)}(n)},children:Object(i.jsx)(Gt.a,{fontSize:"small"})}),Object(i.jsx)(an,{onClick:function(e){!function(n){t.onRemoveRow&&t.onRemoveRow(n)}(n)},children:Object(i.jsx)(Jt.a,{fontSize:"small"})})]},"instrumentPanel-row-"+n.toString()+"-name"),Object(v.a)(Array(t.instrumentMask.length).keys()).map((function(t){return u(t,n)}))]},"instrumentPanel-row-"+n.toString())};return Object(i.jsxs)(Tt.a,{className:n.table,"aria-label":"simple table",children:[Object(i.jsxs)(Mt.a,{children:[Object(i.jsxs)(It.a,{children:[Object(i.jsx)(sn,{children:" Instrument "},"instrumentPanel-row-instrument"),Object(v.a)(Array(t.instrumentIndex.length).keys()).map((function(n){return Object(i.jsx)(sn,{children:Object(i.jsx)(k.a,{children:t.instrumentIndex[n].name})},"instrumentPanel-row-header-cell-"+n.toString())}))]},"instrumentPanel-row-header"),Object(i.jsxs)(It.a,{children:[Object(i.jsx)(un,{children:Object(i.jsx)(jt.a,{"aria-label":"Show Instrument Matcher",size:"small",onClick:function(){return s(!a)},children:a?Object(i.jsx)(Et.a,{}):Object(i.jsx)(Bt.a,{})})},"instrumentPanel-row-instrument"),Object(v.a)(Array(t.instrumentIndex.length).keys()).map((function(n){return Object(i.jsx)(un,{children:Object(i.jsxs)(xt.a,{container:!0,children:[Object(i.jsx)(xt.a,{item:!0,xs:6,children:Object(i.jsx)(an,{onClick:function(e){!function(n){t.onEditColumn&&t.onEditColumn(n)}(n)},children:Object(i.jsx)(Gt.a,{fontSize:"small"})})}),Object(i.jsx)(xt.a,{item:!0,xs:6,children:Object(i.jsx)(cn,{muted:t.instrumentIndex[n].muted,onChange:function(e){t.onVolumeEvent({instrument:n,volume:e/100})},onMuteEvent:function(e){t.onVolumeEvent({instrument:n,muted:e})}})})]})},"instrumentPanel-row-controls-cell-"+n.toString())}))]},"instrumentPanel-row-controls")]}),Object(i.jsxs)(Rt.a,{children:[a&&Object(v.a)(Array(t.instruments.length).keys()).map((function(t){return c(t)})),a&&Object(i.jsx)(It.a,{children:Object(i.jsx)(At.a,{component:"th",scope:"row",children:Object(i.jsx)(jt.a,{onClick:function(n){t.onAddRow&&t.onAddRow()},"aria-label":"add",children:Object(i.jsx)(_t.a,{})})},"instrumentPanel-row-edit-cell")},"instrumentPanel-row-edit")]})]})}function hn(t){var n,e=Object(Ut.a)(),r=o.a.useState(null),a=Object(W.a)(r,2),s=a[0],u=a[1],c=o.a.useState(null),l=Object(W.a)(c,2),m=l[0],p=l[1],h=function(n){if(null!==n){var e=t.instrumentIndex[s].id,i=t.instruments.findIndex((function(t){return e in t[1]})),r=Array.from(t.instruments);r[i][1][e]=n,t.onChange(r)}u(null)};return Object(i.jsxs)("div",{style:{paddingBottom:e.spacing(1)},children:[Object(i.jsx)(mn,{open:null!==m,onCancel:function(){p(null)},onChange:function(n){!function(n){if(m===t.instruments.length){var e=[n,{}],i=Array.from(t.instruments);i.push(e),t.onChange(i)}else{var r=Array.from(t.instruments);r[m][0]=n,t.onChange(r)}p(null)}(n)},value:null!==m?(n=m,n<t.instruments.length?t.instruments[n][0]:""):""}),Object(i.jsx)(ln,{open:null!==s,onCancel:function(){h(null)},onChange:function(t){h(t)},value:null!==s?function(n){var e=t.instrumentIndex[s].id,i=t.instruments.findIndex((function(t){return e in t[1]}));return t.instruments[i][1][e]}():""}),Object(i.jsx)(Pt.a,{component:x.a,style:{border:"2px solid rgba(255, 255, 255, 0.5)",outline:"none",borderRadius:"8px"},children:Object(i.jsx)(pn,{instrumentIndex:t.instrumentIndex,instrumentMask:t.instrumentMask,instruments:t.instruments,onEditColumn:function(t){u(t)},onEditRow:function(t){p(t)},onAddRow:function(){p(t.instruments.length)},onRemoveRow:function(n){!function(n){var e=t.instruments.slice(0,n).concat(t.instruments.slice(n+1));t.onChange(e)}(n)},onVolumeEvent:t.onVolumeEvent,onChange:t.onChange})})]})}var fn=o.a.memo(hn),dn=e(94),jn=e(266),gn=function(){function t(){Object(l.a)(this,t)}return Object(m.a)(t,null,[{key:"createWebContext",value:function(){return new(window.AudioContext||window.webkitAudioContext||Object)}},{key:"determineMinResolution",value:function(t,n){for(var e=48,i=function(){var n=Object(W.a)(o[r],2),i=n[0],a=n[1];t.filter((function(t){return t.id.toString()===i})).length>0&&!a.empty()&&(e=Math.min(e,a.resolution))},r=0,o=Object.entries(n);r<o.length;r++)i();return e}},{key:"determineTrackLength",value:function(t,n){for(var e=48,i=function(){var n=Object(W.a)(o[r],2),i=n[0],a=n[1];t.filter((function(t){return t.id.toString()===i})).length>0&&!a.empty()&&(e=Math.max(e,a.length()))},r=0,o=Object.entries(n);r<o.length;r++)i();return e}},{key:"peakAmplitude",value:function(t){for(var n=0,e=0;e<t.numberOfChannels;e++)for(var i=t.getChannelData(e),r=0;r<i.length;++r)n=Math.max(Math.abs(i[r]),n);return n}},{key:"normalizeAudioBuffer",value:function(n){var e=t.peakAmplitude(n);if(e>1)for(var i=0;i<n.numberOfChannels;i++)for(var r=n.getChannelData(i),o=0;o<r.length;++o)r[o]=r[o]/e;return n}},{key:"createMasterTrack",value:function(n,e,i,r,o){for(var a=t.determineTrackLength(i,e),s=44100*(a*(60/o*1e3/48))/1e3,u=Math.floor(s),c=Math.floor(u/a),l=n.createBuffer(2,u,44100),m=0;m<l.numberOfChannels;m++)for(var p=l.getChannelData(m),h=function(){var t=Object(W.a)(d[f],2),n=t[0],e=t[1],o=i.filter((function(t){return t.id.toString()===n}));if(o.length>0&&o[0].id in r&&!e.empty()){var a,s=r[o[0].id],u=2===s.numberOfChannels?s.getChannelData(m):s.getChannelData(0),l=e.toPoints(),h=Object(U.a)(l);try{for(h.s();!(a=h.n()).done;)for(var j=a.value*c,g=0;g<s.length;++g)p[j+g]=p[j+g]+u[g]}catch(b){h.e(b)}finally{h.f()}}},f=0,d=Object.entries(e);f<d.length;f++)h();return t.normalizeAudioBuffer(l)}},{key:"createAudioSource",value:function(t,n,e){var i=t.createBufferSource();return i.buffer=n,i.loop=!0,null!==e&&(i.playbackRate.value=e/100),i.connect(t.destination),i}},{key:"createOneShotAudioSource",value:function(t,n,e){var i=t.createBufferSource();return i.buffer=n,i.loop=!1,null!==e&&(i.playbackRate.value=e/100),i.connect(t.destination),i}}]),t}(),bn=e(24),vn=.12,On=function(t){vn=t},yn=["circAfrique v4","DeathMetal","The Black Pearl 1.0","GMRockKit","TR808EmulationKit"],xn=function(t){return Math.pow(t,2.5)},kn=function(){function t(n,e,i,r,o){if(Object(l.a)(this,t),o&&bn.f.latencyHint!==o){var a=new bn.a({latencyHint:o});bn.i(a)}On("playback"==o?.35:.12),this.samples={},this.currentPattern=null,this.gain=new bn.b,this.gain.toDestination(),this.onPatternTimeChange=r,bn.h().bpm.value=i,bn.h().loop=!0,this.sampleCount=0,this.expectedSampleCount=0,this.patternDetails={};var s,u=[],c=Object(U.a)(e);try{for(c.s();!(s=c.n()).done;){var m=s.value;this.patternDetails[m.name]={resolution:gn.determineMinResolution(n,m.instrumentTracks),length:gn.determineTrackLength(n,m.instrumentTracks),name:m.name,tracks:m.instrumentTracks,pattern:m},this.populateSamples(n,m.instrumentTracks,u)}}catch(b){c.e(b)}finally{c.f()}if(this.currentPatternName=null,this.instrumentIndex=n,u.length>0){var p,h="Failed to load samples for instruments:\n",f=function(t){var n,e=[],i=Object(U.a)(t);try{for(i.s();!(n=i.n()).done;){var r,o=Object(W.a)(n.value,2),a=o[0],s=o[1],u=!0,c=Object(U.a)(e);try{for(c.s();!(r=c.n()).done;){var l=Object(W.a)(r.value,2),m=l[0],p=l[1];if(a===m&&s===p){u=!1;break}}}catch(b){c.e(b)}finally{c.f()}u&&e.push([a,s])}}catch(b){i.e(b)}finally{i.f()}return e.sort(),e}(u),d=Object(U.a)(f);try{for(d.s();!(p=d.n()).done;){var j=Object(W.a)(p.value,2),g=j[0];h+="    -"+j[1],""!==g&&(h+=" ("+g+")"),h+="\n"}}catch(b){d.e(b)}finally{d.f()}h+="This is typically because they belong to commercial sound libraries. tabit's supported drumkits are\n"+yn.join(", ")+".",alert(h)}}return Object(m.a)(t,[{key:"teardown",value:function(){this.stop(),bn.h().cancel()}},{key:"samplesReady",value:function(){return this.sampleCount===this.expectedSampleCount}},{key:"populateSamples",value:function(t,n,e){var i=this;this.sampleCount=0;for(var r=function(){var n=Object(W.a)(a[o],1)[0],r=t.filter((function(t){return t.id.toString()===n}));if(r.length>0){var s=r[0],u=xn(Math.min(Math.max(0,s.volume),1));if(s.id in i.samples)return"continue";if("drumkit"in s&&"filename"in s&&yn.includes(s.drumkit)){var c=s.filename.replace(".flac",".wav"),l=new bn.c("/tabit/wav/"+s.drumkit+"/"+c,(function(){i.sampleCount++}));l.mute=s.muted,l.name=s.name;var m=new bn.b(u,"normalRange");l.connect(m),m.connect(i.gain),i.samples[s.id]={player:l,gain:m},i.expectedSampleCount++}else if("drumkit"in s){var p=function(t,n){var e=n.toLowerCase();return e.includes("kick")?"The Black Pearl 1.0/PearlKick-Hard.wav":e.includes("stick")?"DeathMetal/16297_ltibbits_sticks_low_pitch.wav":e.includes("tom")?"TR808EmulationKit/808_Tom_Mid.wav":e.includes("clap")?"TR808EmulationKit/808_Clap.wav":e.includes("snare")?"GMRockKit/Snare-Soft.wav":e.includes("cowbell")?"GMRockKit/Cowbell-Softest.wav":null}(s.drumkit,s.name);if(null!==p){var h=new bn.c("/tabit/wav/"+p,(function(){i.sampleCount++}));h.mute=s.muted,h.name=s.name;var f=new bn.b(u,"normalRange");h.connect(f),f.connect(i.gain),i.samples[s.id]={player:h,gain:f},i.expectedSampleCount++}else e.push([s.drumkit,s.name])}else e.push(["",s.name])}},o=0,a=Object.entries(n);o<a.length;o++)r()}},{key:"createSequenceForPattern",value:function(t,n){var e=this.patternDetails[n.name].resolution,i=this.patternDetails[n.name].length,r=function(t,n){var e=n.samplesReady();return function(i,r){if(e||(e=n.samplesReady())){for(var o=r%(t.length/t.resolution),a=0,s=Object.entries(t.tracks);a<s.length;a++){var u=Object(W.a)(s[a],2),c=u[0];if(u[1].rep[o]){var l=n.samples[c];void 0!==l&&(l.player.stop(i+vn),l.player.start(i+vn))}}n.onPatternTimeChange&&bn.g().schedule((function(){if("started"===bn.h().state){var e=o*t.resolution%t.length;n.onPatternTimeChange(e)}}),i+vn)}}}(this.patternDetails[n.name],this),o=new bn.d(r,Object(v.a)(Array(i/e).keys()),bn.e("4n")*(e/48));return o._part.mute=!0,o.start(0),o}},{key:"createSequences",value:function(t,n){var e,i={},r=Object(U.a)(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;i[o.name]=this.createSequenceForPattern(t,o)}}catch(a){r.e(a)}finally{r.f()}return i}},{key:"setActivePattern",value:function(t){var n=this,e=null!==this.currentPatternName?this.currentPatternName:null,i=this.patternDetails[t].length,r=null!==e?this.patternDetails[e]:null,o=bn.h().loopEnd-(bn.h().toSeconds(bn.h().position)-vn),a=null!==e&&"started"===bn.h().state&&o>0&&o<bn.h().toSeconds(bn.e("8n")),s=this.createSequenceForPattern(this.instrumentIndex,this.patternDetails[t].pattern),u=function(o){null!==e&&(n.sequence._part.mute=!0),null!==e&&r===i||bn.h().setLoopPoints(0,bn.e("4n")*(i/48)),n.sequence=s,n.sequence._part.mute=!1,n.currentPatternName=t};a?bn.h().scheduleOnce(u,bn.e("0")):u()}},{key:"play",value:function(){bn.j().then((function(){bn.h().start()}))}},{key:"stop",value:function(){var t=this;"started"===bn.h().state&&(bn.h().stop(),this.onPatternTimeChange&&bn.g().schedule((function(){t.onPatternTimeChange(null)}),bn.h().now()))}},{key:"setMutedForInstrument",value:function(t,n){this.samples[t].player.mute=n}},{key:"setVolumeForInstrument",value:function(t,n){this.samples[t].gain.set({gain:xn(n)})}},{key:"setTempo",value:function(t){bn.h().bpm.value=t}}]),t}(),Sn=e(267),wn=e(268),Cn=e.n(wn),Dn=e(269),Tn=e.n(Dn);function Rn(t){return Object(i.jsx)(R.a,{open:t.open,onClose:t.onClose,"aria-labelledby":"sharing-dialog","aria-describedby":"sharing-dialog",children:Object(i.jsxs)(P.a,{children:[Object(i.jsx)(M.a,{children:"Your song is available at"}),Object(i.jsxs)(M.a,{children:[t.url,Object(i.jsx)(jt.a,{onClick:function(n){Cn()(t.url)},children:Object(i.jsx)(Tn.a,{})})]}),Object(i.jsx)(A.a,{children:Object(i.jsx)(g.a,{onClick:t.onClose,children:"Close"})})]})})}var An=o.a.memo(Rn),Pn=e(279),Mn=e(270),In=function(t){return Array.from(t,(function(t){return st.a.guessPerPatternSettings(t.instrumentTracks)}))},Nn=Object(Mn.a)((function(t,n){var e=Object.assign({},t);return n&&(e=Object.assign(e,n)),e})),En=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(){var t;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))).state={selectedPattern:0,patternSettings:t.props.songData?In(t.props.songData.patterns):null,formatSettings:Object.assign({},wt.a),songData:Object.assign({},t.props.songData),settingsOpen:!1,patternsOpen:!0,sharingDialogOpen:!1,patternTime:null},t.changeInstruments=function(n){var e=Object.assign({},t.state.songData);e.instruments=n,e.instrumentMask=Q(t.state.songData.instrumentIndex,n),t.setState({songData:e})},t.sendVolumeEvent=function(n){if("volume"in n){var e=t.state.songData.instrumentIndex[n.instrument].id;t.audio&&t.audio.setVolumeForInstrument(e,n.volume)}else if("muted"in n){var i=t.state.songData.instrumentIndex[n.instrument].id;t.audio&&t.audio.setMutedForInstrument(i,n.muted)}},t.handleSettingsChange=function(n){if(n.local){t.setState((function(t){return{patternSettings:t.patternSettings.map((function(e,i){return i!==t.selectedPattern?e:Object.assign({},t.patternSettings[t.selectedPattern],Object(at.a)({},n.key,n.value))}))}}))}else{var e=Object.assign({},t.state.formatSettings,Object(at.a)({},n.key,n.value));t.setState({formatSettings:e})}},t.handlePatternsToggle=function(n){t.setState({patternsOpen:!t.state.patternsOpen})},t.handleSettingsToggle=function(n){t.setState({settingsOpen:!t.state.settingsOpen})},t.selectPattern=function(n){t.audio&&t.audio.setActivePattern(t.state.songData.patterns[n].name),t.setState({selectedPattern:n})},t.onShare=function(){K.e(t.getExportState()).then((function(n){var e=window.origin+"/tabit/song/"+n;t.setState({permanentUrl:e,sharingDialogOpen:!0})})).catch((function(t){alert("Couldn't contact external server at this time.")}))},t.onDownload=function(){K.b(t.getExportState())},t.onSave=function(){K.f(t.getExportState())},t.handleSettingsToggle=function(n){t.setState({settingsOpen:!t.state.settingsOpen})},t.handlePatternsToggle=function(n){t.setState({patternsOpen:!t.state.patternsOpen})},t.closeSharingDialog=function(){t.setState({sharingDialogOpen:!1})},t.onPlay=function(){t.audio&&t.audio.play()},t.onStop=function(){t.audio&&t.audio.stop()},t.onSetTempo=function(n){t.audio&&t.audio.setTempo(n)},t}return Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=this,n=Object(en.a)()?"playback":null;this.audio=new kn(this.state.songData.instrumentIndex,this.state.songData.patterns,100,(function(n){var e=null===t.state.patternTime!=(null===n),i=t.state.patternSettings[t.state.selectedPattern].beatResolution,r=Math.floor(t.state.patternTime/i),o=Math.floor(n/i);(e||r!==o)&&t.setState({patternTime:n})}),n),this.audio.setActivePattern(this.state.songData.patterns[this.state.selectedPattern].name),window.addEventListener("beforeunload",this.onSave)}},{key:"componentWillUnmount",value:function(){this.onSave(),window.removeEventListener("beforeunload",this.onSave),this.audio&&(this.audio.teardown(),delete this.audio)}},{key:"getExportState",value:function(){return{instruments:this.state.songData.instruments,instrumentIndex:this.state.songData.instrumentIndex,patterns:this.state.songData.patterns,songName:this.state.songData.title,formatSettings:this.state.formatSettings,patternSettings:this.state.patternSettings,version:"1.1.0"}}},{key:"render",value:function(){var t=this.state.songData.patterns[this.state.selectedPattern],n=this.state.songData&&this.state.patternSettings?this.state.patternSettings[this.state.selectedPattern]:null,e=Nn(this.state.formatSettings,n),r=Object(en.a)()?12:8;return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)(Pn.a,{variant:"dense"}),Object(i.jsx)(dn.a,{title:this.state.songData.title,settingsToggle:this.handleSettingsToggle,patternsToggle:this.handlePatternsToggle,onDownload:this.onDownload,onShare:this.onShare}),Object(i.jsx)("div",{style:{display:"flex",flexGrow:1}}),Object(i.jsx)(dt,{instruments:this.state.songData.instruments,tracks:t.instrumentTracks,config:e,patternTime:this.state.patternTime}),Object(i.jsx)("div",{style:{display:"flex",flexGrow:1}}),Object(i.jsx)(St,{onPlay:this.onPlay,onStop:this.onStop,onTempoChange:this.onSetTempo}),Object(i.jsxs)(xt.a,{container:!0,children:[r<12?Object(i.jsx)(xt.a,{item:!0,xs:(12-r)/2}):null,Object(i.jsx)(xt.a,{item:!0,xs:r,children:Object(i.jsx)(fn,{instruments:this.state.songData.instruments,instrumentIndex:this.state.songData.instrumentIndex,instrumentMask:this.state.songData.instrumentMask,onChange:this.changeInstruments,onVolumeEvent:this.sendVolumeEvent})}),r<12?Object(i.jsx)(xt.a,{item:!0,xs:(12-r)/2}):null]}),Object(i.jsx)(jn.a,{open:this.state.patternsOpen,onOpen:this.handlePatternsToggle,onClose:this.handlePatternsToggle,patterns:this.state.songData.patterns,selectPattern:this.selectPattern}),Object(i.jsx)(Sn.a,{open:this.state.settingsOpen,onOpen:this.handleSettingsToggle,onClose:this.handleSettingsToggle,anchor:"right",pattern:t,settings:e,onChange:this.handleSettingsChange}),Object(i.jsx)(An,{open:this.state.sharingDialogOpen,onClose:this.closeSharingDialog,url:this.state.permanentUrl})]})}}]),e}(o.a.Component),Fn=e(132),Bn=e.n(Fn),Ln=e(9),_n=e.n(Ln),zn=e(18),Gn=e(271),Kn=e.n(Gn);function Jn(t,n){return tt(Array.from(t.notes,(function(t){return t.position})),n)}function Wn(t){var n=t.song.instrumentList[0].instrument,e=Array.from(n,(function(t){var n=t.instrumentComponent[0],e={id:parseInt(t.id),name:t.name[0],volume:parseFloat(t.volume),muted:"true"===t.isMuted[0],gain:parseFloat(t.gain),drumkit:t.drumkit[0]};return"layer"in n&&(e.filename=n.layer[0].filename[0]),e})),i=t.song.patternList[0].pattern,r=Array.from(i,(function(t){var n=t.noteList[0].note,e=parseInt(t.size),i=[];return n&&(i=(i=Array.from(n,(function(t){return{position:parseInt(t.position),instrument:parseInt(t.instrument)}}))).filter((function(t){return t.position<e}))),{size:e,name:t.name[0],notes:i}})),o=Array.from(r,(function(t){var n,i=Jn(t,t.size),r={},o=Object(U.a)(e);try{var a=function(){var e=n.value,o=t.notes.filter((function(t){return t.instrument===e.id})),a=Array.from(o,(function(t){return t.position}));r[e.id.toString()]=et.fromPositions(a,t.size,i)};for(o.s();!(n=o.n()).done;)a()}catch(s){o.e(s)}finally{o.f()}return t.resolution=i,t.instrumentTracks=r,t}));if(t.song.virtualPatternList){var a=t.song.virtualPatternList[0].pattern;if(a){for(var s={},u=0,c=Array.from(a);u<c.length;u++){var l=c[u],m=l.name[0],p=Array.from(l.virtual);s[m]=new Set(p)}for(var h=0;h<20;++h){for(var f={},d=!1,j=0,g=Object.entries(s);j<g.length;j++){var b,O=Object(W.a)(g[j],2),y=O[0],x=O[1],k=new Set(x),S=Object(U.a)(k);try{for(S.s();!(b=S.n()).done;){var w=b.value;w in s&&(k=new Set([].concat(Object(v.a)(k),Object(v.a)(s[w]))))}}catch(R){S.e(R)}finally{S.f()}d=d||k.size!==x.size,f[y]=k}if(!d)break;if(20===h)throw new Error("Reached max virtual_pattern recursion depth.");s=f}for(var C=function(){var t,n=Object(W.a)(T[D],2),e=n[0],i=n[1],r=o.find((function(t){return t.name===e})),a=Object(U.a)(i);try{var s=function(){for(var n=t.value,e=o.find((function(t){return t.name===n})),i=0,a=Object.entries(e.instrumentTracks);i<a.length;i++){var s=Object(W.a)(a[i],2),u=s[0],c=s[1];if(u in r.instrumentTracks){var l=r.instrumentTracks[u].aggregate(c);l.rep.length=r.size/l.resolution,r.instrumentTracks[u]=l}else{var m=c.format(r.resolution);m.length=r.size/r.resolution,r.instrumentTracks[u]=m}}};for(a.s();!(t=a.n()).done;)s()}catch(R){a.e(R)}finally{a.f()}var u=Jn(r,r.size);r.resolution=u;for(var c=0,l=Object.entries(r.instrumentTracks);c<l.length;c++){var m=Object(W.a)(l[c],2),p=m[0],h=m[1];r[p]=h.format(u)}},D=0,T=Object.entries(s);D<T.length;D++)C()}}return{instruments:e,patterns:o}}function Un(){return(Un=Object(zn.a)(_n.a.mark((function t(n){var e;return _n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Kn.a.Parser,t.abrupt("return",e.parseStringPromise(n).then(Wn));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var qn={parseHydrogenPromise:function(t){return Un.apply(this,arguments)}};function Hn(t){return Object(i.jsx)("div",{className:"App",children:Object(i.jsxs)("div",{children:[Object(i.jsx)(J.a,{color:"secondary"}),Object(i.jsx)(k.a,{children:" Loading song... "})]})})}var Vn=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(){var t;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))).state={songData:null},t}return Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=this;ot.LoadExample().then((function(n){t.setState({songData:n})})).catch((function(n){t.props.history.push({pathname:"/",error:"Failed to load example data. This likely represents a bug - please raise an issue in github!"})}))}},{key:"render",value:function(){return this.state.songData?Object(i.jsx)(En,{songData:this.state.songData},this.state.songData):Object(i.jsx)(Hn,{})}}]),e}(o.a.Component);function Xn(t){return null===t||void 0===t?null:t.includes(".")?t.split(".").slice(0,-1).join("."):t}var $n=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(){var t;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))).state={songData:null},t}return Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=this,n=function(n){t.setState({songData:n})};if(this.props.filename){var e=function(n){t.props.history.push({pathname:"/",error:"Failed to load "+t.props.filename+". If you're sure this is a Hydrogen file, please consider raising an issue in github!"})};this.props.filename.includes("h2song")?qn.parseHydrogenPromise(this.props.content).then((function(n){return ot.LoadJSON(n,Xn(t.props.filename),t.props.filename,!0)})).then(n).catch(e):Promise.resolve(this.props.content).then((function(t){return"string"===typeof t?JSON.parse(t):t})).then((function(n){return ot.LoadJSON(n,n.songName?n.songName:Xn(t.props.filename),t.props.filename,!1)})).then(n).catch(e)}else{this.props.history.push({pathname:"/"})}}},{key:"render",value:function(){return this.state.songData?Object(i.jsx)(En,{songData:this.state.songData},this.state.songData):Object(i.jsx)(Hn,{})}}]),e}(o.a.Component),Yn=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(){var t;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))).state={songData:null},t}return Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=this;K.c(this.props.songID).then((function(t){return ot.LoadJSON(t,t.songName,t.loadedFile,!1)})).then((function(n){t.setState({songData:n})})).catch((function(n){t.props.history.push({pathname:"/",error:"Failed to load song "+t.props.songID+" from database. This could represent a corrupted entry/a bug in our software. Please consider raising an issue in github!"})}))}},{key:"render",value:function(){return this.state.songData?Object(i.jsx)(En,{songData:this.state.songData},this.state.songData):Object(i.jsx)(Hn,{})}}]),e}(o.a.Component),Zn=function(t){Object(p.a)(e,t);var n=Object(h.a)(e);function e(){var t;Object(l.a)(this,e);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=n.call.apply(n,[this].concat(r))).state={songData:null},t}return Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=this,n=function(n){t.props.history.push({pathname:"/",error:"Failed to load recently viewed song "+t.props.name+". "})},e=K.d().filter((function(n){return n.id===t.props.songID}));e.length<1&&n(),Promise.resolve(e[0]).then((function(n){if(Bn()(n.content)!==t.props.songID)throw new Error("Hash did not match");return Object(K.a)(n.content)})).then((function(t){return ot.LoadJSON(t,t.songName,t.songName,!1)})).then((function(n){t.setState({songData:n})})).catch(n)}},{key:"render",value:function(){return this.state.songData?Object(i.jsx)(En,{songData:this.state.songData},this.state.songData):Object(i.jsx)(Hn,{})}}]),e}(o.a.Component);function Qn(t){var n=Object(G.a)("(prefers-color-scheme: dark)"),e=Object(L.a)(o.a.useMemo((function(){return Object(_.a)({palette:{type:n?"dark":"light",primary:{main:"#d7ccc8"},secondary:{main:"#00acc1"}}})}),[n]));return Object(i.jsx)(u.a,{basename:"/tabit",children:Object(i.jsxs)(z.a,{theme:e,children:[Object(i.jsx)(B.a,{}),Object(i.jsxs)(c.c,{children:[Object(i.jsx)(c.a,{exact:!0,path:"/",render:function(t){return Object(i.jsx)(F,{history:t.history,location:t.location,songHistory:K.d(),error:t.location.error})}}),Object(i.jsx)(c.a,{exact:!0,path:"/example",render:function(t){return Object(i.jsx)(Vn,{history:t.history,location:t.location})}}),Object(i.jsx)(c.a,{path:"/song/:songID",render:function(t){return Object(i.jsx)(Yn,{history:t.history,location:t.location,songID:t.match.params.songID})}}),Object(i.jsx)(c.a,{path:"/import",render:function(t){return Object(i.jsx)($n,{history:t.history,location:t.location,filename:t.location.filename,content:t.location.content})}}),Object(i.jsx)(c.a,{path:"/recent/:songID",render:function(t){return Object(i.jsx)(Zn,{history:t.history,location:t.location,songID:t.match.params.songID})}})]})]})})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(i.jsx)(o.a.StrictMode,{children:Object(i.jsx)(Qn,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},43:function(t,n,e){"use strict";var i=e(15),r=e(1),o=e(2),a=function(){function t(){Object(r.a)(this,t)}return Object(o.a)(t,null,[{key:"validateConfig",value:function(t,n){if(null!=n&&t.beatResolution%n!==0)throw new Error("patternResolution doesn't divide beatResolution");if(t.lineResolution<=0)throw new Error("config.lineResolution must be greater than zero")}},{key:"resolveConfig",value:function(n){for(var e=0,i=Object.keys(n);e<i.length;e++){var r=i[e];if(!t.DEFAULT_FORMAT_CONFIG.hasOwnProperty(r))throw new Error("passed unrecognised property "+r)}return Object.assign(Object.assign({},t.DEFAULT_FORMAT_CONFIG),n)}},{key:"chunkString",value:function(t,n){if(n<=0)throw new Error("chunkSize must be > 0");return t.match(new RegExp(".{1,"+n+"}","g"))}},{key:"chunkArray",value:function(t,n){if(n<=0)throw new Error("chunkSize must be > 0");for(var e=[],i=0;i<t.length;i+=n)e.push(t.slice(i,Math.min(i+n,t.length)));return e}},{key:"createNumberMarker",value:function(t,n,e,i){if(i<=0)throw new Error("lineLength <= 0");if(n%e!==0)throw new Error("patternResolution "+e.toString()+" does not divide beatResolution "+n.toString());for(var r=Math.ceil(i/n),o=Array.from(Array(i/e),(function(n){return t})),a=0;a<r;a++)o[a*(n/e)]=((a+1)%10).toString();return o}},{key:"formatLineWithMarkers",value:function(n,e,i,r){t.validateConfig(n);for(var o=n.beatResolution/i,a=r?function(t,n){return"<span class='note-"+(e=n,((e+="").length>=(i=4)?e:new Array(i-e.length+1).join("0")+e)+"'>")+t+"</span>";var e,i}:function(t,n){return t},s="",u=0;u<e.length;++u){var c=i*u;s+=a(e.charAt(u),c)}var l=n.showBeatMark?t.chunkString(s,o*a("X",0).length).join(n.beatMark):s;return n.lineMark+l+n.lineMark}},{key:"defaultLineResolution",value:function(t,n){var e=Object.values(t);if(0===e.length)return 384;var i=e[0].length(),r=i/n;return r<=12?i:r>32?768:[i,i/2,i/3,i/2,i,i/3,i,i/4,i/3,i/2,i,i/3,i/5,i,i/3,i/4,i,i/6,i,i/4][r-13]}},{key:"guessPerPatternSettings",value:function(n){return{lineResolution:t.defaultLineResolution(n,48),beatResolution:48}}},{key:"formatPatternString",value:function(t,n,e){var r=Object.values(n);if(0===r.length)return"";for(var o=r[0].length(),a=r[0].resolution,s=Array(o/a).fill(e),u=0;u<s.length;++u)for(var c=0,l=Object.entries(t);c<l.length;c++){var m=Object(i.a)(l[c],2),p=m[0],h=m[1],f=n[p];null!=f&&1===f.rep[u]&&(s[u]=h)}return s}},{key:"fromInstrumentAndTrack",value:function(n,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=t.resolveConfig(r),a=Object.values(e);if(0===a.length)return"";var s=t.formatPatternString(n,e,o.restMark),u=s.join(""),c=a[0].resolution,l=a[0].length(),m=t.chunkString(u,o.lineResolution/c),p=[];o.showBeatNumbers&&p.push(t.formatLineWithMarkers(o,t.createNumberMarker(o.numberRestMark,o.beatResolution,c,Math.min(o.lineResolution,l)).join(""),c,i));for(var h=0;h<m.length;++h)p.push(t.formatLineWithMarkers(o,m[h],c,i));return p.join("\n")}},{key:"getPatternLength",value:function(t){for(var n=48,e=0,r=Object.entries(t.instrumentTracks);e<r.length;e++){var o=Object(i.a)(r[e],2)[1];n=Math.max(n,o.length())}return n}},{key:"getPatternResolution",value:function(t){for(var n=48,e=0,r=Object.entries(t.instrumentTracks);e<r.length;e++){var o=Object(i.a)(r[e],2)[1];n=Math.min(n,o.resolution)}return n}}]),t}();a.DEFAULT_FORMAT_CONFIG={restMark:"-",beatMark:"|",lineMark:"|",numberRestMark:"-",beatResolution:48,showBeatMark:!0,showBeatNumbers:!0,lineResolution:384},a.FORMAT_CONFIG_STRINGS=[["restMark",["-","."," "]],["numberRestMark",["-","."," "]]],a.FORMAT_CONFIG_BOOLS=["showBeatMark","showBeatNumbers"],n.a=a},54:function(t,n,e){"use strict";(function(t){e.d(n,"a",(function(){return c})),e.d(n,"c",(function(){return p})),e.d(n,"e",(function(){return m})),e.d(n,"b",(function(){return d})),e.d(n,"d",(function(){return h})),e.d(n,"f",(function(){return f}));var i=e(132),r=e.n(i),o=e(180),a=e.n(o),s=e(248),u=function(t){var n=JSON.stringify(t);return{state:a.a.deflateSync(n).toString("base64")}},c=function(n){var e=new t(n.state,"base64"),i=a.a.inflateSync(e);return JSON.parse(i)},l="https://api.jsonbin.io/b",m=function(t,n){var e=(n||t.songName).slice(0,64),i=u(t),r={method:"POST",headers:{"Content-Type":"application/json","secret-key":"$2b$10$Z2eAUT2PfRKn5RB55/Y30ujW8aUB1CCgRuUua3Jo9JX2WTetZRfIG","collection-id":"60218fa606934b65f53046ad",private:!1,name:e},body:JSON.stringify(i)};return fetch(l,r).then((function(t){if(t.ok)return t.json();throw new Error("Failed to upload song")})).then((function(t){return t.id}))},p=function(t){return fetch(l+"/"+t,{headers:{"Content-Type":"application/json"}}).then((function(t){if(t.ok)return t.json();throw new Error("Failed to upload song")})).then((function(t){return c(t)}))},h=function(){if(!function(t){var n;try{n=window[t];var e="__storage_test__";return n.setItem(e,e),n.removeItem(e),!0}catch(i){return i instanceof DOMException&&(22===i.code||1014===i.code||"QuotaExceededError"===i.name||"NS_ERROR_DOM_QUOTA_REACHED"===i.name)&&n&&0!==n.length}}("localStorage"))return[];var t=localStorage.getItem("tabit-history");return t?JSON.parse(t).sort((function(t,n){return n.date-t.date})):[]},f=function(t){var n=u(t),e=r()(n),i=h(),o=i.filter((function(n){return n.id===e&&n.name===t.songName}));if(0!==o.length)o[0].date=Date.now();else{var a={name:t.songName,id:e,date:Date.now(),content:n};i.push(a)}var s=i.sort((function(t,n){return n.date-t.date})).slice(0,10);localStorage.setItem("tabit-history",JSON.stringify(s))},d=function(t){var n=t.songName+".tabit",e=JSON.stringify(t,null,4),i=new Blob([e],{type:"application/json"});Object(s.saveAs)(i,n)}}).call(this,e(70).Buffer)},68:function(t,n,e){"use strict";function i(){var t=navigator.userAgent||navigator.vendor||window.opera;return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((function(n){return t.match(n)}))}e.d(n,"a",(function(){return i}))},94:function(t,n,e){"use strict";var i=e(7),r=e(0),o=e.n(r),a=e(279),s=e(434),u=e(275),c=e(97),l=e(261),m=e.n(l),p=e(262),h=e.n(p),f=e(136),d=e(78),j=e(265),g=e.n(j),b=e(263),v=e.n(b),O=e(264),y=e.n(O),x=Object(u.a)((function(t){return{root:{zIndex:t.zIndex.drawer+1,backgroundColor:t.palette.secondary}}}));function k(t){var n=x(t);return t.placeholder?Object(i.jsx)(a.a,{variant:"dense"}):Object(i.jsx)(s.a,{position:"fixed",className:n.root,children:Object(i.jsxs)(a.a,{variant:"dense",children:[Object(i.jsx)(c.a,{color:"inherit","aria-label":"open pattern list",edge:"start",onClick:t.patternsToggle,children:Object(i.jsx)(m.a,{})}),Object(i.jsx)(c.a,{color:"inherit","aria-label":"home",edge:"start",component:f.b,to:"/",children:Object(i.jsx)(h.a,{})}),Object(i.jsx)(d.a,{variant:"h6",color:"inherit",noWrap:!0,style:{flexGrow:1,textOverflow:"ellipsis"},children:t.title}),Object(i.jsx)(c.a,{color:"inherit","aria-label":"download",edge:"start",onClick:t.onDownload,children:Object(i.jsx)(v.a,{})}),Object(i.jsx)(c.a,{color:"inherit","aria-label":"download",edge:"start",onClick:t.onShare,children:Object(i.jsx)(y.a,{})}),Object(i.jsx)(c.a,{color:"inherit","aria-label":"open settings",edge:"end",onClick:t.settingsToggle,children:Object(i.jsx)(g.a,{})})]})})}n.a=o.a.memo(k)}},[[422,1,2]]]);
//# sourceMappingURL=main.80587c3e.chunk.js.map