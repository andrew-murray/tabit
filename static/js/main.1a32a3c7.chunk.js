(this.webpackJsonptabit=this.webpackJsonptabit||[]).push([[0],{140:function(e,t,n){e.exports=n(178)},145:function(e,t,n){},161:function(e,t){},163:function(e,t){},173:function(e,t,n){},178:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(9),o=n.n(i),s=(n(145),n(11)),l=n(19),u=n(20),c=n(45),f=n(44),m=n(3),h=n(64),p=function(e){Object(c.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).onChange=r.onChange.bind(Object(h.a)(r)),r}return Object(u.a)(n,[{key:"onChange",value:function(e){var t=this,n=e.target.files[0],r=new FileReader;r.onload=function(e){t.props.onImport&&t.props.onImport({file:n,content:e.target.result})},r.readAsText(n)}},{key:"render",value:function(){return a.a.createElement("input",{type:"file",onChange:this.onChange})}}]),n}(a.a.Component),v=n(28),d=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"validateConfig",value:function(e,t){if(null!=t&&e.beatResolution%t!==0)throw new Error("patternResolution doesn't divide beatResolution");if(e.lineResolution<=0)throw new Error("config.lineResolution doesn't divide patternResolution")}},{key:"chunkString",value:function(e,t){if(t<=0)throw new Error("chunkSize must be > 0");return e.match(new RegExp(".{1,"+t+"}","g"))}},{key:"createNumberMarker",value:function(t,n,r){if(n<=0||r<=0)throw new Error("(patternResolution, patternSize) arguments <= 0");if(r%n!==0)throw new Error("patternSize,doesn't divide patternResolution");e.validateConfig(t,n);for(var a=Math.min(r,t.lineResolution),i=Math.ceil(a/t.beatResolution),o=Array.from(Array(a/n),(function(e){return t.numberRestMark})),s=0;s<i;s++)o[s*(t.beatResolution/n)]=((s+1)%10).toString();return o.join("")}},{key:"formatLineWithMarkers",value:function(t,n,r){e.validateConfig(t);var a=t.beatResolution/r,i=t.showBeatMark?e.chunkString(n,a).join(t.beatMark):n;return t.lineMark+i+t.lineMark}},{key:"fromInstrumentAndTrack",value:function(t,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=0,i=Object.keys(r);a<i.length;a++){var o=i[a];if(!e.DEFAULT_FORMAT_CONFIG.hasOwnProperty(o))throw new Error("passed unrecognised property "+o)}var s=Object.assign(Object.assign({},e.DEFAULT_FORMAT_CONFIG),r),l=Object.values(n);if(0===l.length)return"";for(var u=l[0].length(),c=l[0].resolution,f=l[0].length()/l[0].resolution,m=Array(f).fill(s.restMark),h=0;h<m.length;++h)for(var p=0,d=Object.entries(t);p<d.length;p++){var g=Object(v.a)(d[p],2),b=g[0],y=g[1],O=n[b];null!=O&&1===O.rep[h]&&(m[h]=y)}var k=m.join(""),j=e.chunkString(k,s.lineResolution/c),w=[];s.showBeatNumbers&&w.push(e.formatLineWithMarkers(s,e.createNumberMarker(s,c,u),c));for(var E=0;E<j.length;++E)w.push(e.formatLineWithMarkers(s,j[E],c));return w.join("\n")}}]),e}();d.DEFAULT_FORMAT_CONFIG={restMark:"-",beatMark:"|",lineMark:"|",numberRestMark:"-",beatResolution:48,showBeatMark:!0,showBeatNumbers:!0,lineResolution:768},d.FORMAT_CONFIG_STRINGS=[["restMark",["-","."," "]],["numberRestMark",["-","."," "]],["beatResolution",["24","48","96"]]],d.FORMAT_CONFIG_BOOLS=["showBeatMark","showBeatNumbers"];var g=d,b=function(e){Object(c.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={},r}return Object(u.a)(n,[{key:"formatText",value:function(e){var t,n=this.props.config,r=[],a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var i=Object(v.a)(t.value,2),o=i[0],l=i[1],u=g.fromInstrumentAndTrack(l,this.props.tracks,n);r.push(o);var c,f=Object(s.a)(u.split("\n"));try{for(f.s();!(c=f.n()).done;){var m=c.value;r.push(m)}}catch(h){f.e(h)}finally{f.f()}}}catch(h){a.e(h)}finally{a.f()}return r}},{key:"render",value:function(){return a.a.createElement("div",{className:"Pattern",style:{fontFamily:"Roboto Mono",textAlign:"left",whiteSpace:"pre"}},this.formatText(this.props.instruments).map((function(e,t){return a.a.createElement("p",{key:t.toString()},e)})))}}]),n}(a.a.Component),y=n(96),O=n.n(y),k=n(119);function j(e,t){for(var n=e.concat([t]),r=0,a=[48,24,16,12,8,6,4,3,2,1];r<a.length;r++){var i,o=a[r],l=!0,u=Object(s.a)(n);try{for(u.s();!(i=u.n()).done;){if(i.value%o!==0){l=!1;break}}}catch(c){u.e(c)}finally{u.f()}if(l)return o}throw new Error("Failed to predict base")}var w=function(){function e(t,n){if(Object(l.a)(this,e),0===t.length)throw new Error("patternArray must not be zero length");this.rep=t,this.resolution=n}return Object(u.a)(e,[{key:"length",value:function(){return this.rep.length*this.resolution}},{key:"empty",value:function(){return 0===this.rep.reduce((function(e,t){return e+t}))}},{key:"_sumOverlapsOfArrays",value:function(e,t){for(var n=0,r=0;r<e.length;++r)e[r]&&t[r]&&n++;return n}},{key:"countOverlaps",value:function(e){if(this.resolution===e.resolution)return this._sumOverlapsOfArrays(this.rep,e.rep);var t=function(e,t){if(e<1||t<1)throw new Error("x<1 || y<1");for(;Math.max(e,t)%Math.min(e,t)!==0;)e>t?e%=t:t%=e;return Math.min(e,t)}(this.resolution,e.resolution),n=this.formatResolution(t),r=e.formatResolution(t);return this._sumOverlapsOfArrays(n.rep,r.rep)}},{key:"format",value:function(t){var n=this.resolution*this.rep.length,r=this.toPoints(),a=e.representPoints(r,t,n);return a?new e(a,t):null}},{key:"toPoints",value:function(){var e,t=[],n=Object(s.a)(Array(this.rep.length).keys());try{for(n.s();!(e=n.n()).done;){var r=e.value;this.rep[r]&&t.push(this.resolution*r)}}catch(a){n.e(a)}finally{n.f()}return t}}],[{key:"representPoints",value:function(e,t,n){if(n<=0)throw new Error("size must be greater than zero");if(n<t||n%t!==0)throw new Error("resolution must be less than size and divide it evenly");var r,a=new Array(n/t).fill(0),i=Object(s.a)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o%t!==0)throw new Error("Failed to represent point "+o.toString()+" at resolution "+t.toString());if(o>=n)throw new Error("Failed to represent point "+o.toString()+" for invalid specified size "+n.toString());a[o/t]=1}}catch(l){i.e(l)}finally{i.f()}return a}},{key:"fromPositions",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=null!==r&&void 0!==r?r:j(t,n);return new e(e.representPoints(t,a,n),a)}}]),e}(),E=n(120),S=n.n(E);function A(e){var t=e.song.instrumentList[0].instrument,n=Array.from(t,(function(e){return{id:parseInt(e.id),name:e.name,volume:parseFloat(e.volume),muted:"true"===e.isMuted[0],gain:parseFloat(e.gain)}})),r=e.song.patternList[0].pattern,a=Array.from(r,(function(e){var t=e.noteList[0].note,n=parseInt(e.size),r=[];return t&&(r=(r=Array.from(t,(function(e){return{position:parseInt(e.position),instrument:parseInt(e.instrument)}}))).filter((function(e){return e.position<n}))),{size:n,name:e.name,notes:r}})),i=Array.from(a,(function(e){var t,r=function(e,t){return j(Array.from(e.notes,(function(e){return e.position})),t)}(e,e.size),a={},i=Object(s.a)(n);try{var o=function(){var n=t.value,i=e.notes.filter((function(e){return e.instrument===n.id})),o=Array.from(i,(function(e){return e.position}));a[n.id.toString()]=w.fromPositions(o,e.size,r)};for(i.s();!(t=i.n()).done;)o()}catch(l){i.e(l)}finally{i.f()}return e.resolution=r,e.instrumentTracks=a,e}));return{instruments:n,patterns:i}}function M(){return(M=Object(k.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new S.a.Parser,e.abrupt("return",n.parseStringPromise(t).then(A));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C={parseHydrogenPromise:function(e){return M.apply(this,arguments)}},F=(n(173),n(231)),R=n(127),T=n(227),I=n(234),N=n(228),P=n(221),_=n(180),B=n(229),G=n(181),D=n(125),x=n.n(D),L=n(126),z=n.n(L),W=n(35),U=n(32),X=n(214),H=n(219),J=n(222),$=n(217),Z=n(225),q=n(223),K=n(224),Q=n(230),V=n(226),Y=Object(X.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}}));function ee(e){var t=e.replace(/([A-Z])/g," $1");return t[0].toUpperCase()+t.slice(1)}function te(e){var t=Y();function n(e){return" "===e?"space":e}var r=function(t){var n,r=Object(U.a)(Object(U.a)({},e.settings),{},Object(W.a)({},t.target.name,"space"===(n=t.target.value)?" ":n));e.onChange(r)},i=function(t){var n=Object(U.a)(Object(U.a)({},e.settings),{},Object(W.a)({},t.target.name,t.target.checked));e.onChange(n)};return a.a.createElement(Z.a,{className:t.root},g.FORMAT_CONFIG_STRINGS.map((function(i){return function(i,o){var s="form-control-"+i+"-id";return a.a.createElement($.a,{variant:"filled",className:t.formControl,key:s,id:s},a.a.createElement(H.a,{id:"settings-option-{name}"},i),a.a.createElement(Q.a,{labelId:"settings-option-"+i+"-labelID",id:"settings-option-"+i+"-id",value:n(e.settings[i]),name:i,onChange:r},o.map((function(e){return a.a.createElement(J.a,{key:"settings-menu-item-"+i+"-"+e,value:n(e)},n(e))}))))}(i[0],i[1])})).reduce((function(e,t){return[e,a.a.createElement(V.a,null),t]})),a.a.createElement(V.a,null),g.FORMAT_CONFIG_BOOLS.map((function(t){return n=t,a.a.createElement(q.a,{control:a.a.createElement(K.a,{checked:e.settings[n],onChange:i,name:n}),label:ee(n),key:"switch-"+n});var n})).reduce((function(e,t){return[e,a.a.createElement(V.a,null),t]})))}var ne=g.DEFAULT_FORMAT_CONFIG;n(97),n(179),n(233),Object(X.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(1)}}}));var re={"Djembe Slap":"S","Djembe Tone":"t","Djembe Bass":"O","Snare Ghost":"-","Snare Accent":"X","Shaker Ghost":"x","Shaker Accent":"X",Click:"X",Bass:"O",Tom:"O",Default:"X"};function ae(e){var t,n=[],r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=Object.assign({},a);i.name=i.name[0].toLowerCase(),n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n}function ie(e,t,n,r){var a=[];if(2===e.length){var i=e[0],o=e[1],l=i.volume>o.volume||i.volume===o.volume&&i.gain>o.gain,u={};u[i.id.toString()]=l?n:r,u[o.id.toString()]=l?r:n,a.push([t,u])}else{var c,f=Object(s.a)(e);try{for(f.s();!(c=f.n()).done;){var m=c.value,h={};h[m.id.toString()]=n,a.push([t,h])}}catch(p){f.e(p)}finally{f.f()}}return a}function oe(e){var t,n=new Set,r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=0,o=Object.entries(a.instrumentTracks);i<o.length;i++){var l=Object(v.a)(o[i],2),u=l[0];l[1].empty()||n.add(parseInt(u))}}catch(c){r.e(c)}finally{r.f()}return n}function se(e,t,n){var r=[];r=(r=(r=(r=r.concat(function(e,t,n){for(var r=ae(e),a=oe(n),i=r.filter((function(e){return a.has(e.id)&&!e.name.includes("djembe")&&(e.name.includes("click")||e.name.includes("stick")||e.name.includes("tom")||e.name.includes("bass")||e.name.includes("kick"))})),o=Array.from(i,(function(e){return e.name.includes("click")||e.name.includes("stick")})),s=[],l=0;l<Math.floor(i.length/2);++l)if(o[2*l]!==o[2*l+1]){var u=o[2*l]?i[2*l]:i[2*l+1],c=o[2*l]?i[2*l+1]:i[2*l],f=c.name.includes("tom")?"Tom":"Bass",m={};m[c.id.toString()]=t[f],m[u.id.toString()]=t.Click,s.push([f,m])}if(i.length%2!==0&&!o[i.length-1]){var h=i[i.length-1],p=h.name.includes("tom")?"Tom":"Bass",v={};v[h.id.toString()]=t[p],s.push([p,v])}return s}(e,t,n))).concat(function(e,t){var n=ae(e).filter((function(e){return e.name.includes("djembe")}));if(0===n.length)return[];if(n.length<=3){for(var r=Array.from(n,(function(e){return e.name.includes("slap")})),a=Array.from(n,(function(e){return e.name.includes("tone")})),i=Array.from(n,(function(e){return e.name.includes("bass")})),o=0;o<n.length;++o){if(1!==r[o]+a[o]+i[o])return[]}for(var s={},l=0;l<n.length;++l)r[l]?s[n[l].id.toString()]=t["Djembe Slap"]:a[l]?s[n[l].id.toString()]=t["Djembe Tone"]:i[l]&&(s[n[l].id.toString()]=t["Djembe Bass"]);return[["Djembe",s]]}return[]}(e,t))).concat(function(e,t){return ie(ae(e).filter((function(e){return e.name.includes("snare")})),"Snare",t["Snare Accent"],t["Snare Ghost"])}(e,t))).concat(function(e,t){return ie(ae(e).filter((function(e){return e.name.includes("shaker")})),"Shaker",t["Shaker Accent"],t["Shaker Ghost"])}(e,t));var a,i=oe(n),o=Object(s.a)(e);try{for(o.s();!(a=o.n()).done;){var l=a.value;if(i.has(l.id)){var u,c=!1,f=Object(s.a)(r);try{for(f.s();!(u=f.n()).done;){var m=u.value;l.id.toString()in m[1]&&(c=!0)}}catch(p){f.e(p)}finally{f.f()}if(!1===c){var h={};h[l.id.toString()]=t.Default,r.push([l.name[0],h])}}}}catch(p){o.e(p)}finally{o.f()}return r}var le=Object(R.a)({palette:{type:"dark",primary:{main:"#36d9be"},secondary:{main:"#f50057"}}}),ue=function(e){Object(c.a)(n,e);var t=Object(f.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={instruments:null,patterns:null,selectedPattern:null,loadedFile:null,settingsOpen:!1,formatSettings:Object.assign({},ne)},r}return Object(u.a)(n,[{key:"handleFileImport",value:function(e){var t=this;C.parseHydrogenPromise(e.content).then((function(n){var r=se(n.instruments,re,n.patterns);t.setState({instruments:r,patterns:n.patterns,selectedPattern:0===n.patterns.length?null:0,loadedFile:e.file.name})}))}},{key:"selectPattern",value:function(e){this.setState({selectedPattern:e})}},{key:"renderPattern",value:function(e,t){return a.a.createElement(a.a.Fragment,null,a.a.createElement(b,{instruments:this.state.instruments,tracks:e.instrumentTracks,config:this.state.formatSettings}))}},{key:"renderMainContent",value:function(){var e=this;if(null==this.state.patterns||0===this.state.patterns.length){var t=null!=this.state.patterns&&0===this.state.patterns.length?a.a.createElement(F.a,{severity:"error"},this.state.loadedFile," contained no patterns! Try another."):"";return a.a.createElement("div",null,a.a.createElement("h2",null,"tabit"),a.a.createElement(p,{onImport:this.handleFileImport.bind(this)}),t)}var n=null;if(null==this.state.selectedPattern){n=[];var r,i=Object(s.a)(this.state.patterns);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.push(this.renderPattern(o))}}catch(c){i.e(c)}finally{i.f()}}else{var l=this.state.patterns[this.state.selectedPattern];n=this.renderPattern(l)}var u=this.props;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{display:"flex",width:"95%"}},a.a.createElement("div",{className:"content-title",style:{flexGrow:1}}),a.a.createElement(G.a,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:function(){e.setState({settingsOpen:!0})},className:Object(m.a)(this.state.settingsOpen&&u.hide)},a.a.createElement(x.a,null))),n,a.a.createElement(I.a,{className:u.drawer,variant:"persistent",anchor:"right",open:this.state.settingsOpen,classes:{paper:u.drawerPaper}},a.a.createElement("div",{className:u.drawerHeader},a.a.createElement(G.a,{onClick:function(){e.setState({settingsOpen:!1})}},a.a.createElement(z.a,null))),a.a.createElement(te,{onChange:function(t){e.setState({formatSettings:t})},settings:this.state.formatSettings})))}},{key:"render",value:function(){var e,t=this,n=this.props,r=null!=this.state.patterns,i=this.renderMainContent();return a.a.createElement("div",{className:"App"},a.a.createElement(T.a,{theme:le},a.a.createElement(N.a,null),a.a.createElement(I.a,{className:n.drawer,variant:"persistent",open:r},a.a.createElement("div",{className:n.drawerContainer},a.a.createElement(P.a,null,(null!==(e=this.state.patterns)&&void 0!==e?e:[]).map((function(e,n){return a.a.createElement(_.a,{button:!0,key:"drawer-pattern"+n.toString(),onClick:function(){return t.selectPattern(n)}},a.a.createElement(B.a,{primary:e.name}))}))))),i))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[140,1,2]]]);
//# sourceMappingURL=main.1a32a3c7.chunk.js.map